const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KeyboardManager-BrMYO6Id.js","assets/modulepreload-polyfill-B5Qt9EMX.js","assets/ScreenReaderManager-C4lztOWC.js"])))=>i.map(i=>d[i]);
import"./modulepreload-polyfill-B5Qt9EMX.js";const kn="/music-learning-tools/assets/apple-touch-icon-BWxcdW_v.png",En="/music-learning-tools/assets/settings-TJsqx0gz.svg",An="/music-learning-tools/assets/volume-BF7HNWqG.svg",In="/music-learning-tools/assets/favicon-96x96-BFjbGiHf.png",On="/music-learning-tools/assets/favicon-EiJHQ7f4.ico",Pn="/music-learning-tools/assets/favicon-oxmeNcL9.svg",Dn="data:application/manifest+json;base64,ew0KICAibmFtZSI6ICJEaWF0b25pYyBDb21wYXNzIiwNCiAgInNob3J0X25hbWUiOiAiRGlhQ29tcGFzcyIsDQogICJpY29ucyI6IFsNCiAgICB7DQogICAgICAic3JjIjogIi9EaWF0b25pYy1Db21wYXNzL3dlYi1hcHAtbWFuaWZlc3QtMTkyeDE5Mi5wbmciLA0KICAgICAgInNpemVzIjogIjE5MngxOTIiLA0KICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIiwNCiAgICAgICJwdXJwb3NlIjogIm1hc2thYmxlIg0KICAgIH0sDQogICAgew0KICAgICAgInNyYyI6ICIvRGlhdG9uaWMtQ29tcGFzcy93ZWItYXBwLW1hbmlmZXN0LTUxMng1MTIucG5nIiwNCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwNCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIsDQogICAgICAicHVycG9zZSI6ICJtYXNrYWJsZSINCiAgICB9DQogIF0sDQogICJ0aGVtZV9jb2xvciI6ICIjZmZmZmZmIiwNCiAgImJhY2tncm91bmRfY29sb3IiOiAiI2ZmZmZmZiIsDQogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiDQp9",Mn="/music-learning-tools/assets/web-app-manifest-192x192-CQUvWY5p.png",Rn="/music-learning-tools/assets/web-app-manifest-512x512-DMiNyMET.png",Ln="modulepreload",Nn=function(a){return"/music-learning-tools/"+a},Vr={},Qe=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=s?.nonce||s?.getAttribute("nonce");i=l(t.map(c=>{if(c=Nn(c),c in Vr)return;Vr[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":Ln,h||(g.as="script"),g.crossOrigin="",g.href=c,o&&g.setAttribute("nonce",o),document.head.appendChild(g),h)return new Promise((f,p)=>{g.addEventListener("load",f),g.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&n(o.reason);return e().catch(n)})},_={rings:{pitchClass:0,degree:0,chromatic:0,highlightPosition:0},drag:{active:null,startX:0,startY:0,startPitchClass:0,startDegree:0,startChrom:0,startHighlight:0},animation:null,belts:{itemSize:{},tracks:{},init:!1,orientation:"horizontal",order:["pitch","degree","intervals","chromatic"],layoutOrder:{horizontal:["compass","pitch","degree","intervals","chromatic","result"],vertical:["compass","result"]}},dimensions:{size:0,cx:0,cy:0,dpr:1},playback:{isPlaying:!1,currentNoteIndex:null,sequence:[],timeoutId:null,audioContext:null,rootNoteIndexForPlayback:null},display:{sharp:!0,flat:!0},ui:{sidebarOpen:!1,darkMode:!1,cursorColor:"red",cursorFill:!1,display:{get sharp(){return _.display.sharp},get flat(){return _.display.flat},set sharp(a){_.display.sharp=a},set flat(a){_.display.flat=a}}},performance:{needsRedraw:!0,lastRenderState:null,frameSkipCounter:0,isLowPowerMode:!1}},Yr=Object.freeze(Object.defineProperty({__proto__:null,appState:_},Symbol.toStringTag,{value:"Module"}));function Bn(a){function e(t){a(t),requestAnimationFrame(e)}requestAnimationFrame(e)}class E{static isDebugMode=!1;static handle(e,t,r=null){const i=e instanceof Error?e:new Error(String(e)),n={message:i.message,stack:i.stack,context:t,timestamp:Date.now(),userAgent:navigator.userAgent};if(console.error(`[${t}] Error:`,i),this.logError(n),r)try{r()}catch(s){console.error(`[${t}] Fallback failed:`,s)}this.attemptRecovery(t,i)}static logError(e){try{const t=JSON.parse(sessionStorage.getItem("diatonic-errors")||"[]");t.push(e);const r=t.slice(-20);sessionStorage.setItem("diatonic-errors",JSON.stringify(r))}catch(t){this.isDebugMode&&console.warn("Could not log error to sessionStorage:",t)}}static attemptRecovery(e,t){switch(e){case"AudioContext":this.recoverAudioContext();break;case"Canvas":this.recoverCanvas();break;case"Animation":this.recoverAnimation();break;case"LocalStorage":this.recoverLocalStorage();break;case"Resize":console.warn("Resize error detected - may self-resolve");break;default:this.isDebugMode&&console.warn(`No specific recovery strategy for context: ${e}`)}}static recoverAudioContext(){Qe(async()=>{const{appState:e}=await Promise.resolve().then(()=>Yr);return{appState:e}},void 0).then(({appState:e})=>{if(e.playback.audioContext){try{e.playback.audioContext.close()}catch{}e.playback.audioContext=null}e.playback.isPlaying&&(e.playback.isPlaying=!1,e.playback.currentNoteIndex=null,e.playback.sequence=[],e.playback.timeoutId&&(clearTimeout(e.playback.timeoutId),e.playback.timeoutId=null))})}static recoverCanvas(){requestAnimationFrame(()=>{console.log("Attempting canvas recovery via redraw")})}static recoverAnimation(){Qe(async()=>{const{appState:e}=await Promise.resolve().then(()=>Yr);return{appState:e}},void 0).then(({appState:e})=>{e.animation=null,e.drag.active=null})}static recoverLocalStorage(){console.warn("LocalStorage unavailable - preferences will not persist")}static getErrorLog(){try{return JSON.parse(sessionStorage.getItem("diatonic-errors")||"[]")}catch{return[]}}static clearErrorLog(){try{sessionStorage.removeItem("diatonic-errors")}catch{}}static enableDebugMode(){this.isDebugMode=!0,console.log("ErrorHandler debug mode enabled")}static isFeatureSupported(e){switch(e){case"AudioContext":return!!(window.AudioContext||window.webkitAudioContext);case"localStorage":try{const t="__localStorage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}case"requestIdleCallback":return typeof window.requestIdleCallback=="function";case"OffscreenCanvas":return typeof OffscreenCanvas<"u";default:return!0}}static wrap(e,t,r=null){return(...i)=>{try{return e(...i)}catch(n){return this.handle(n,t,r?()=>{r(...i)}:null),r?r(...i):void 0}}}}function Fn(a,e){try{if(!a)return console.warn("No canvas element provided"),!1;if(!e)return console.warn("No dimensions object provided"),!1;if(!a.parentElement)return!1;const t=a.closest(".main-container"),r=t&&t.classList.contains("vertical-layout"),i=a.parentElement.offsetWidth,n=a.parentElement.offsetHeight,s=window.innerWidth,o=window.innerHeight,l=t?t.offsetWidth:0,c=t?t.offsetHeight:0;let h=a;const d=[];for(;h&&h!==document.body;)d.push({tagName:h.tagName,className:h.className,id:h.id,width:h.offsetWidth,height:h.offsetHeight,style:{width:h.style.width,height:h.style.height,display:getComputedStyle(h).display,position:getComputedStyle(h).position}}),h=h.parentElement;const g=zn();let f;if(r){const C=Math.max(i,s*.8),b=Math.max(n,o*.8);f=Math.min(C,b)}else{const C=Math.min(i,n);f=Math.min(C,window.innerHeight*.8)}const p=e.size||0,u=Math.abs(f-p),m=p===0||u>=2,y=e.dpr!==g;if(u>50&&(console.log("=== CANVAS CONTAINER DEBUG ==="),console.log("Vertical mode:",r),console.log("Canvas size:",{width:a.width,height:a.height}),console.log("Container dimensions:",{containerWidth:i,containerHeight:n}),console.log("Viewport dimensions:",{viewportWidth:s,viewportHeight:o}),console.log("Calculated size:",f),console.log("DOM Hierarchy (from canvas to body):"),d.forEach((C,b)=>{console.log(`  ${b}: ${C.tagName}${C.id?"#"+C.id:""}${C.className?"."+C.className.replace(/\s+/g,"."):""}`,{dimensions:`${C.width}x${C.height}`,styles:C.style})})),f===0||!m&&!y)return!1;console.log("Canvas resize proceeding:",{oldSize:e.size,newSize:f,sizeChanged:m,dprChanged:y,difference:u}),e.size=f,e.cx=f/2,e.cy=f/2,e.dpr=g;const v=f*g,T=f*g;return console.log("Setting canvas dimensions:",{cssSize:`${f}px`,bufferSize:`${v}x${T}`,dpr:g,beforeCSS:{width:a.style.width,height:a.style.height},beforeBuffer:{width:a.width,height:a.height}}),a.width=v,a.height=T,a.style.width=`${f}px`,a.style.height=`${f}px`,console.log("Canvas dimensions after setting:",{cssSize:{width:a.style.width,height:a.style.height},bufferSize:{width:a.width,height:a.height},offsetSize:{width:a.offsetWidth,height:a.offsetHeight}}),!0}catch(t){return E.handle(t,"Canvas",()=>{try{if(a&&a.parentElement&&e){const r=Math.min(a.parentElement.offsetWidth,a.parentElement.offsetHeight);r>0&&r!==e.size&&(e.size=r,e.cx=r/2,e.cy=r/2,e.dpr=e.dpr||1,a.width=r*e.dpr,a.height=r*e.dpr)}}catch{console.error("Canvas resize fallback failed")}}),!1}}function zn(){try{return Math.min(window.devicePixelRatio||1,3)}catch(a){return E.handle(a,"Canvas"),1}}const Bt=["C","C♯/D♭","D","D♯/E♭","E","F","F♯/G♭","G","G♯/A♭","A","A♯/B♭","B"],Ft=["1","♯1/♭2","2","♯2/♭3","3","4","♯4/♭5","5","♯5/♭6","6","♯6/♭7","7"],Hn=[...Array(12).keys()],Se=12,zt=[0,2,4,5,7,9,11],mt={C:!0,"C♯/D♭":!1,D:!0,"D♯/E♭":!1,E:!0,F:!0,"F♯/G♭":!1,G:!0,"G♯/A♭":!1,A:!0,"A♯/B♭":!1,B:!0},cr={0:"#f090ae",2:"#ea9e5e",4:"#a8bd61",5:"#76c788",7:"#33c6dc",9:"#94adff",11:"#dd95d6",1:"#a46055",3:"#8a722f",6:"#258677",8:"#3d7ca5",10:"#7d68a3"},qn={1:[0,2,4,5,7,9,11],2:[0,2,3,5,7,9,10],3:[0,1,3,5,7,8,10],4:[0,2,4,6,7,9,11],5:[0,2,4,5,7,9,10],6:[0,2,3,5,7,8,10],7:[0,1,3,5,6,8,10]},gi={1:"1","♯1/♭2":"2",2:"2","♯2/♭3":"3",3:"3",4:"4","♯4/♭5":"5",5:"5","♯5/♭6":"6",6:"6","♯6/♭7":"7",7:"7"},$n={1:"Major",2:"Dorian",3:"Phrygian",4:"Lydian",5:"Mixolydian",6:"Minor",7:"Locrian"},Un=[2,2,1,2,2,2,1],Ge=Math.PI*2,G=Ge/12,J={ANIMATION:{DURATION_MS:300},WHEEL:{FONTS:{OUTER_FACTOR:.057,MIDDLE_FACTOR:.052,INNER_FACTOR:.042}},AUDIO:{BASE_FREQUENCY:261.63,NOTE_DURATION_MS:250,PAUSE_BETWEEN_NOTES_MS:50},ERROR_HANDLING:{CONTEXTS:{AUDIO:"AudioContext",ANIMATION:"Animation",UI:"UI",APP:"App"}}},Wn=J.WHEEL.FONTS.OUTER_FACTOR,Vn=J.WHEEL.FONTS.MIDDLE_FACTOR,Yn=J.WHEEL.FONTS.INNER_FACTOR,Gn=J.ANIMATION.DURATION_MS,Gr=J.AUDIO.NOTE_DURATION_MS,Xn=J.AUDIO.PAUSE_BETWEEN_NOTES_MS,jn=J.AUDIO.BASE_FREQUENCY,Kn=1/G,F=a=>(a%Ge+Ge)%Ge;function pi(a,e){const t=F(e)-F(a);return t>Math.PI?t-Ge:t<-Math.PI?t+Ge:t}const Jn=a=>a<.5?2*a*a:-1+(4-2*a)*a,Ht=a=>(Math.round(-F(a)*Kn)%12+12)%12;class rt{static debounce(e,t){let r=null;const i=(...n)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>e.apply(this,n),t)};return i.cancel=()=>{r!==null&&clearTimeout(r),r=null},i}static throttle(e,t){let r=!1,i=null,n=0;return(...s)=>{r?(i!==null&&clearTimeout(i),i=setTimeout(()=>{Date.now()-n>=t&&(e.apply(this,s),n=Date.now())},t-(Date.now()-n))):(e.apply(this,s),n=Date.now(),r=!0)}}static memoize(e,t=JSON.stringify,r=100){const i=new Map,n=(...s)=>{const o=t(s);if(i.has(o))return i.get(o);const l=e(...s);if(i.size>=r){const c=i.keys().next().value;c!==void 0&&i.delete(c)}return i.set(o,l),l};return n.clearCache=()=>i.clear(),n.getCacheSize=()=>i.size,n.getCacheStats=()=>({size:i.size,maxSize:r,keys:Array.from(i.keys())}),n}static startMeasure(e){const t=performance.now();return()=>{const i=performance.now()-t;return console.log(`[Performance] ${e}: ${i.toFixed(2)}ms`),i}}static monitor(e,t){return(...r)=>{const i=this.startMeasure(t);try{const n=e(...r);return i(),n}catch(n){throw i(),n}}}static requestOptimizedFrame(e,t={}){return typeof window.requestIdleCallback=="function"?window.requestIdleCallback(e,{timeout:16,...t}):requestAnimationFrame(()=>{e({didTimeout:!1,timeRemaining:()=>0})})}static cancelOptimizedFrame(e){typeof window.cancelIdleCallback=="function"?window.cancelIdleCallback(e):cancelAnimationFrame(e)}static batchDOMUpdates(e){return new Promise(t=>{requestAnimationFrame(()=>{e(),t()})})}static createFPSMonitor(e,t=60){let r=0,i=performance.now(),n=null;const s=o=>{if(r++,r%t===0){const l=Math.round(t*1e3/(o-i));e(l),i=o}n=requestAnimationFrame(s)};return n=requestAnimationFrame(s),()=>{n!==null&&(cancelAnimationFrame(n),n=null)}}static prefersReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}static getViewportSize(){return{width:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}}static isElementVisible(e,t=0){const r=e.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return r.bottom>=t*i&&r.top<=(1-t)*i&&r.right>=t*n&&r.left<=(1-t)*n}static getMemoryInfo(){return performance.memory?{used:Math.round(performance.memory.usedJSHeapSize/1048576),total:Math.round(performance.memory.totalJSHeapSize/1048576),limit:Math.round(performance.memory.jsHeapSizeLimit/1048576)}:null}}function Qn([a]){const{sharp:e,flat:t}=a.display;return`${e}-${t}`}function Zn([a]){const{sharp:e,flat:t}=a.display,{pitchClass:r,degree:i,chromatic:n}=a.rings,s=Math.round(r*1e3)/1e3,o=Math.round(i*1e3)/1e3,l=Math.round(n*1e3)/1e3;return`${e}-${t}-${s}-${o}-${l}`}function Xr(a,e,t){try{if(!a||!a.includes("/"))return a||"";const[r,i]=a.split("/");return!r||!i?(console.warn(`Invalid label format: ${a}`),a):e&&t?`${r}/${i}`:e?r:t?i:`${r}/${i}`}catch(r){return E.handle(r,"Logic",()=>{console.warn(`Label processing failed for: ${a}`)}),a||""}}function es(a){try{const{sharp:e,flat:t}=a.display;if(typeof e!="boolean"||typeof t!="boolean")throw new Error("Invalid display state - sharp/flat must be booleans");const r=Bt.map(n=>Xr(n,e,t)),i=Ft.map(n=>Xr(n,e,t));if(r.length!==12||i.length!==12)throw new Error("Invalid label array lengths");return{chromaticLabels:r,diatonicLabels:i}}catch(e){return E.handle(e,"Logic",()=>{console.warn("Falling back to default labels")}),{chromaticLabels:Bt.slice(),diatonicLabels:Ft.slice()}}}const mi=rt.memoize(es,Qn,50);function ts(a){try{const{sharp:e,flat:t}=a.display,{pitchClass:r,degree:i,chromatic:n}=a.rings;if(typeof r!="number"||typeof i!="number"||typeof n!="number")throw new Error("Invalid ring state - angles must be numbers");const s=y=>{if(!y.includes("/"))return y;const[v,T]=y.split("/");return e&&t?y:e?v:t?T:v},o=Bt.map(s),l=F(r-n),c=F(i-n),h=Ht(l),d=Ht(c);if(h<0||h>=12||d<0||d>=12)throw new Error(`Invalid note indices: root=${h}, mode=${d}`);const g=o[h],f=Ft[d],p=gi[f]||null,u=p?$n[p]:"...";if(!g||!u)throw new Error("Could not determine pitch or mode name");const m=`${g} ${u}`;return{pitch:g,modeName:u,result:m,rootNoteIndex:h,modeDegreeIndex:d,modeKey:p}}catch(e){return E.handle(e,"Logic",()=>{console.warn("Musical result calculation failed")}),{pitch:"C",modeName:"Major",result:"C Major",rootNoteIndex:0,modeDegreeIndex:0,modeKey:"1"}}}const _i=rt.memoize(ts,Zn,100);function rs(a,e){try{if(!a||!e)throw new Error("Invalid state or result element");const t=_i(a);e.textContent!==t.result&&(e.textContent=t.result)}catch(t){E.handle(t,"Logic",()=>{e&&(e.textContent="C Major")})}}function Xo(a){try{const e=_i(a),t=mi(a);return{...e,labels:t,angles:{pitchClass:a.rings.pitchClass,degree:a.rings.degree,chromatic:a.rings.chromatic,effectivePitch:F(a.rings.pitchClass-a.rings.chromatic),effectiveDegree:F(a.rings.degree-a.rings.chromatic)},display:{sharp:a.display.sharp,flat:a.display.flat}}}catch(e){return E.handle(e,"Logic"),null}}function Xt(a,e){const t=performance.now(),r=_.animation,i={fromPitchClass:_.rings.pitchClass,fromDegree:_.rings.degree,fromChrom:_.rings.chromatic,fromHighlight:_.rings.highlightPosition},n={toPitchClass:a.pitchClass??r?.to.toPitchClass??i.fromPitchClass,toDegree:a.degree??r?.to.toDegree??i.fromDegree,toChrom:a.chromatic??r?.to.toChrom??i.fromChrom,toHighlight:a.highlightPosition??r?.to.toHighlight??i.fromHighlight};_.animation={t0:t,from:i,to:n,onComplete:e??null}}function is(a){const e=_.animation;if(!e)return!1;const t=(a-e.t0)/Gn,r=t>=1?1:Jn(t),i=(n,s)=>F(n+pi(n,s)*r);return _.rings.pitchClass=i(e.from.fromPitchClass,e.to.toPitchClass),_.rings.degree=i(e.from.fromDegree,e.to.toDegree),_.rings.chromatic=i(e.from.fromChrom,e.to.toChrom),_.rings.highlightPosition=i(e.from.fromHighlight,e.to.toHighlight),r===1&&(e.onComplete&&e.onComplete(),_.animation=null),!0}function yi(a,e){const t=_.rings[a],r=Math.round(-t/G),i=F(-r*G);Xt({[a]:i},e)}function hr(a){const{degree:e,chromatic:t}=_.rings,r=F(e-t),i=F(-r)/G;let n=zt[0],s=1/0;zt.forEach(c=>{const h=Math.abs(i-c),d=Math.min(h,12-h);d<s&&(s=d,n=c)});const o=F(-n*G),l=F(o+t);Xt({degree:l,highlightPosition:l},a)}function bi(a){const e=Math.round(-_.rings.chromatic/G),t=F(-e*G),r=pi(_.rings.chromatic,t),i=F(_.rings.pitchClass+r),n=F(_.rings.degree-_.rings.chromatic),s=F(n+t);Xt({pitchClass:i,degree:s,chromatic:t,highlightPosition:s},a)}function vi(){try{if(_.playback.audioContext)return _.playback.audioContext.state==="suspended"?_.playback.audioContext.resume().catch(e=>{E.handle(e,"AudioContext",()=>{_.playback.audioContext=null,vi()})}):Promise.resolve();if(!E.isFeatureSupported("AudioContext"))return console.warn("Web Audio API not supported - audio playback disabled"),Promise.resolve();const a=window.AudioContext||window.webkitAudioContext;return a?(_.playback.audioContext=new a,_.playback.audioContext.addEventListener("statechange",()=>{if(!_.playback.audioContext)return;const e=_.playback.audioContext.state;console.log(`Audio context state changed to: ${e}`),(e==="interrupted"||e==="suspended")&&setTimeout(()=>{_.playback.audioContext?.state==="suspended"&&_.playback.audioContext.resume().catch(t=>{E.handle(t,"AudioContext")})},100)}),_.playback.audioContext.state==="suspended"?_.playback.audioContext.resume().catch(e=>{E.handle(e,"AudioContext",()=>{console.warn("Could not resume audio context - user interaction may be required")})}):Promise.resolve()):Promise.resolve()}catch(a){return E.handle(a,"AudioContext",()=>{console.warn("Audio initialization failed - continuing without audio"),_.playback.audioContext=null}),Promise.resolve()}}function ns(a,e){try{const t=_.playback.audioContext;if(!t){console.warn("No audio context available");return}if(t.state==="closed"){console.warn("Audio context is closed");return}if(typeof a!="number"||a<0)throw new Error(`Invalid chromatic index: ${a}`);typeof e!="number"||e<=0;const r=t.createOscillator(),i=t.createGain(),n=a%12,s=Math.floor(a/12),o=jn*Math.pow(2,n/12+s);if(o<20||o>2e4)throw new Error(`Frequency out of audible range: ${o}Hz`);r.frequency.setValueAtTime(o,t.currentTime),r.type="sine",r.connect(i),i.connect(t.destination);const l=t.currentTime,c=.01,h=Math.min(.1,e*.3);i.gain.setValueAtTime(0,l),i.gain.linearRampToValueAtTime(.3,l+c),i.gain.setValueAtTime(.3,l+e-h),i.gain.linearRampToValueAtTime(0,l+e),r.start(l),r.stop(l+e),r.addEventListener("ended",()=>{try{r.disconnect(),i.disconnect()}catch{}}),r.addEventListener("error",d=>{E.handle(new Error("Oscillator error"),"AudioContext")})}catch(t){E.handle(t,"AudioContext",()=>{console.warn(`Failed to play note ${a} - continuing silently`)})}}function ss(){const{pitchClass:a,degree:e,chromatic:t}=_.rings,r=Ht(F(a-t)),i=Ht(F(e-t)),n=Ft[i],s=gi[n];if(!s)return[];const l=qn[s].map(c=>r+c);return l.push(l[0]+12),l}function Ci(){if(!_.playback.isPlaying){Mt();return}const a=_.playback.sequence;if(a.length===0){Mt();return}const e=a.shift();if(e===void 0){Mt();return}_.playback.currentNoteIndex=e,ns(e,Gr/1e3);const t=setTimeout(Ci,Gr+Xn);_.playback.timeoutId=t}function os(){if(_.playback.isPlaying)return;vi();const a=ss();a.length!==0&&(_.playback.rootNoteIndexForPlayback=a[0],_.playback.isPlaying=!0,_.playback.sequence=a,Ci())}function Mt(){_.playback.isPlaying&&(clearTimeout(_.playback.timeoutId??void 0),_.playback.isPlaying=!1,_.playback.currentNoteIndex=null,_.playback.sequence=[],_.playback.timeoutId=null,_.playback.rootNoteIndexForPlayback=null)}const dr="diatonicCompassPreferences",wi="diatonicCompassPreferencesBackup";function jt(a){try{if(!a||typeof a!="object")throw new Error("Invalid preferences object");if(!E.isFeatureSupported("localStorage"))return console.warn("localStorage not available - preferences will not persist"),!1;const t={...wt()||Tt(),...a},r=kr(t),i=JSON.stringify(r);try{localStorage.setItem(wi,localStorage.getItem(dr)||"{}")}catch{console.warn("Could not create preferences backup")}return localStorage.setItem(dr,i),!0}catch(e){return E.handle(e,"LocalStorage",()=>{console.warn("Preferences could not be saved - will use session defaults")}),!1}}function wt(){try{if(!E.isFeatureSupported("localStorage"))return Tt();const a=localStorage.getItem(dr);if(!a)return null;const e=JSON.parse(a),t=kr(e);return JSON.stringify(t)!==a&&(console.log("Preferences were corrected during load - saving updated version"),jt(t)),t}catch(a){return E.handle(a,"LocalStorage",()=>{const e=as();if(e)return console.log("Loaded preferences from backup"),e}),Tt()}}function as(){try{const a=localStorage.getItem(wi);if(a){const e=JSON.parse(a);return kr(e)}}catch{console.warn("Could not load backup preferences")}return null}function kr(a){if(!a||typeof a!="object")return Tt();const e=Tt(),t={...e},r=a;return Object.keys(e).forEach(i=>{if(i in r){const n=r[i],s=typeof e[i];if(typeof n===s)switch(i){case"darkMode":t[i]=!!n;break;case"orientation":t[i]=n==="horizontal"||n==="vertical"?n:e[i];break;case"volume":t[i]=Math.max(0,Math.min(1,Number(n)))||e[i];break;case"tutorialCompleted":t[i]=!!n;break;case"beltOrder":if(Array.isArray(n)){const o=["pitch","degree","intervals","chromatic"];o.every(c=>n.includes(c))&&n.length===o.length?t[i]=[...n]:t[i]=e[i]}else t[i]=e[i];break;case"cursorColor":t[i]=["red","blue","green","yellow"].includes(String(n))?n:e[i];break;case"cursorFill":t[i]=!!n;break;default:t[i]=n}else console.warn(`Invalid type for preference ${String(i)}: expected ${s}, got ${typeof n}`),t[i]=e[i]}else t[i]=e[i]}),"layoutOrder"in r&&typeof r.layoutOrder=="object"&&r.layoutOrder!==null&&(t.layoutOrder=r.layoutOrder),t}function Tt(){return{darkMode:!1,orientation:"horizontal",volume:.5,tutorialCompleted:!1,showAdvancedControls:!1,beltOrder:["pitch","degree","intervals","chromatic"],cursorColor:"red",cursorFill:!1}}const Ti=Object.freeze(Object.defineProperty({__proto__:null,loadPreferences:wt,savePreferences:jt},Symbol.toStringTag,{value:"Module"})),K={toggleAccidental(a){try{if(!["sharp","flat"].includes(a))throw new Error(`Invalid accidental type: ${a}`);const t=!_.display[a],r=a==="sharp"?"flat":"sharp",i=_.display[r];!t&&!i&&(_.display[r]=!0),_.display[a]=t}catch(e){E.handle(e,J.ERROR_HANDLING.CONTEXTS.UI)}},toggleDarkMode(){try{const a=!_.ui.darkMode;_.ui.darkMode=a,document.body.classList.toggle("dark-mode",a),jt({darkMode:a})}catch(a){E.handle(a,J.ERROR_HANDLING.CONTEXTS.UI,()=>{document.body.classList.toggle("dark-mode")})}},togglePlayback(){try{_.playback.isPlaying?Mt():!_.drag.active&&!_.animation&&os()}catch(a){E.handle(a,J.ERROR_HANDLING.CONTEXTS.AUDIO)}},toggleSidebar(a){try{const e=typeof a=="boolean"?a:!_.ui.sidebarOpen;_.ui.sidebarOpen=e,_.performance&&(_.performance.needsRedraw=!0)}catch(e){E.handle(e,J.ERROR_HANDLING.CONTEXTS.UI)}},setOrientation(a){try{if(!["horizontal","vertical"].includes(a))throw new Error(`Invalid orientation: ${a}`);if(_.belts.orientation===a)return;_.belts.orientation=a,_.rings.pitchClass=0,_.rings.degree=0,_.rings.chromatic=0,_.rings.highlightPosition=0,_.belts.init=!1;const e=document.querySelector(".main-container");e&&e.classList.toggle("vertical-layout",a==="vertical")}catch(e){E.handle(e,J.ERROR_HANDLING.CONTEXTS.UI)}},snapTo(a,e){try{Xt(a,e)}catch(t){E.handle(t,J.ERROR_HANDLING.CONTEXTS.ANIMATION)}},setRingAngle(a,e){try{if(!["pitchClass","degree","chromatic","highlightPosition"].includes(a))throw new Error(`Invalid ring name: ${a}`);if(typeof e!="number"||!isFinite(e))throw new Error(`Invalid angle value: ${e}`);_.rings[a]=e}catch(t){E.handle(t,J.ERROR_HANDLING.CONTEXTS.UI)}},setCursorColor(a,e){try{if(!["red","blue","green","yellow"].includes(a))throw new Error(`Invalid cursor color: ${a}`);_.ui.cursorColor=a,_.ui.cursorFill=e,Qe(async()=>{const{savePreferences:r}=await Promise.resolve().then(()=>Ti);return{savePreferences:r}},void 0).then(({savePreferences:r})=>{r({cursorColor:a,cursorFill:e})}),_.performance&&(_.performance.needsRedraw=!0)}catch(t){E.handle(t,J.ERROR_HANDLING.CONTEXTS.UI)}},resetRings(){try{_.rings.pitchClass=0,_.rings.degree=0,_.rings.chromatic=0,_.rings.highlightPosition=0}catch(a){E.handle(a,J.ERROR_HANDLING.CONTEXTS.UI)}},getStateSummary(){try{return{rings:{..._.rings},ui:{sidebarOpen:_.ui.sidebarOpen,darkMode:_.ui.darkMode,display:{sharp:_.display.sharp,flat:_.display.flat}},belts:{orientation:_.belts.orientation,init:_.belts.init},playback:{isPlaying:_.playback.isPlaying},interaction:{isDragging:!!_.drag.active,isAnimating:!!_.animation}}}catch(a){return E.handle(a,J.ERROR_HANDLING.CONTEXTS.APP),null}}};function ke(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function xi(a,e){a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.__proto__=e}var de={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},lt={duration:.5,overwrite:!1,delay:0},Er,Q,H,pe=1e8,B=1/pe,ur=Math.PI*2,ls=ur/4,cs=0,Si=Math.sqrt,hs=Math.cos,ds=Math.sin,j=function(e){return typeof e=="string"},W=function(e){return typeof e=="function"},Ae=function(e){return typeof e=="number"},Ar=function(e){return typeof e>"u"},Te=function(e){return typeof e=="object"},re=function(e){return e!==!1},Ir=function(){return typeof window<"u"},Dt=function(e){return W(e)||j(e)},ki=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},ee=Array.isArray,us=/random\([^)]+\)/g,fs=/,\s*/g,jr=/(?:-?\.?\d|\.)+/gi,Ei=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,it=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Zt=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Ai=/[+-]=-?[.\d]+/,gs=/[^,'"\[\]\s]+/gi,ps=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,$,ve,fr,Or,ue={},qt={},Ii,Oi=function(e){return(qt=ct(e,ue))&&oe},Pr=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},xt=function(e,t){return!t&&console.warn(e)},Pi=function(e,t){return e&&(ue[e]=t)&&qt&&(qt[e]=t)||ue},St=function(){return 0},ms={suppressEvents:!0,isStart:!0,kill:!1},Rt={suppressEvents:!0,kill:!1},_s={suppressEvents:!0},Dr={},Ne=[],gr={},Di,ae={},er={},Kr=30,Lt=[],Mr="",Rr=function(e){var t=e[0],r,i;if(Te(t)||W(t)||(e=[e]),!(r=(t._gsap||{}).harness)){for(i=Lt.length;i--&&!Lt[i].targetTest(t););r=Lt[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new rn(e[i],r)))||e.splice(i,1);return e},Xe=function(e){return e._gsap||Rr(me(e))[0]._gsap},Mi=function(e,t,r){return(r=e[t])&&W(r)?e[t]():Ar(r)&&e.getAttribute&&e.getAttribute(t)||r},ie=function(e,t){return(e=e.split(",")).forEach(t)||e},V=function(e){return Math.round(e*1e5)/1e5||0},q=function(e){return Math.round(e*1e7)/1e7||0},st=function(e,t){var r=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),r==="+"?e+i:r==="-"?e-i:r==="*"?e*i:e/i},ys=function(e,t){for(var r=t.length,i=0;e.indexOf(t[i])<0&&++i<r;);return i<r},$t=function(){var e=Ne.length,t=Ne.slice(0),r,i;for(gr={},Ne.length=0,r=0;r<e;r++)i=t[r],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},Lr=function(e){return!!(e._initted||e._startAt||e.add)},Ri=function(e,t,r,i){Ne.length&&!Q&&$t(),e.render(t,r,!!(Q&&t<0&&Lr(e))),Ne.length&&!Q&&$t()},Li=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(gs).length<2?t:j(e)?e.trim():e},Ni=function(e){return e},fe=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},bs=function(e){return function(t,r){for(var i in r)i in t||i==="duration"&&e||i==="ease"||(t[i]=r[i])}},ct=function(e,t){for(var r in t)e[r]=t[r];return e},Jr=function a(e,t){for(var r in t)r!=="__proto__"&&r!=="constructor"&&r!=="prototype"&&(e[r]=Te(t[r])?a(e[r]||(e[r]={}),t[r]):t[r]);return e},Ut=function(e,t){var r={},i;for(i in e)i in t||(r[i]=e[i]);return r},bt=function(e){var t=e.parent||$,r=e.keyframes?bs(ee(e.keyframes)):fe;if(re(e.inherit))for(;t;)r(e,t.vars.defaults),t=t.parent||t._dp;return e},vs=function(e,t){for(var r=e.length,i=r===t.length;i&&r--&&e[r]===t[r];);return r<0},Bi=function(e,t,r,i,n){var s=e[i],o;if(n)for(o=t[n];s&&s[n]>o;)s=s._prev;return s?(t._next=s._next,s._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[i]=t,t._prev=s,t.parent=t._dp=e,t},Kt=function(e,t,r,i){r===void 0&&(r="_first"),i===void 0&&(i="_last");var n=t._prev,s=t._next;n?n._next=s:e[r]===t&&(e[r]=s),s?s._prev=n:e[i]===t&&(e[i]=n),t._next=t._prev=t.parent=null},Fe=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},je=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},Cs=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},pr=function(e,t,r,i){return e._startAt&&(Q?e._startAt.revert(Rt):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},ws=function a(e){return!e||e._ts&&a(e.parent)},Qr=function(e){return e._repeat?ht(e._tTime,e=e.duration()+e._rDelay)*e:0},ht=function(e,t){var r=Math.floor(e=q(e/t));return e&&r===e?r-1:r},Wt=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Jt=function(e){return e._end=q(e._start+(e._tDur/Math.abs(e._ts||e._rts||B)||0))},Qt=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=q(r._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Jt(e),r._dirty||je(r,e)),e},Fi=function(e,t){var r;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(r=Wt(e.rawTime(),t),(!t._dur||Pt(0,t.totalDuration(),r)-t._tTime>B)&&t.render(r,!0)),je(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-B}},Ce=function(e,t,r,i){return t.parent&&Fe(t),t._start=q((Ae(r)?r:r||e!==$?ge(e,r,t):e._time)+t._delay),t._end=q(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Bi(e,t,"_first","_last",e._sort?"_start":0),mr(t)||(e._recent=t),i||Fi(e,t),e._ts<0&&Qt(e,e._tTime),e},zi=function(e,t){return(ue.ScrollTrigger||Pr("scrollTrigger",t))&&ue.ScrollTrigger.create(t,e)},Hi=function(e,t,r,i,n){if(Br(e,t,n),!e._initted)return 1;if(!r&&e._pt&&!Q&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&Di!==le.frame)return Ne.push(e),e._lazy=[n,i],1},Ts=function a(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||a(t))},mr=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},xs=function(e,t,r,i){var n=e.ratio,s=t<0||!t&&(!e._start&&Ts(e)&&!(!e._initted&&mr(e))||(e._ts<0||e._dp._ts<0)&&!mr(e))?0:1,o=e._rDelay,l=0,c,h,d;if(o&&e._repeat&&(l=Pt(0,e._tDur,t),h=ht(l,o),e._yoyo&&h&1&&(s=1-s),h!==ht(e._tTime,o)&&(n=1-s,e.vars.repeatRefresh&&e._initted&&e.invalidate())),s!==n||Q||i||e._zTime===B||!t&&e._zTime){if(!e._initted&&Hi(e,t,i,r,l))return;for(d=e._zTime,e._zTime=t||(r?B:0),r||(r=t&&!d),e.ratio=s,e._from&&(s=1-s),e._time=0,e._tTime=l,c=e._pt;c;)c.r(s,c.d),c=c._next;t<0&&pr(e,t,r,!0),e._onUpdate&&!r&&ce(e,"onUpdate"),l&&e._repeat&&!r&&e.parent&&ce(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===s&&(s&&Fe(e,1),!r&&!Q&&(ce(e,s?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},Ss=function(e,t,r){var i;if(r>t)for(i=e._first;i&&i._start<=r;){if(i.data==="isPause"&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=r;){if(i.data==="isPause"&&i._start<t)return i;i=i._prev}},dt=function(e,t,r,i){var n=e._repeat,s=q(t)||0,o=e._tTime/e._tDur;return o&&!i&&(e._time*=s/e._dur),e._dur=s,e._tDur=n?n<0?1e10:q(s*(n+1)+e._rDelay*n):s,o>0&&!i&&Qt(e,e._tTime=e._tDur*o),e.parent&&Jt(e),r||je(e.parent,e),e},Zr=function(e){return e instanceof te?je(e):dt(e,e._dur)},ks={_start:0,endTime:St,totalDuration:St},ge=function a(e,t,r){var i=e.labels,n=e._recent||ks,s=e.duration()>=pe?n.endTime(!1):e._dur,o,l,c;return j(t)&&(isNaN(t)||t in i)?(l=t.charAt(0),c=t.substr(-1)==="%",o=t.indexOf("="),l==="<"||l===">"?(o>=0&&(t=t.replace(/=/,"")),(l==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(o<0?n:r).totalDuration()/100:1)):o<0?(t in i||(i[t]=s),i[t]):(l=parseFloat(t.charAt(o-1)+t.substr(o+1)),c&&r&&(l=l/100*(ee(r)?r[0]:r).totalDuration()),o>1?a(e,t.substr(0,o-1),r)+l:s+l)):t==null?s:+t},vt=function(e,t,r){var i=Ae(t[1]),n=(i?2:1)+(e<2?0:1),s=t[n],o,l;if(i&&(s.duration=t[1]),s.parent=r,e){for(o=s,l=r;l&&!("immediateRender"in o);)o=l.vars.defaults||{},l=re(l.vars.inherit)&&l.parent;s.immediateRender=re(o.immediateRender),e<2?s.runBackwards=1:s.startAt=t[n-1]}return new Y(t[0],s,t[n+1])},qe=function(e,t){return e||e===0?t(e):t},Pt=function(e,t,r){return r<e?e:r>t?t:r},Z=function(e,t){return!j(e)||!(t=ps.exec(e))?"":t[1]},Es=function(e,t,r){return qe(r,function(i){return Pt(e,t,i)})},_r=[].slice,qi=function(e,t){return e&&Te(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Te(e[0]))&&!e.nodeType&&e!==ve},As=function(e,t,r){return r===void 0&&(r=[]),e.forEach(function(i){var n;return j(i)&&!t||qi(i,1)?(n=r).push.apply(n,me(i)):r.push(i)})||r},me=function(e,t,r){return H&&!t&&H.selector?H.selector(e):j(e)&&!r&&(fr||!ut())?_r.call((t||Or).querySelectorAll(e),0):ee(e)?As(e,r):qi(e)?_r.call(e,0):e?[e]:[]},yr=function(e){return e=me(e)[0]||xt("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return me(t,r.querySelectorAll?r:r===e?xt("Invalid scope")||Or.createElement("div"):e)}},$i=function(e){return e.sort(function(){return .5-Math.random()})},Ui=function(e){if(W(e))return e;var t=Te(e)?e:{each:e},r=Ke(t.ease),i=t.from||0,n=parseFloat(t.base)||0,s={},o=i>0&&i<1,l=isNaN(i)||o,c=t.axis,h=i,d=i;return j(i)?h=d={center:.5,edges:.5,end:1}[i]||0:!o&&l&&(h=i[0],d=i[1]),function(g,f,p){var u=(p||t).length,m=s[u],y,v,T,C,b,k,S,x,w;if(!m){if(w=t.grid==="auto"?0:(t.grid||[1,pe])[1],!w){for(S=-pe;S<(S=p[w++].getBoundingClientRect().left)&&w<u;);w<u&&w--}for(m=s[u]=[],y=l?Math.min(w,u)*h-.5:i%w,v=w===pe?0:l?u*d/w-.5:i/w|0,S=0,x=pe,k=0;k<u;k++)T=k%w-y,C=v-(k/w|0),m[k]=b=c?Math.abs(c==="y"?C:T):Si(T*T+C*C),b>S&&(S=b),b<x&&(x=b);i==="random"&&$i(m),m.max=S-x,m.min=x,m.v=u=(parseFloat(t.amount)||parseFloat(t.each)*(w>u?u-1:c?c==="y"?u/w:w:Math.max(w,u/w))||0)*(i==="edges"?-1:1),m.b=u<0?n-u:n,m.u=Z(t.amount||t.each)||0,r=r&&u<0?Zi(r):r}return u=(m[g]-m.min)/m.max||0,q(m.b+(r?r(u):u)*m.v)+m.u}},br=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var i=q(Math.round(parseFloat(r)/e)*e*t);return(i-i%1)/t+(Ae(r)?0:Z(r))}},Wi=function(e,t){var r=ee(e),i,n;return!r&&Te(e)&&(i=r=e.radius||pe,e.values?(e=me(e.values),(n=!Ae(e[0]))&&(i*=i)):e=br(e.increment)),qe(t,r?W(e)?function(s){return n=e(s),Math.abs(n-s)<=i?n:s}:function(s){for(var o=parseFloat(n?s.x:s),l=parseFloat(n?s.y:0),c=pe,h=0,d=e.length,g,f;d--;)n?(g=e[d].x-o,f=e[d].y-l,g=g*g+f*f):g=Math.abs(e[d]-o),g<c&&(c=g,h=d);return h=!i||c<=i?e[h]:s,n||h===s||Ae(s)?h:h+Z(s)}:br(e))},Vi=function(e,t,r,i){return qe(ee(e)?!t:r===!0?!!(r=0):!i,function(){return ee(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(i=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+r*.99))/r)*r*i)/i})},Is=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return t.reduce(function(n,s){return s(n)},i)}},Os=function(e,t){return function(r){return e(parseFloat(r))+(t||Z(r))}},Ps=function(e,t,r){return Gi(e,t,0,1,r)},Yi=function(e,t,r){return qe(r,function(i){return e[~~t(i)]})},Ds=function a(e,t,r){var i=t-e;return ee(e)?Yi(e,a(0,e.length),t):qe(r,function(n){return(i+(n-e)%i)%i+e})},Ms=function a(e,t,r){var i=t-e,n=i*2;return ee(e)?Yi(e,a(0,e.length-1),t):qe(r,function(s){return s=(n+(s-e)%n)%n||0,e+(s>i?n-s:s)})},kt=function(e){return e.replace(us,function(t){var r=t.indexOf("[")+1,i=t.substring(r||7,r?t.indexOf("]"):t.length-1).split(fs);return Vi(r?i:+i[0],r?0:+i[1],+i[2]||1e-5)})},Gi=function(e,t,r,i,n){var s=t-e,o=i-r;return qe(n,function(l){return r+((l-e)/s*o||0)})},Rs=function a(e,t,r,i){var n=isNaN(e+t)?0:function(f){return(1-f)*e+f*t};if(!n){var s=j(e),o={},l,c,h,d,g;if(r===!0&&(i=1)&&(r=null),s)e={p:e},t={p:t};else if(ee(e)&&!ee(t)){for(h=[],d=e.length,g=d-2,c=1;c<d;c++)h.push(a(e[c-1],e[c]));d--,n=function(p){p*=d;var u=Math.min(g,~~p);return h[u](p-u)},r=t}else i||(e=ct(ee(e)?[]:{},e));if(!h){for(l in t)Nr.call(o,e,l,"get",t[l]);n=function(p){return Hr(p,o)||(s?e.p:e)}}}return qe(r,n)},ei=function(e,t,r){var i=e.labels,n=pe,s,o,l;for(s in i)o=i[s]-t,o<0==!!r&&o&&n>(o=Math.abs(o))&&(l=s,n=o);return l},ce=function(e,t,r){var i=e.vars,n=i[t],s=H,o=e._ctx,l,c,h;if(n)return l=i[t+"Params"],c=i.callbackScope||e,r&&Ne.length&&$t(),o&&(H=o),h=l?n.apply(c,l):n.call(c),H=s,h},_t=function(e){return Fe(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Q),e.progress()<1&&ce(e,"onInterrupt"),e},nt,Xi=[],ji=function(e){if(e)if(e=!e.name&&e.default||e,Ir()||e.headless){var t=e.name,r=W(e),i=t&&!r&&e.init?function(){this._props=[]}:e,n={init:St,render:Hr,add:Nr,kill:Ks,modifier:js,rawVars:0},s={targetTest:0,get:0,getSetter:zr,aliases:{},register:0};if(ut(),e!==i){if(ae[t])return;fe(i,fe(Ut(e,n),s)),ct(i.prototype,ct(n,Ut(e,s))),ae[i.prop=t]=i,e.targetTest&&(Lt.push(i),Dr[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Pi(t,i),e.register&&e.register(oe,i,ne)}else Xi.push(e)},N=255,yt={aqua:[0,N,N],lime:[0,N,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,N],navy:[0,0,128],white:[N,N,N],olive:[128,128,0],yellow:[N,N,0],orange:[N,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[N,0,0],pink:[N,192,203],cyan:[0,N,N],transparent:[N,N,N,0]},tr=function(e,t,r){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(r-t)*e*6:e<.5?r:e*3<2?t+(r-t)*(2/3-e)*6:t)*N+.5|0},Ki=function(e,t,r){var i=e?Ae(e)?[e>>16,e>>8&N,e&N]:0:yt.black,n,s,o,l,c,h,d,g,f,p;if(!i){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),yt[e])i=yt[e];else if(e.charAt(0)==="#"){if(e.length<6&&(n=e.charAt(1),s=e.charAt(2),o=e.charAt(3),e="#"+n+n+s+s+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return i=parseInt(e.substr(1,6),16),[i>>16,i>>8&N,i&N,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),i=[e>>16,e>>8&N,e&N]}else if(e.substr(0,3)==="hsl"){if(i=p=e.match(jr),!t)l=+i[0]%360/360,c=+i[1]/100,h=+i[2]/100,s=h<=.5?h*(c+1):h+c-h*c,n=h*2-s,i.length>3&&(i[3]*=1),i[0]=tr(l+1/3,n,s),i[1]=tr(l,n,s),i[2]=tr(l-1/3,n,s);else if(~e.indexOf("="))return i=e.match(Ei),r&&i.length<4&&(i[3]=1),i}else i=e.match(jr)||yt.transparent;i=i.map(Number)}return t&&!p&&(n=i[0]/N,s=i[1]/N,o=i[2]/N,d=Math.max(n,s,o),g=Math.min(n,s,o),h=(d+g)/2,d===g?l=c=0:(f=d-g,c=h>.5?f/(2-d-g):f/(d+g),l=d===n?(s-o)/f+(s<o?6:0):d===s?(o-n)/f+2:(n-s)/f+4,l*=60),i[0]=~~(l+.5),i[1]=~~(c*100+.5),i[2]=~~(h*100+.5)),r&&i.length<4&&(i[3]=1),i},Ji=function(e){var t=[],r=[],i=-1;return e.split(Be).forEach(function(n){var s=n.match(it)||[];t.push.apply(t,s),r.push(i+=s.length+1)}),t.c=r,t},ti=function(e,t,r){var i="",n=(e+i).match(Be),s=t?"hsla(":"rgba(",o=0,l,c,h,d;if(!n)return e;if(n=n.map(function(g){return(g=Ki(g,t,1))&&s+(t?g[0]+","+g[1]+"%,"+g[2]+"%,"+g[3]:g.join(","))+")"}),r&&(h=Ji(e),l=r.c,l.join(i)!==h.c.join(i)))for(c=e.replace(Be,"1").split(it),d=c.length-1;o<d;o++)i+=c[o]+(~l.indexOf(o)?n.shift()||s+"0,0,0,0)":(h.length?h:n.length?n:r).shift());if(!c)for(c=e.split(Be),d=c.length-1;o<d;o++)i+=c[o]+n[o];return i+c[d]},Be=(function(){var a="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in yt)a+="|"+e+"\\b";return new RegExp(a+")","gi")})(),Ls=/hsl[a]?\(/,Qi=function(e){var t=e.join(" "),r;if(Be.lastIndex=0,Be.test(t))return r=Ls.test(t),e[1]=ti(e[1],r),e[0]=ti(e[0],r,Ji(e[1])),!0},Et,le=(function(){var a=Date.now,e=500,t=33,r=a(),i=r,n=1e3/240,s=n,o=[],l,c,h,d,g,f,p=function u(m){var y=a()-i,v=m===!0,T,C,b,k;if((y>e||y<0)&&(r+=y-t),i+=y,b=i-r,T=b-s,(T>0||v)&&(k=++d.frame,g=b-d.time*1e3,d.time=b=b/1e3,s+=T+(T>=n?4:n-T),C=1),v||(l=c(u)),C)for(f=0;f<o.length;f++)o[f](b,g,k,m)};return d={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(m){return g/(1e3/(m||60))},wake:function(){Ii&&(!fr&&Ir()&&(ve=fr=window,Or=ve.document||{},ue.gsap=oe,(ve.gsapVersions||(ve.gsapVersions=[])).push(oe.version),Oi(qt||ve.GreenSockGlobals||!ve.gsap&&ve||{}),Xi.forEach(ji)),h=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&d.sleep(),c=h||function(m){return setTimeout(m,s-d.time*1e3+1|0)},Et=1,p(2))},sleep:function(){(h?cancelAnimationFrame:clearTimeout)(l),Et=0,c=St},lagSmoothing:function(m,y){e=m||1/0,t=Math.min(y||33,e)},fps:function(m){n=1e3/(m||240),s=d.time*1e3+n},add:function(m,y,v){var T=y?function(C,b,k,S){m(C,b,k,S),d.remove(T)}:m;return d.remove(m),o[v?"unshift":"push"](T),ut(),T},remove:function(m,y){~(y=o.indexOf(m))&&o.splice(y,1)&&f>=y&&f--},_listeners:o},d})(),ut=function(){return!Et&&le.wake()},I={},Ns=/^[\d.\-M][\d.\-,\s]/,Bs=/["']/g,Fs=function(e){for(var t={},r=e.substr(1,e.length-3).split(":"),i=r[0],n=1,s=r.length,o,l,c;n<s;n++)l=r[n],o=n!==s-1?l.lastIndexOf(","):l.length,c=l.substr(0,o),t[i]=isNaN(c)?c.replace(Bs,"").trim():+c,i=l.substr(o+1).trim();return t},zs=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<r?e.indexOf(")",r+1):r)},Hs=function(e){var t=(e+"").split("("),r=I[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[Fs(t[1])]:zs(e).split(",").map(Li)):I._CE&&Ns.test(e)?I._CE("",e):r},Zi=function(e){return function(t){return 1-e(1-t)}},en=function a(e,t){for(var r=e._first,i;r;)r instanceof te?a(r,t):r.vars.yoyoEase&&(!r._yoyo||!r._repeat)&&r._yoyo!==t&&(r.timeline?a(r.timeline,t):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=t)),r=r._next},Ke=function(e,t){return e&&(W(e)?e:I[e]||Hs(e))||t},et=function(e,t,r,i){r===void 0&&(r=function(l){return 1-t(1-l)}),i===void 0&&(i=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var n={easeIn:t,easeOut:r,easeInOut:i},s;return ie(e,function(o){I[o]=ue[o]=n,I[s=o.toLowerCase()]=r;for(var l in n)I[s+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=I[o+"."+l]=n[l]}),n},tn=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},rr=function a(e,t,r){var i=t>=1?t:1,n=(r||(e?.3:.45))/(t<1?t:1),s=n/ur*(Math.asin(1/i)||0),o=function(h){return h===1?1:i*Math.pow(2,-10*h)*ds((h-s)*n)+1},l=e==="out"?o:e==="in"?function(c){return 1-o(1-c)}:tn(o);return n=ur/n,l.config=function(c,h){return a(e,c,h)},l},ir=function a(e,t){t===void 0&&(t=1.70158);var r=function(s){return s?--s*s*((t+1)*s+t)+1:0},i=e==="out"?r:e==="in"?function(n){return 1-r(1-n)}:tn(r);return i.config=function(n){return a(e,n)},i};ie("Linear,Quad,Cubic,Quart,Quint,Strong",function(a,e){var t=e<5?e+1:e;et(a+",Power"+(t-1),e?function(r){return Math.pow(r,t)}:function(r){return r},function(r){return 1-Math.pow(1-r,t)},function(r){return r<.5?Math.pow(r*2,t)/2:1-Math.pow((1-r)*2,t)/2})});I.Linear.easeNone=I.none=I.Linear.easeIn;et("Elastic",rr("in"),rr("out"),rr());(function(a,e){var t=1/e,r=2*t,i=2.5*t,n=function(o){return o<t?a*o*o:o<r?a*Math.pow(o-1.5/e,2)+.75:o<i?a*(o-=2.25/e)*o+.9375:a*Math.pow(o-2.625/e,2)+.984375};et("Bounce",function(s){return 1-n(1-s)},n)})(7.5625,2.75);et("Expo",function(a){return Math.pow(2,10*(a-1))*a+a*a*a*a*a*a*(1-a)});et("Circ",function(a){return-(Si(1-a*a)-1)});et("Sine",function(a){return a===1?1:-hs(a*ls)+1});et("Back",ir("in"),ir("out"),ir());I.SteppedEase=I.steps=ue.SteppedEase={config:function(e,t){e===void 0&&(e=1);var r=1/e,i=e+(t?0:1),n=t?1:0,s=1-B;return function(o){return((i*Pt(0,s,o)|0)+n)*r}}};lt.ease=I["quad.out"];ie("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(a){return Mr+=a+","+a+"Params,"});var rn=function(e,t){this.id=cs++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Mi,this.set=t?t.getSetter:zr},At=(function(){function a(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,dt(this,+t.duration,1,1),this.data=t.data,H&&(this._ctx=H,H.data.push(this)),Et||le.wake()}var e=a.prototype;return e.delay=function(r){return r||r===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+r-this._delay),this._delay=r,this):this._delay},e.duration=function(r){return arguments.length?this.totalDuration(this._repeat>0?r+(r+this._rDelay)*this._repeat:r):this.totalDuration()&&this._dur},e.totalDuration=function(r){return arguments.length?(this._dirty=0,dt(this,this._repeat<0?r:(r-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(r,i){if(ut(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Qt(this,r),!n._dp||n.parent||Fi(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&r<this._tDur||this._ts<0&&r>0||!this._tDur&&!r)&&Ce(this._dp,this,this._start-this._delay)}return(this._tTime!==r||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===B||!this._initted&&this._dur&&r||!r&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=r),Ri(this,r,i)),this},e.time=function(r,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),r+Qr(this))%(this._dur+this._rDelay)||(r?this._dur:0),i):this._time},e.totalProgress=function(r,i){return arguments.length?this.totalTime(this.totalDuration()*r,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(r,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-r:r)+Qr(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(r,i){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(r-1)*n,i):this._repeat?ht(this._tTime,n)+1:1},e.timeScale=function(r,i){if(!arguments.length)return this._rts===-B?0:this._rts;if(this._rts===r)return this;var n=this.parent&&this._ts?Wt(this.parent._time,this):this._tTime;return this._rts=+r||0,this._ts=this._ps||r===-B?0:this._rts,this.totalTime(Pt(-Math.abs(this._delay),this.totalDuration(),n),i!==!1),Jt(this),Cs(this)},e.paused=function(r){return arguments.length?(this._ps!==r&&(this._ps=r,r?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ut(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==B&&(this._tTime-=B)))),this):this._ps},e.startTime=function(r){if(arguments.length){this._start=q(r);var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&Ce(i,this,this._start-this._delay),this}return this._start},e.endTime=function(r){return this._start+(re(r)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(r){var i=this.parent||this._dp;return i?r&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Wt(i.rawTime(r),this):this._tTime:this._tTime},e.revert=function(r){r===void 0&&(r=_s);var i=Q;return Q=r,Lr(this)&&(this.timeline&&this.timeline.revert(r),this.totalTime(-.01,r.suppressEvents)),this.data!=="nested"&&r.kill!==!1&&this.kill(),Q=i,this},e.globalTime=function(r){for(var i=this,n=arguments.length?r:i.rawTime();i;)n=i._start+n/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(r):n},e.repeat=function(r){return arguments.length?(this._repeat=r===1/0?-2:r,Zr(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(r){if(arguments.length){var i=this._time;return this._rDelay=r,Zr(this),i?this.time(i):this}return this._rDelay},e.yoyo=function(r){return arguments.length?(this._yoyo=r,this):this._yoyo},e.seek=function(r,i){return this.totalTime(ge(this,r),re(i))},e.restart=function(r,i){return this.play().totalTime(r?-this._delay:0,re(i)),this._dur||(this._zTime=-B),this},e.play=function(r,i){return r!=null&&this.seek(r,i),this.reversed(!1).paused(!1)},e.reverse=function(r,i){return r!=null&&this.seek(r||this.totalDuration(),i),this.reversed(!0).paused(!1)},e.pause=function(r,i){return r!=null&&this.seek(r,i),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(r){return arguments.length?(!!r!==this.reversed()&&this.timeScale(-this._rts||(r?-B:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-B,this},e.isActive=function(){var r=this.parent||this._dp,i=this._start,n;return!!(!r||this._ts&&this._initted&&r.isActive()&&(n=r.rawTime(!0))>=i&&n<this.endTime(!0)-B)},e.eventCallback=function(r,i,n){var s=this.vars;return arguments.length>1?(i?(s[r]=i,n&&(s[r+"Params"]=n),r==="onUpdate"&&(this._onUpdate=i)):delete s[r],this):s[r]},e.then=function(r){var i=this,n=i._prom;return new Promise(function(s){var o=W(r)?r:Ni,l=function(){var h=i.then;i.then=null,n&&n(),W(o)&&(o=o(i))&&(o.then||o===i)&&(i.then=h),s(o),i.then=h};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?l():i._prom=l})},e.kill=function(){_t(this)},a})();fe(At.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-B,_prom:0,_ps:!1,_rts:1});var te=(function(a){xi(e,a);function e(r,i){var n;return r===void 0&&(r={}),n=a.call(this,r)||this,n.labels={},n.smoothChildTiming=!!r.smoothChildTiming,n.autoRemoveChildren=!!r.autoRemoveChildren,n._sort=re(r.sortChildren),$&&Ce(r.parent||$,ke(n),i),r.reversed&&n.reverse(),r.paused&&n.paused(!0),r.scrollTrigger&&zi(ke(n),r.scrollTrigger),n}var t=e.prototype;return t.to=function(i,n,s){return vt(0,arguments,this),this},t.from=function(i,n,s){return vt(1,arguments,this),this},t.fromTo=function(i,n,s,o){return vt(2,arguments,this),this},t.set=function(i,n,s){return n.duration=0,n.parent=this,bt(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new Y(i,n,ge(this,s),1),this},t.call=function(i,n,s){return Ce(this,Y.delayedCall(0,i,n),s)},t.staggerTo=function(i,n,s,o,l,c,h){return s.duration=n,s.stagger=s.stagger||o,s.onComplete=c,s.onCompleteParams=h,s.parent=this,new Y(i,s,ge(this,l)),this},t.staggerFrom=function(i,n,s,o,l,c,h){return s.runBackwards=1,bt(s).immediateRender=re(s.immediateRender),this.staggerTo(i,n,s,o,l,c,h)},t.staggerFromTo=function(i,n,s,o,l,c,h,d){return o.startAt=s,bt(o).immediateRender=re(o.immediateRender),this.staggerTo(i,n,o,l,c,h,d)},t.render=function(i,n,s){var o=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=i<=0?0:q(i),d=this._zTime<0!=i<0&&(this._initted||!c),g,f,p,u,m,y,v,T,C,b,k,S;if(this!==$&&h>l&&i>=0&&(h=l),h!==this._tTime||s||d){if(o!==this._time&&c&&(h+=this._time-o,i+=this._time-o),g=h,C=this._start,T=this._ts,y=!T,d&&(c||(o=this._zTime),(i||!n)&&(this._zTime=i)),this._repeat){if(k=this._yoyo,m=c+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(m*100+i,n,s);if(g=q(h%m),h===l?(u=this._repeat,g=c):(b=q(h/m),u=~~b,u&&u===b&&(g=c,u--),g>c&&(g=c)),b=ht(this._tTime,m),!o&&this._tTime&&b!==u&&this._tTime-b*m-this._dur<=0&&(b=u),k&&u&1&&(g=c-g,S=1),u!==b&&!this._lock){var x=k&&b&1,w=x===(k&&u&1);if(u<b&&(x=!x),o=x?0:h%c?c:h,this._lock=1,this.render(o||(S?0:q(u*m)),n,!c)._lock=0,this._tTime=h,!n&&this.parent&&ce(this,"onRepeat"),this.vars.repeatRefresh&&!S&&(this.invalidate()._lock=1,b=u),o&&o!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,w&&(this._lock=2,o=x?c:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!S&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;en(this,S)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=Ss(this,q(o),q(g)),v&&(h-=g-(g=v._start))),this._tTime=h,this._time=g,this._act=!T,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,o=0),!o&&h&&c&&!n&&!b&&(ce(this,"onStart"),this._tTime!==h))return this;if(g>=o&&i>=0)for(f=this._first;f;){if(p=f._next,(f._act||g>=f._start)&&f._ts&&v!==f){if(f.parent!==this)return this.render(i,n,s);if(f.render(f._ts>0?(g-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(g-f._start)*f._ts,n,s),g!==this._time||!this._ts&&!y){v=0,p&&(h+=this._zTime=-B);break}}f=p}else{f=this._last;for(var A=i<0?i:g;f;){if(p=f._prev,(f._act||A<=f._end)&&f._ts&&v!==f){if(f.parent!==this)return this.render(i,n,s);if(f.render(f._ts>0?(A-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(A-f._start)*f._ts,n,s||Q&&Lr(f)),g!==this._time||!this._ts&&!y){v=0,p&&(h+=this._zTime=A?-B:B);break}}f=p}}if(v&&!n&&(this.pause(),v.render(g>=o?0:-B)._zTime=g>=o?1:-1,this._ts))return this._start=C,Jt(this),this.render(i,n,s);this._onUpdate&&!n&&ce(this,"onUpdate",!0),(h===l&&this._tTime>=this.totalDuration()||!h&&o)&&(C===this._start||Math.abs(T)!==Math.abs(this._ts))&&(this._lock||((i||!c)&&(h===l&&this._ts>0||!h&&this._ts<0)&&Fe(this,1),!n&&!(i<0&&!o)&&(h||o||!l)&&(ce(this,h===l&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(i,n){var s=this;if(Ae(n)||(n=ge(this,n,i)),!(i instanceof At)){if(ee(i))return i.forEach(function(o){return s.add(o,n)}),this;if(j(i))return this.addLabel(i,n);if(W(i))i=Y.delayedCall(0,i);else return this}return this!==i?Ce(this,i,n):this},t.getChildren=function(i,n,s,o){i===void 0&&(i=!0),n===void 0&&(n=!0),s===void 0&&(s=!0),o===void 0&&(o=-pe);for(var l=[],c=this._first;c;)c._start>=o&&(c instanceof Y?n&&l.push(c):(s&&l.push(c),i&&l.push.apply(l,c.getChildren(!0,n,s)))),c=c._next;return l},t.getById=function(i){for(var n=this.getChildren(1,1,1),s=n.length;s--;)if(n[s].vars.id===i)return n[s]},t.remove=function(i){return j(i)?this.removeLabel(i):W(i)?this.killTweensOf(i):(i.parent===this&&Kt(this,i),i===this._recent&&(this._recent=this._last),je(this))},t.totalTime=function(i,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=q(le.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),a.prototype.totalTime.call(this,i,n),this._forcing=0,this):this._tTime},t.addLabel=function(i,n){return this.labels[i]=ge(this,n),this},t.removeLabel=function(i){return delete this.labels[i],this},t.addPause=function(i,n,s){var o=Y.delayedCall(0,n||St,s);return o.data="isPause",this._hasPause=1,Ce(this,o,ge(this,i))},t.removePause=function(i){var n=this._first;for(i=ge(this,i);n;)n._start===i&&n.data==="isPause"&&Fe(n),n=n._next},t.killTweensOf=function(i,n,s){for(var o=this.getTweensOf(i,s),l=o.length;l--;)Me!==o[l]&&o[l].kill(i,n);return this},t.getTweensOf=function(i,n){for(var s=[],o=me(i),l=this._first,c=Ae(n),h;l;)l instanceof Y?ys(l._targets,o)&&(c?(!Me||l._initted&&l._ts)&&l.globalTime(0)<=n&&l.globalTime(l.totalDuration())>n:!n||l.isActive())&&s.push(l):(h=l.getTweensOf(o,n)).length&&s.push.apply(s,h),l=l._next;return s},t.tweenTo=function(i,n){n=n||{};var s=this,o=ge(s,i),l=n,c=l.startAt,h=l.onStart,d=l.onStartParams,g=l.immediateRender,f,p=Y.to(s,fe({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:n.duration||Math.abs((o-(c&&"time"in c?c.time:s._time))/s.timeScale())||B,onStart:function(){if(s.pause(),!f){var m=n.duration||Math.abs((o-(c&&"time"in c?c.time:s._time))/s.timeScale());p._dur!==m&&dt(p,m,0,1).render(p._time,!0,!0),f=1}h&&h.apply(p,d||[])}},n));return g?p.render(0):p},t.tweenFromTo=function(i,n,s){return this.tweenTo(n,fe({startAt:{time:ge(this,i)}},s))},t.recent=function(){return this._recent},t.nextLabel=function(i){return i===void 0&&(i=this._time),ei(this,ge(this,i))},t.previousLabel=function(i){return i===void 0&&(i=this._time),ei(this,ge(this,i),1)},t.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+B)},t.shiftChildren=function(i,n,s){s===void 0&&(s=0);var o=this._first,l=this.labels,c;for(i=q(i);o;)o._start>=s&&(o._start+=i,o._end+=i),o=o._next;if(n)for(c in l)l[c]>=s&&(l[c]+=i);return je(this)},t.invalidate=function(i){var n=this._first;for(this._lock=0;n;)n.invalidate(i),n=n._next;return a.prototype.invalidate.call(this,i)},t.clear=function(i){i===void 0&&(i=!0);for(var n=this._first,s;n;)s=n._next,this.remove(n),n=s;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),je(this)},t.totalDuration=function(i){var n=0,s=this,o=s._last,l=pe,c,h,d;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-i:i));if(s._dirty){for(d=s.parent;o;)c=o._prev,o._dirty&&o.totalDuration(),h=o._start,h>l&&s._sort&&o._ts&&!s._lock?(s._lock=1,Ce(s,o,h-o._delay,1)._lock=0):l=h,h<0&&o._ts&&(n-=h,(!d&&!s._dp||d&&d.smoothChildTiming)&&(s._start+=q(h/s._ts),s._time-=h,s._tTime-=h),s.shiftChildren(-h,!1,-1/0),l=0),o._end>n&&o._ts&&(n=o._end),o=c;dt(s,s===$&&s._time>n?s._time:n,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(i){if($._ts&&(Ri($,Wt(i,$)),Di=le.frame),le.frame>=Kr){Kr+=de.autoSleep||120;var n=$._first;if((!n||!n._ts)&&de.autoSleep&&le._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||le.sleep()}}},e})(At);fe(te.prototype,{_lock:0,_hasPause:0,_forcing:0});var qs=function(e,t,r,i,n,s,o){var l=new ne(this._pt,e,t,0,1,cn,null,n),c=0,h=0,d,g,f,p,u,m,y,v;for(l.b=r,l.e=i,r+="",i+="",(y=~i.indexOf("random("))&&(i=kt(i)),s&&(v=[r,i],s(v,e,t),r=v[0],i=v[1]),g=r.match(Zt)||[];d=Zt.exec(i);)p=d[0],u=i.substring(c,d.index),f?f=(f+1)%5:u.substr(-5)==="rgba("&&(f=1),p!==g[h++]&&(m=parseFloat(g[h-1])||0,l._pt={_next:l._pt,p:u||h===1?u:",",s:m,c:p.charAt(1)==="="?st(m,p)-m:parseFloat(p)-m,m:f&&f<4?Math.round:0},c=Zt.lastIndex);return l.c=c<i.length?i.substring(c,i.length):"",l.fp=o,(Ai.test(i)||y)&&(l.e=0),this._pt=l,l},Nr=function(e,t,r,i,n,s,o,l,c,h){W(i)&&(i=i(n||0,e,s));var d=e[t],g=r!=="get"?r:W(d)?c?e[t.indexOf("set")||!W(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():d,f=W(d)?c?Ys:an:Fr,p;if(j(i)&&(~i.indexOf("random(")&&(i=kt(i)),i.charAt(1)==="="&&(p=st(g,i)+(Z(g)||0),(p||p===0)&&(i=p))),!h||g!==i||vr)return!isNaN(g*i)&&i!==""?(p=new ne(this._pt,e,t,+g||0,i-(g||0),typeof d=="boolean"?Xs:ln,0,f),c&&(p.fp=c),o&&p.modifier(o,this,e),this._pt=p):(!d&&!(t in e)&&Pr(t,i),qs.call(this,e,t,g,i,f,l||de.stringFilter,c))},$s=function(e,t,r,i,n){if(W(e)&&(e=Ct(e,n,t,r,i)),!Te(e)||e.style&&e.nodeType||ee(e)||ki(e))return j(e)?Ct(e,n,t,r,i):e;var s={},o;for(o in e)s[o]=Ct(e[o],n,t,r,i);return s},nn=function(e,t,r,i,n,s){var o,l,c,h;if(ae[e]&&(o=new ae[e]).init(n,o.rawVars?t[e]:$s(t[e],i,n,s,r),r,i,s)!==!1&&(r._pt=l=new ne(r._pt,n,e,0,1,o.render,o,0,o.priority),r!==nt))for(c=r._ptLookup[r._targets.indexOf(n)],h=o._props.length;h--;)c[o._props[h]]=l;return o},Me,vr,Br=function a(e,t,r){var i=e.vars,n=i.ease,s=i.startAt,o=i.immediateRender,l=i.lazy,c=i.onUpdate,h=i.runBackwards,d=i.yoyoEase,g=i.keyframes,f=i.autoRevert,p=e._dur,u=e._startAt,m=e._targets,y=e.parent,v=y&&y.data==="nested"?y.vars.targets:m,T=e._overwrite==="auto"&&!Er,C=e.timeline,b,k,S,x,w,A,O,P,D,M,R,L,z;if(C&&(!g||!n)&&(n="none"),e._ease=Ke(n,lt.ease),e._yEase=d?Zi(Ke(d===!0?n:d,lt.ease)):0,d&&e._yoyo&&!e._repeat&&(d=e._yEase,e._yEase=e._ease,e._ease=d),e._from=!C&&!!i.runBackwards,!C||g&&!i.stagger){if(P=m[0]?Xe(m[0]).harness:0,L=P&&i[P.prop],b=Ut(i,Dr),u&&(u._zTime<0&&u.progress(1),t<0&&h&&o&&!f?u.render(-1,!0):u.revert(h&&p?Rt:ms),u._lazy=0),s){if(Fe(e._startAt=Y.set(m,fe({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!u&&re(l),startAt:null,delay:0,onUpdate:c&&function(){return ce(e,"onUpdate")},stagger:0},s))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Q||!o&&!f)&&e._startAt.revert(Rt),o&&p&&t<=0&&r<=0){t&&(e._zTime=t);return}}else if(h&&p&&!u){if(t&&(o=!1),S=fe({overwrite:!1,data:"isFromStart",lazy:o&&!u&&re(l),immediateRender:o,stagger:0,parent:y},b),L&&(S[P.prop]=L),Fe(e._startAt=Y.set(m,S)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Q?e._startAt.revert(Rt):e._startAt.render(-1,!0)),e._zTime=t,!o)a(e._startAt,B,B);else if(!t)return}for(e._pt=e._ptCache=0,l=p&&re(l)||l&&!p,k=0;k<m.length;k++){if(w=m[k],O=w._gsap||Rr(m)[k]._gsap,e._ptLookup[k]=M={},gr[O.id]&&Ne.length&&$t(),R=v===m?k:v.indexOf(w),P&&(D=new P).init(w,L||b,e,R,v)!==!1&&(e._pt=x=new ne(e._pt,w,D.name,0,1,D.render,D,0,D.priority),D._props.forEach(function(X){M[X]=x}),D.priority&&(A=1)),!P||L)for(S in b)ae[S]&&(D=nn(S,b,e,R,w,v))?D.priority&&(A=1):M[S]=x=Nr.call(e,w,S,"get",b[S],R,v,0,i.stringFilter);e._op&&e._op[k]&&e.kill(w,e._op[k]),T&&e._pt&&(Me=e,$.killTweensOf(w,M,e.globalTime(t)),z=!e.parent,Me=0),e._pt&&l&&(gr[O.id]=1)}A&&hn(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!z,g&&t<=0&&C.render(pe,!0,!0)},Us=function(e,t,r,i,n,s,o,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],h,d,g,f;if(!c)for(c=e._ptCache[t]=[],g=e._ptLookup,f=e._targets.length;f--;){if(h=g[f][t],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==t&&h.fp!==t;)h=h._next;if(!h)return vr=1,e.vars[t]="+=0",Br(e,o),vr=0,l?xt(t+" not eligible for reset"):1;c.push(h)}for(f=c.length;f--;)d=c[f],h=d._pt||d,h.s=(i||i===0)&&!n?i:h.s+(i||0)+s*h.c,h.c=r-h.s,d.e&&(d.e=V(r)+Z(d.e)),d.b&&(d.b=h.s+Z(d.b))},Ws=function(e,t){var r=e[0]?Xe(e[0]).harness:0,i=r&&r.aliases,n,s,o,l;if(!i)return t;n=ct({},t);for(s in i)if(s in n)for(l=i[s].split(","),o=l.length;o--;)n[l[o]]=n[s];return n},Vs=function(e,t,r,i){var n=t.ease||i||"power1.inOut",s,o;if(ee(t))o=r[e]||(r[e]=[]),t.forEach(function(l,c){return o.push({t:c/(t.length-1)*100,v:l,e:n})});else for(s in t)o=r[s]||(r[s]=[]),s==="ease"||o.push({t:parseFloat(e),v:t[s],e:n})},Ct=function(e,t,r,i,n){return W(e)?e.call(t,r,i,n):j(e)&&~e.indexOf("random(")?kt(e):e},sn=Mr+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",on={};ie(sn+",id,stagger,delay,duration,paused,scrollTrigger",function(a){return on[a]=1});var Y=(function(a){xi(e,a);function e(r,i,n,s){var o;typeof i=="number"&&(n.duration=i,i=n,n=null),o=a.call(this,s?i:bt(i))||this;var l=o.vars,c=l.duration,h=l.delay,d=l.immediateRender,g=l.stagger,f=l.overwrite,p=l.keyframes,u=l.defaults,m=l.scrollTrigger,y=l.yoyoEase,v=i.parent||$,T=(ee(r)||ki(r)?Ae(r[0]):"length"in i)?[r]:me(r),C,b,k,S,x,w,A,O;if(o._targets=T.length?Rr(T):xt("GSAP target "+r+" not found. https://gsap.com",!de.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=f,p||g||Dt(c)||Dt(h)){if(i=o.vars,C=o.timeline=new te({data:"nested",defaults:u||{},targets:v&&v.data==="nested"?v.vars.targets:T}),C.kill(),C.parent=C._dp=ke(o),C._start=0,g||Dt(c)||Dt(h)){if(S=T.length,A=g&&Ui(g),Te(g))for(x in g)~sn.indexOf(x)&&(O||(O={}),O[x]=g[x]);for(b=0;b<S;b++)k=Ut(i,on),k.stagger=0,y&&(k.yoyoEase=y),O&&ct(k,O),w=T[b],k.duration=+Ct(c,ke(o),b,w,T),k.delay=(+Ct(h,ke(o),b,w,T)||0)-o._delay,!g&&S===1&&k.delay&&(o._delay=h=k.delay,o._start+=h,k.delay=0),C.to(w,k,A?A(b,w,T):0),C._ease=I.none;C.duration()?c=h=0:o.timeline=0}else if(p){bt(fe(C.vars.defaults,{ease:"none"})),C._ease=Ke(p.ease||i.ease||"none");var P=0,D,M,R;if(ee(p))p.forEach(function(L){return C.to(T,L,">")}),C.duration();else{k={};for(x in p)x==="ease"||x==="easeEach"||Vs(x,p[x],k,p.easeEach);for(x in k)for(D=k[x].sort(function(L,z){return L.t-z.t}),P=0,b=0;b<D.length;b++)M=D[b],R={ease:M.e,duration:(M.t-(b?D[b-1].t:0))/100*c},R[x]=M.v,C.to(T,R,P),P+=R.duration;C.duration()<c&&C.to({},{duration:c-C.duration()})}}c||o.duration(c=C.duration())}else o.timeline=0;return f===!0&&!Er&&(Me=ke(o),$.killTweensOf(T),Me=0),Ce(v,ke(o),n),i.reversed&&o.reverse(),i.paused&&o.paused(!0),(d||!c&&!p&&o._start===q(v._time)&&re(d)&&ws(ke(o))&&v.data!=="nested")&&(o._tTime=-B,o.render(Math.max(0,-h)||0)),m&&zi(ke(o),m),o}var t=e.prototype;return t.render=function(i,n,s){var o=this._time,l=this._tDur,c=this._dur,h=i<0,d=i>l-B&&!h?l:i<B?0:i,g,f,p,u,m,y,v,T,C;if(!c)xs(this,i,n,s);else if(d!==this._tTime||!i||s||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h||this._lazy){if(g=d,T=this.timeline,this._repeat){if(u=c+this._rDelay,this._repeat<-1&&h)return this.totalTime(u*100+i,n,s);if(g=q(d%u),d===l?(p=this._repeat,g=c):(m=q(d/u),p=~~m,p&&p===m?(g=c,p--):g>c&&(g=c)),y=this._yoyo&&p&1,y&&(C=this._yEase,g=c-g),m=ht(this._tTime,u),g===o&&!s&&this._initted&&p===m)return this._tTime=d,this;p!==m&&(T&&this._yEase&&en(T,y),this.vars.repeatRefresh&&!y&&!this._lock&&g!==u&&this._initted&&(this._lock=s=1,this.render(q(u*p),!0).invalidate()._lock=0))}if(!this._initted){if(Hi(this,h?i:g,s,n,d))return this._tTime=0,this;if(o!==this._time&&!(s&&this.vars.repeatRefresh&&p!==m))return this;if(c!==this._dur)return this.render(i,n,s)}if(this._tTime=d,this._time=g,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(C||this._ease)(g/c),this._from&&(this.ratio=v=1-v),!o&&d&&!n&&!m&&(ce(this,"onStart"),this._tTime!==d))return this;for(f=this._pt;f;)f.r(v,f.d),f=f._next;T&&T.render(i<0?i:T._dur*T._ease(g/this._dur),n,s)||this._startAt&&(this._zTime=i),this._onUpdate&&!n&&(h&&pr(this,i,n,s),ce(this,"onUpdate")),this._repeat&&p!==m&&this.vars.onRepeat&&!n&&this.parent&&ce(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(h&&!this._onUpdate&&pr(this,i,!0,!0),(i||!c)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&Fe(this,1),!n&&!(h&&!o)&&(d||o||y)&&(ce(this,d===l?"onComplete":"onReverseComplete",!0),this._prom&&!(d<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),a.prototype.invalidate.call(this,i)},t.resetTo=function(i,n,s,o,l){Et||le.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||Br(this,c),h=this._ease(c/this._dur),Us(this,i,n,s,o,h,c,l)?this.resetTo(i,n,s,o,1):(Qt(this,0),this.parent||Bi(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(i,n){if(n===void 0&&(n="all"),!i&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?_t(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Q),this;if(this.timeline){var s=this.timeline.totalDuration();return this.timeline.killTweensOf(i,n,Me&&Me.vars.overwrite!==!0)._first||_t(this),this.parent&&s!==this.timeline.totalDuration()&&dt(this,this._dur*this.timeline._tDur/s,0,1),this}var o=this._targets,l=i?me(i):o,c=this._ptLookup,h=this._pt,d,g,f,p,u,m,y;if((!n||n==="all")&&vs(o,l))return n==="all"&&(this._pt=0),_t(this);for(d=this._op=this._op||[],n!=="all"&&(j(n)&&(u={},ie(n,function(v){return u[v]=1}),n=u),n=Ws(o,n)),y=o.length;y--;)if(~l.indexOf(o[y])){g=c[y],n==="all"?(d[y]=n,p=g,f={}):(f=d[y]=d[y]||{},p=n);for(u in p)m=g&&g[u],m&&((!("kill"in m.d)||m.d.kill(u)===!0)&&Kt(this,m,"_pt"),delete g[u]),f!=="all"&&(f[u]=1)}return this._initted&&!this._pt&&h&&_t(this),this},e.to=function(i,n){return new e(i,n,arguments[2])},e.from=function(i,n){return vt(1,arguments)},e.delayedCall=function(i,n,s,o){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:n,onReverseComplete:n,onCompleteParams:s,onReverseCompleteParams:s,callbackScope:o})},e.fromTo=function(i,n,s){return vt(2,arguments)},e.set=function(i,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(i,n)},e.killTweensOf=function(i,n,s){return $.killTweensOf(i,n,s)},e})(At);fe(Y.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ie("staggerTo,staggerFrom,staggerFromTo",function(a){Y[a]=function(){var e=new te,t=_r.call(arguments,0);return t.splice(a==="staggerFromTo"?5:4,0,0),e[a].apply(e,t)}});var Fr=function(e,t,r){return e[t]=r},an=function(e,t,r){return e[t](r)},Ys=function(e,t,r,i){return e[t](i.fp,r)},Gs=function(e,t,r){return e.setAttribute(t,r)},zr=function(e,t){return W(e[t])?an:Ar(e[t])&&e.setAttribute?Gs:Fr},ln=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},Xs=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},cn=function(e,t){var r=t._pt,i="";if(!e&&t.b)i=t.b;else if(e===1&&t.e)i=t.e;else{for(;r;)i=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+i,r=r._next;i+=t.c}t.set(t.t,t.p,i,t)},Hr=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},js=function(e,t,r,i){for(var n=this._pt,s;n;)s=n._next,n.p===i&&n.modifier(e,t,r),n=s},Ks=function(e){for(var t=this._pt,r,i;t;)i=t._next,t.p===e&&!t.op||t.op===e?Kt(this,t,"_pt"):t.dep||(r=1),t=i;return!r},Js=function(e,t,r,i){i.mSet(e,t,i.m.call(i.tween,r,i.mt),i)},hn=function(e){for(var t=e._pt,r,i,n,s;t;){for(r=t._next,i=n;i&&i.pr>t.pr;)i=i._next;(t._prev=i?i._prev:s)?t._prev._next=t:n=t,(t._next=i)?i._prev=t:s=t,t=r}e._pt=n},ne=(function(){function a(t,r,i,n,s,o,l,c,h){this.t=r,this.s=n,this.c=s,this.p=i,this.r=o||ln,this.d=l||this,this.set=c||Fr,this.pr=h||0,this._next=t,t&&(t._prev=this)}var e=a.prototype;return e.modifier=function(r,i,n){this.mSet=this.mSet||this.set,this.set=Js,this.m=r,this.mt=n,this.tween=i},a})();ie(Mr+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(a){return Dr[a]=1});ue.TweenMax=ue.TweenLite=Y;ue.TimelineLite=ue.TimelineMax=te;$=new te({sortChildren:!1,defaults:lt,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});de.stringFilter=Qi;var Je=[],Nt={},Qs=[],ri=0,Zs=0,nr=function(e){return(Nt[e]||Qs).map(function(t){return t()})},Cr=function(){var e=Date.now(),t=[];e-ri>2&&(nr("matchMediaInit"),Je.forEach(function(r){var i=r.queries,n=r.conditions,s,o,l,c;for(o in i)s=ve.matchMedia(i[o]).matches,s&&(l=1),s!==n[o]&&(n[o]=s,c=1);c&&(r.revert(),l&&t.push(r))}),nr("matchMediaRevert"),t.forEach(function(r){return r.onMatch(r,function(i){return r.add(null,i)})}),ri=e,nr("matchMedia"))},dn=(function(){function a(t,r){this.selector=r&&yr(r),this.data=[],this._r=[],this.isReverted=!1,this.id=Zs++,t&&this.add(t)}var e=a.prototype;return e.add=function(r,i,n){W(r)&&(n=i,i=r,r=W);var s=this,o=function(){var c=H,h=s.selector,d;return c&&c!==s&&c.data.push(s),n&&(s.selector=yr(n)),H=s,d=i.apply(s,arguments),W(d)&&s._r.push(d),H=c,s.selector=h,s.isReverted=!1,d};return s.last=o,r===W?o(s,function(l){return s.add(null,l)}):r?s[r]=o:o},e.ignore=function(r){var i=H;H=null,r(this),H=i},e.getTweens=function(){var r=[];return this.data.forEach(function(i){return i instanceof a?r.push.apply(r,i.getTweens()):i instanceof Y&&!(i.parent&&i.parent.data==="nested")&&r.push(i)}),r},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(r,i){var n=this;if(r?(function(){for(var o=n.getTweens(),l=n.data.length,c;l--;)c=n.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(h){return o.splice(o.indexOf(h),1)}));for(o.map(function(h){return{g:h._dur||h._delay||h._sat&&!h._sat.vars.immediateRender?h.globalTime(0):-1/0,t:h}}).sort(function(h,d){return d.g-h.g||-1/0}).forEach(function(h){return h.t.revert(r)}),l=n.data.length;l--;)c=n.data[l],c instanceof te?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof Y)&&c.revert&&c.revert(r);n._r.forEach(function(h){return h(r,n)}),n.isReverted=!0})():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),i)for(var s=Je.length;s--;)Je[s].id===this.id&&Je.splice(s,1)},e.revert=function(r){this.kill(r||{})},a})(),eo=(function(){function a(t){this.contexts=[],this.scope=t,H&&H.data.push(this)}var e=a.prototype;return e.add=function(r,i,n){Te(r)||(r={matches:r});var s=new dn(0,n||this.scope),o=s.conditions={},l,c,h;H&&!s.selector&&(s.selector=H.selector),this.contexts.push(s),i=s.add("onMatch",i),s.queries=r;for(c in r)c==="all"?h=1:(l=ve.matchMedia(r[c]),l&&(Je.indexOf(s)<0&&Je.push(s),(o[c]=l.matches)&&(h=1),l.addListener?l.addListener(Cr):l.addEventListener("change",Cr)));return h&&i(s,function(d){return s.add(null,d)}),this},e.revert=function(r){this.kill(r||{})},e.kill=function(r){this.contexts.forEach(function(i){return i.kill(r,!0)})},a})(),Vt={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(i){return ji(i)})},timeline:function(e){return new te(e)},getTweensOf:function(e,t){return $.getTweensOf(e,t)},getProperty:function(e,t,r,i){j(e)&&(e=me(e)[0]);var n=Xe(e||{}).get,s=r?Ni:Li;return r==="native"&&(r=""),e&&(t?s((ae[t]&&ae[t].get||n)(e,t,r,i)):function(o,l,c){return s((ae[o]&&ae[o].get||n)(e,o,l,c))})},quickSetter:function(e,t,r){if(e=me(e),e.length>1){var i=e.map(function(h){return oe.quickSetter(h,t,r)}),n=i.length;return function(h){for(var d=n;d--;)i[d](h)}}e=e[0]||{};var s=ae[t],o=Xe(e),l=o.harness&&(o.harness.aliases||{})[t]||t,c=s?function(h){var d=new s;nt._pt=0,d.init(e,r?h+r:h,nt,0,[e]),d.render(1,d),nt._pt&&Hr(1,nt)}:o.set(e,l);return s?c:function(h){return c(e,l,r?h+r:h,o,1)}},quickTo:function(e,t,r){var i,n=oe.to(e,fe((i={},i[t]="+=0.1",i.paused=!0,i.stagger=0,i),r||{})),s=function(l,c,h){return n.resetTo(t,l,c,h)};return s.tween=n,s},isTweening:function(e){return $.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Ke(e.ease,lt.ease)),Jr(lt,e||{})},config:function(e){return Jr(de,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,i=e.plugins,n=e.defaults,s=e.extendTimeline;(i||"").split(",").forEach(function(o){return o&&!ae[o]&&!ue[o]&&xt(t+" effect requires "+o+" plugin.")}),er[t]=function(o,l,c){return r(me(o),fe(l||{},n),c)},s&&(te.prototype[t]=function(o,l,c){return this.add(er[t](o,Te(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){I[e]=Ke(t)},parseEase:function(e,t){return arguments.length?Ke(e,t):I},getById:function(e){return $.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var r=new te(e),i,n;for(r.smoothChildTiming=re(e.smoothChildTiming),$.remove(r),r._dp=0,r._time=r._tTime=$._time,i=$._first;i;)n=i._next,(t||!(!i._dur&&i instanceof Y&&i.vars.onComplete===i._targets[0]))&&Ce(r,i,i._start-i._delay),i=n;return Ce($,r,0),r},context:function(e,t){return e?new dn(e,t):H},matchMedia:function(e){return new eo(e)},matchMediaRefresh:function(){return Je.forEach(function(e){var t=e.conditions,r,i;for(i in t)t[i]&&(t[i]=!1,r=1);r&&e.revert()})||Cr()},addEventListener:function(e,t){var r=Nt[e]||(Nt[e]=[]);~r.indexOf(t)||r.push(t)},removeEventListener:function(e,t){var r=Nt[e],i=r&&r.indexOf(t);i>=0&&r.splice(i,1)},utils:{wrap:Ds,wrapYoyo:Ms,distribute:Ui,random:Vi,snap:Wi,normalize:Ps,getUnit:Z,clamp:Es,splitColor:Ki,toArray:me,selector:yr,mapRange:Gi,pipe:Is,unitize:Os,interpolate:Rs,shuffle:$i},install:Oi,effects:er,ticker:le,updateRoot:te.updateRoot,plugins:ae,globalTimeline:$,core:{PropTween:ne,globals:Pi,Tween:Y,Timeline:te,Animation:At,getCache:Xe,_removeLinkedListItem:Kt,reverting:function(){return Q},context:function(e){return e&&H&&(H.data.push(e),e._ctx=H),H},suppressOverwrites:function(e){return Er=e}}};ie("to,from,fromTo,delayedCall,set,killTweensOf",function(a){return Vt[a]=Y[a]});le.add(te.updateRoot);nt=Vt.to({},{duration:0});var to=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},ro=function(e,t){var r=e._targets,i,n,s;for(i in t)for(n=r.length;n--;)s=e._ptLookup[n][i],s&&(s=s.d)&&(s._pt&&(s=to(s,i)),s&&s.modifier&&s.modifier(t[i],e,r[n],i))},sr=function(e,t){return{name:e,headless:1,rawVars:1,init:function(i,n,s){s._onInit=function(o){var l,c;if(j(n)&&(l={},ie(n,function(h){return l[h]=1}),n=l),t){l={};for(c in n)l[c]=t(n[c]);n=l}ro(o,n)}}}},oe=Vt.registerPlugin({name:"attr",init:function(e,t,r,i,n){var s,o,l;this.tween=r;for(s in t)l=e.getAttribute(s)||"",o=this.add(e,"setAttribute",(l||0)+"",t[s],i,n,0,0,s),o.op=s,o.b=l,this._props.push(s)},render:function(e,t){for(var r=t._pt;r;)Q?r.set(r.t,r.p,r.b,r):r.r(e,r.d),r=r._next}},{name:"endArray",headless:1,init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r],0,0,0,0,0,1)}},sr("roundProps",br),sr("modifiers"),sr("snap",Wi))||Vt;Y.version=te.version=oe.version="3.14.2";Ii=1;Ir()&&ut();I.Power0;I.Power1;I.Power2;I.Power3;I.Power4;I.Linear;I.Quad;I.Cubic;I.Quart;I.Quint;I.Strong;I.Elastic;I.Back;I.SteppedEase;I.Bounce;I.Sine;I.Expo;I.Circ;var ii,Re,ot,qr,Ye,ni,$r,io=function(){return typeof window<"u"},Ie={},Ve=180/Math.PI,at=Math.PI/180,tt=Math.atan2,si=1e8,Ur=/([A-Z])/g,no=/(left|right|width|margin|padding|x)/i,so=/[\s,\(]\S/,we={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},wr=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},oo=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},ao=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},lo=function(e,t){return t.set(t.t,t.p,e===1?t.e:e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},co=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},un=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},fn=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},ho=function(e,t,r){return e.style[t]=r},uo=function(e,t,r){return e.style.setProperty(t,r)},fo=function(e,t,r){return e._gsap[t]=r},go=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},po=function(e,t,r,i,n){var s=e._gsap;s.scaleX=s.scaleY=r,s.renderTransform(n,s)},mo=function(e,t,r,i,n){var s=e._gsap;s[t]=r,s.renderTransform(n,s)},U="transform",se=U+"Origin",_o=function a(e,t){var r=this,i=this.target,n=i.style,s=i._gsap;if(e in Ie&&n){if(this.tfm=this.tfm||{},e!=="transform")e=we[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return r.tfm[o]=Ee(i,o)}):this.tfm[e]=s.x?s[e]:Ee(i,e),e===se&&(this.tfm.zOrigin=s.zOrigin);else return we.transform.split(",").forEach(function(o){return a.call(r,o,t)});if(this.props.indexOf(U)>=0)return;s.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(se,t,"")),e=U}(n||t)&&this.props.push(e,t,n[e])},gn=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},yo=function(){var e=this.props,t=this.target,r=t.style,i=t._gsap,n,s;for(n=0;n<e.length;n+=3)e[n+1]?e[n+1]===2?t[e[n]](e[n+2]):t[e[n]]=e[n+2]:e[n+2]?r[e[n]]=e[n+2]:r.removeProperty(e[n].substr(0,2)==="--"?e[n]:e[n].replace(Ur,"-$1").toLowerCase());if(this.tfm){for(s in this.tfm)i[s]=this.tfm[s];i.svg&&(i.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),n=$r(),(!n||!n.isStart)&&!r[U]&&(gn(r),i.zOrigin&&r[se]&&(r[se]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},pn=function(e,t){var r={target:e,props:[],revert:yo,save:_o};return e._gsap||oe.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(i){return r.save(i)}),r},mn,Tr=function(e,t){var r=Re.createElementNS?Re.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Re.createElement(e);return r&&r.style?r:Re.createElement(e)},he=function a(e,t,r){var i=getComputedStyle(e);return i[t]||i.getPropertyValue(t.replace(Ur,"-$1").toLowerCase())||i.getPropertyValue(t)||!r&&a(e,ft(t)||t,1)||""},oi="O,Moz,ms,Ms,Webkit".split(","),ft=function(e,t,r){var i=t||Ye,n=i.style,s=5;if(e in n&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);s--&&!(oi[s]+e in n););return s<0?null:(s===3?"ms":s>=0?oi[s]:"")+e},xr=function(){io()&&window.document&&(ii=window,Re=ii.document,ot=Re.documentElement,Ye=Tr("div")||{style:{}},Tr("div"),U=ft(U),se=U+"Origin",Ye.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",mn=!!ft("perspective"),$r=oe.core.reverting,qr=1)},ai=function(e){var t=e.ownerSVGElement,r=Tr("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=e.cloneNode(!0),n;i.style.display="block",r.appendChild(i),ot.appendChild(r);try{n=i.getBBox()}catch{}return r.removeChild(i),ot.removeChild(r),n},li=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},_n=function(e){var t,r;try{t=e.getBBox()}catch{t=ai(e),r=1}return t&&(t.width||t.height)||r||(t=ai(e)),t&&!t.width&&!t.x&&!t.y?{x:+li(e,["x","cx","x1"])||0,y:+li(e,["y","cy","y1"])||0,width:0,height:0}:t},yn=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&_n(e))},ze=function(e,t){if(t){var r=e.style,i;t in Ie&&t!==se&&(t=U),r.removeProperty?(i=t.substr(0,2),(i==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),r.removeProperty(i==="--"?t:t.replace(Ur,"-$1").toLowerCase())):r.removeAttribute(t)}},Le=function(e,t,r,i,n,s){var o=new ne(e._pt,t,r,0,1,s?fn:un);return e._pt=o,o.b=i,o.e=n,e._props.push(r),o},ci={deg:1,rad:1,turn:1},bo={grid:1,flex:1},He=function a(e,t,r,i){var n=parseFloat(r)||0,s=(r+"").trim().substr((n+"").length)||"px",o=Ye.style,l=no.test(t),c=e.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(l?"Width":"Height"),d=100,g=i==="px",f=i==="%",p,u,m,y;if(i===s||!n||ci[i]||ci[s])return n;if(s!=="px"&&!g&&(n=a(e,t,r,"px")),y=e.getCTM&&yn(e),(f||s==="%")&&(Ie[t]||~t.indexOf("adius")))return p=y?e.getBBox()[l?"width":"height"]:e[h],V(f?n/p*d:n/100*p);if(o[l?"width":"height"]=d+(g?s:i),u=i!=="rem"&&~t.indexOf("adius")||i==="em"&&e.appendChild&&!c?e:e.parentNode,y&&(u=(e.ownerSVGElement||{}).parentNode),(!u||u===Re||!u.appendChild)&&(u=Re.body),m=u._gsap,m&&f&&m.width&&l&&m.time===le.time&&!m.uncache)return V(n/m.width*d);if(f&&(t==="height"||t==="width")){var v=e.style[t];e.style[t]=d+i,p=e[h],v?e.style[t]=v:ze(e,t)}else(f||s==="%")&&!bo[he(u,"display")]&&(o.position=he(e,"position")),u===e&&(o.position="static"),u.appendChild(Ye),p=Ye[h],u.removeChild(Ye),o.position="absolute";return l&&f&&(m=Xe(u),m.time=le.time,m.width=u[h]),V(g?p*n/d:p&&n?d/p*n:0)},Ee=function(e,t,r,i){var n;return qr||xr(),t in we&&t!=="transform"&&(t=we[t],~t.indexOf(",")&&(t=t.split(",")[0])),Ie[t]&&t!=="transform"?(n=Ot(e,i),n=t!=="transformOrigin"?n[t]:n.svg?n.origin:Gt(he(e,se))+" "+n.zOrigin+"px"):(n=e.style[t],(!n||n==="auto"||i||~(n+"").indexOf("calc("))&&(n=Yt[t]&&Yt[t](e,t,r)||he(e,t)||Mi(e,t)||(t==="opacity"?1:0))),r&&!~(n+"").trim().indexOf(" ")?He(e,t,n,r)+r:n},vo=function(e,t,r,i){if(!r||r==="none"){var n=ft(t,e,1),s=n&&he(e,n,1);s&&s!==r?(t=n,r=s):t==="borderColor"&&(r=he(e,"borderTopColor"))}var o=new ne(this._pt,e.style,t,0,1,cn),l=0,c=0,h,d,g,f,p,u,m,y,v,T,C,b;if(o.b=r,o.e=i,r+="",i+="",i.substring(0,6)==="var(--"&&(i=he(e,i.substring(4,i.indexOf(")")))),i==="auto"&&(u=e.style[t],e.style[t]=i,i=he(e,t)||i,u?e.style[t]=u:ze(e,t)),h=[r,i],Qi(h),r=h[0],i=h[1],g=r.match(it)||[],b=i.match(it)||[],b.length){for(;d=it.exec(i);)m=d[0],v=i.substring(l,d.index),p?p=(p+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(p=1),m!==(u=g[c++]||"")&&(f=parseFloat(u)||0,C=u.substr((f+"").length),m.charAt(1)==="="&&(m=st(f,m)+C),y=parseFloat(m),T=m.substr((y+"").length),l=it.lastIndex-T.length,T||(T=T||de.units[t]||C,l===i.length&&(i+=T,o.e+=T)),C!==T&&(f=He(e,t,u,T)||0),o._pt={_next:o._pt,p:v||c===1?v:",",s:f,c:y-f,m:p&&p<4||t==="zIndex"?Math.round:0});o.c=l<i.length?i.substring(l,i.length):""}else o.r=t==="display"&&i==="none"?fn:un;return Ai.test(i)&&(o.e=0),this._pt=o,o},hi={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Co=function(e){var t=e.split(" "),r=t[0],i=t[1]||"50%";return(r==="top"||r==="bottom"||i==="left"||i==="right")&&(e=r,r=i,i=e),t[0]=hi[r]||r,t[1]=hi[i]||i,t.join(" ")},wo=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r=t.t,i=r.style,n=t.u,s=r._gsap,o,l,c;if(n==="all"||n===!0)i.cssText="",l=1;else for(n=n.split(","),c=n.length;--c>-1;)o=n[c],Ie[o]&&(l=1,o=o==="transformOrigin"?se:U),ze(r,o);l&&(ze(r,U),s&&(s.svg&&r.removeAttribute("transform"),i.scale=i.rotate=i.translate="none",Ot(r,1),s.uncache=1,gn(i)))}},Yt={clearProps:function(e,t,r,i,n){if(n.data!=="isFromStart"){var s=e._pt=new ne(e._pt,t,r,0,0,wo);return s.u=i,s.pr=-10,s.tween=n,e._props.push(r),1}}},It=[1,0,0,1,0,0],bn={},vn=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},di=function(e){var t=he(e,U);return vn(t)?It:t.substr(7).match(Ei).map(V)},Wr=function(e,t){var r=e._gsap||Xe(e),i=e.style,n=di(e),s,o,l,c;return r.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,n=[l.a,l.b,l.c,l.d,l.e,l.f],n.join(",")==="1,0,0,1,0,0"?It:n):(n===It&&!e.offsetParent&&e!==ot&&!r.svg&&(l=i.display,i.display="block",s=e.parentNode,(!s||!e.offsetParent&&!e.getBoundingClientRect().width)&&(c=1,o=e.nextElementSibling,ot.appendChild(e)),n=di(e),l?i.display=l:ze(e,"display"),c&&(o?s.insertBefore(e,o):s?s.appendChild(e):ot.removeChild(e))),t&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},Sr=function(e,t,r,i,n,s){var o=e._gsap,l=n||Wr(e,!0),c=o.xOrigin||0,h=o.yOrigin||0,d=o.xOffset||0,g=o.yOffset||0,f=l[0],p=l[1],u=l[2],m=l[3],y=l[4],v=l[5],T=t.split(" "),C=parseFloat(T[0])||0,b=parseFloat(T[1])||0,k,S,x,w;r?l!==It&&(S=f*m-p*u)&&(x=C*(m/S)+b*(-u/S)+(u*v-m*y)/S,w=C*(-p/S)+b*(f/S)-(f*v-p*y)/S,C=x,b=w):(k=_n(e),C=k.x+(~T[0].indexOf("%")?C/100*k.width:C),b=k.y+(~(T[1]||T[0]).indexOf("%")?b/100*k.height:b)),i||i!==!1&&o.smooth?(y=C-c,v=b-h,o.xOffset=d+(y*f+v*u)-y,o.yOffset=g+(y*p+v*m)-v):o.xOffset=o.yOffset=0,o.xOrigin=C,o.yOrigin=b,o.smooth=!!i,o.origin=t,o.originIsAbsolute=!!r,e.style[se]="0px 0px",s&&(Le(s,o,"xOrigin",c,C),Le(s,o,"yOrigin",h,b),Le(s,o,"xOffset",d,o.xOffset),Le(s,o,"yOffset",g,o.yOffset)),e.setAttribute("data-svg-origin",C+" "+b)},Ot=function(e,t){var r=e._gsap||new rn(e);if("x"in r&&!t&&!r.uncache)return r;var i=e.style,n=r.scaleX<0,s="px",o="deg",l=getComputedStyle(e),c=he(e,se)||"0",h,d,g,f,p,u,m,y,v,T,C,b,k,S,x,w,A,O,P,D,M,R,L,z,X,$e,Oe,_e,be,gt,ye,xe;return h=d=g=u=m=y=v=T=C=0,f=p=1,r.svg=!!(e.getCTM&&yn(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(i[U]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[U]!=="none"?l[U]:"")),i.scale=i.rotate=i.translate="none"),S=Wr(e,r.svg),r.svg&&(r.uncache?(X=e.getBBox(),c=r.xOrigin-X.x+"px "+(r.yOrigin-X.y)+"px",z=""):z=!t&&e.getAttribute("data-svg-origin"),Sr(e,z||c,!!z||r.originIsAbsolute,r.smooth!==!1,S)),b=r.xOrigin||0,k=r.yOrigin||0,S!==It&&(O=S[0],P=S[1],D=S[2],M=S[3],h=R=S[4],d=L=S[5],S.length===6?(f=Math.sqrt(O*O+P*P),p=Math.sqrt(M*M+D*D),u=O||P?tt(P,O)*Ve:0,v=D||M?tt(D,M)*Ve+u:0,v&&(p*=Math.abs(Math.cos(v*at))),r.svg&&(h-=b-(b*O+k*D),d-=k-(b*P+k*M))):(xe=S[6],gt=S[7],Oe=S[8],_e=S[9],be=S[10],ye=S[11],h=S[12],d=S[13],g=S[14],x=tt(xe,be),m=x*Ve,x&&(w=Math.cos(-x),A=Math.sin(-x),z=R*w+Oe*A,X=L*w+_e*A,$e=xe*w+be*A,Oe=R*-A+Oe*w,_e=L*-A+_e*w,be=xe*-A+be*w,ye=gt*-A+ye*w,R=z,L=X,xe=$e),x=tt(-D,be),y=x*Ve,x&&(w=Math.cos(-x),A=Math.sin(-x),z=O*w-Oe*A,X=P*w-_e*A,$e=D*w-be*A,ye=M*A+ye*w,O=z,P=X,D=$e),x=tt(P,O),u=x*Ve,x&&(w=Math.cos(x),A=Math.sin(x),z=O*w+P*A,X=R*w+L*A,P=P*w-O*A,L=L*w-R*A,O=z,R=X),m&&Math.abs(m)+Math.abs(u)>359.9&&(m=u=0,y=180-y),f=V(Math.sqrt(O*O+P*P+D*D)),p=V(Math.sqrt(L*L+xe*xe)),x=tt(R,L),v=Math.abs(x)>2e-4?x*Ve:0,C=ye?1/(ye<0?-ye:ye):0),r.svg&&(z=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!vn(he(e,U)),z&&e.setAttribute("transform",z))),Math.abs(v)>90&&Math.abs(v)<270&&(n?(f*=-1,v+=u<=0?180:-180,u+=u<=0?180:-180):(p*=-1,v+=v<=0?180:-180)),t=t||r.uncache,r.x=h-((r.xPercent=h&&(!t&&r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-h)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+s,r.y=d-((r.yPercent=d&&(!t&&r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-d)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+s,r.z=g+s,r.scaleX=V(f),r.scaleY=V(p),r.rotation=V(u)+o,r.rotationX=V(m)+o,r.rotationY=V(y)+o,r.skewX=v+o,r.skewY=T+o,r.transformPerspective=C+s,(r.zOrigin=parseFloat(c.split(" ")[2])||!t&&r.zOrigin||0)&&(i[se]=Gt(c)),r.xOffset=r.yOffset=0,r.force3D=de.force3D,r.renderTransform=r.svg?xo:mn?Cn:To,r.uncache=0,r},Gt=function(e){return(e=e.split(" "))[0]+" "+e[1]},or=function(e,t,r){var i=Z(t);return V(parseFloat(t)+parseFloat(He(e,"x",r+"px",i)))+i},To=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Cn(e,t)},Ue="0deg",pt="0px",We=") ",Cn=function(e,t){var r=t||this,i=r.xPercent,n=r.yPercent,s=r.x,o=r.y,l=r.z,c=r.rotation,h=r.rotationY,d=r.rotationX,g=r.skewX,f=r.skewY,p=r.scaleX,u=r.scaleY,m=r.transformPerspective,y=r.force3D,v=r.target,T=r.zOrigin,C="",b=y==="auto"&&e&&e!==1||y===!0;if(T&&(d!==Ue||h!==Ue)){var k=parseFloat(h)*at,S=Math.sin(k),x=Math.cos(k),w;k=parseFloat(d)*at,w=Math.cos(k),s=or(v,s,S*w*-T),o=or(v,o,-Math.sin(k)*-T),l=or(v,l,x*w*-T+T)}m!==pt&&(C+="perspective("+m+We),(i||n)&&(C+="translate("+i+"%, "+n+"%) "),(b||s!==pt||o!==pt||l!==pt)&&(C+=l!==pt||b?"translate3d("+s+", "+o+", "+l+") ":"translate("+s+", "+o+We),c!==Ue&&(C+="rotate("+c+We),h!==Ue&&(C+="rotateY("+h+We),d!==Ue&&(C+="rotateX("+d+We),(g!==Ue||f!==Ue)&&(C+="skew("+g+", "+f+We),(p!==1||u!==1)&&(C+="scale("+p+", "+u+We),v.style[U]=C||"translate(0, 0)"},xo=function(e,t){var r=t||this,i=r.xPercent,n=r.yPercent,s=r.x,o=r.y,l=r.rotation,c=r.skewX,h=r.skewY,d=r.scaleX,g=r.scaleY,f=r.target,p=r.xOrigin,u=r.yOrigin,m=r.xOffset,y=r.yOffset,v=r.forceCSS,T=parseFloat(s),C=parseFloat(o),b,k,S,x,w;l=parseFloat(l),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,l+=h),l||c?(l*=at,c*=at,b=Math.cos(l)*d,k=Math.sin(l)*d,S=Math.sin(l-c)*-g,x=Math.cos(l-c)*g,c&&(h*=at,w=Math.tan(c-h),w=Math.sqrt(1+w*w),S*=w,x*=w,h&&(w=Math.tan(h),w=Math.sqrt(1+w*w),b*=w,k*=w)),b=V(b),k=V(k),S=V(S),x=V(x)):(b=d,x=g,k=S=0),(T&&!~(s+"").indexOf("px")||C&&!~(o+"").indexOf("px"))&&(T=He(f,"x",s,"px"),C=He(f,"y",o,"px")),(p||u||m||y)&&(T=V(T+p-(p*b+u*S)+m),C=V(C+u-(p*k+u*x)+y)),(i||n)&&(w=f.getBBox(),T=V(T+i/100*w.width),C=V(C+n/100*w.height)),w="matrix("+b+","+k+","+S+","+x+","+T+","+C+")",f.setAttribute("transform",w),v&&(f.style[U]=w)},So=function(e,t,r,i,n){var s=360,o=j(n),l=parseFloat(n)*(o&&~n.indexOf("rad")?Ve:1),c=l-i,h=i+c+"deg",d,g;return o&&(d=n.split("_")[1],d==="short"&&(c%=s,c!==c%(s/2)&&(c+=c<0?s:-s)),d==="cw"&&c<0?c=(c+s*si)%s-~~(c/s)*s:d==="ccw"&&c>0&&(c=(c-s*si)%s-~~(c/s)*s)),e._pt=g=new ne(e._pt,t,r,i,c,oo),g.e=h,g.u="deg",e._props.push(r),g},ui=function(e,t){for(var r in t)e[r]=t[r];return e},ko=function(e,t,r){var i=ui({},r._gsap),n="perspective,force3D,transformOrigin,svgOrigin",s=r.style,o,l,c,h,d,g,f,p;i.svg?(c=r.getAttribute("transform"),r.setAttribute("transform",""),s[U]=t,o=Ot(r,1),ze(r,U),r.setAttribute("transform",c)):(c=getComputedStyle(r)[U],s[U]=t,o=Ot(r,1),s[U]=c);for(l in Ie)c=i[l],h=o[l],c!==h&&n.indexOf(l)<0&&(f=Z(c),p=Z(h),d=f!==p?He(r,l,c,p):parseFloat(c),g=parseFloat(h),e._pt=new ne(e._pt,o,l,d,g-d,wr),e._pt.u=p||0,e._props.push(l));ui(o,i)};ie("padding,margin,Width,Radius",function(a,e){var t="Top",r="Right",i="Bottom",n="Left",s=(e<3?[t,r,i,n]:[t+n,t+r,i+r,i+n]).map(function(o){return e<2?a+o:"border"+o+a});Yt[e>1?"border"+a:a]=function(o,l,c,h,d){var g,f;if(arguments.length<4)return g=s.map(function(p){return Ee(o,p,c)}),f=g.join(" "),f.split(g[0]).length===5?g[0]:f;g=(h+"").split(" "),f={},s.forEach(function(p,u){return f[p]=g[u]=g[u]||g[(u-1)/2|0]}),o.init(l,f,d)}});var wn={name:"css",register:xr,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,i,n){var s=this._props,o=e.style,l=r.vars.startAt,c,h,d,g,f,p,u,m,y,v,T,C,b,k,S,x,w;qr||xr(),this.styles=this.styles||pn(e),x=this.styles.props,this.tween=r;for(u in t)if(u!=="autoRound"&&(h=t[u],!(ae[u]&&nn(u,t,r,i,e,n)))){if(f=typeof h,p=Yt[u],f==="function"&&(h=h.call(r,i,e,n),f=typeof h),f==="string"&&~h.indexOf("random(")&&(h=kt(h)),p)p(this,e,u,h,r)&&(S=1);else if(u.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(u)+"").trim(),h+="",Be.lastIndex=0,Be.test(c)||(m=Z(c),y=Z(h),y?m!==y&&(c=He(e,u,c,y)+y):m&&(h+=m)),this.add(o,"setProperty",c,h,i,n,0,0,u),s.push(u),x.push(u,0,o[u]);else if(f!=="undefined"){if(l&&u in l?(c=typeof l[u]=="function"?l[u].call(r,i,e,n):l[u],j(c)&&~c.indexOf("random(")&&(c=kt(c)),Z(c+"")||c==="auto"||(c+=de.units[u]||Z(Ee(e,u))||""),(c+"").charAt(1)==="="&&(c=Ee(e,u))):c=Ee(e,u),g=parseFloat(c),v=f==="string"&&h.charAt(1)==="="&&h.substr(0,2),v&&(h=h.substr(2)),d=parseFloat(h),u in we&&(u==="autoAlpha"&&(g===1&&Ee(e,"visibility")==="hidden"&&d&&(g=0),x.push("visibility",0,o.visibility),Le(this,o,"visibility",g?"inherit":"hidden",d?"inherit":"hidden",!d)),u!=="scale"&&u!=="transform"&&(u=we[u],~u.indexOf(",")&&(u=u.split(",")[0]))),T=u in Ie,T){if(this.styles.save(u),w=h,f==="string"&&h.substring(0,6)==="var(--"){if(h=he(e,h.substring(4,h.indexOf(")"))),h.substring(0,5)==="calc("){var A=e.style.perspective;e.style.perspective=h,h=he(e,"perspective"),A?e.style.perspective=A:ze(e,"perspective")}d=parseFloat(h)}if(C||(b=e._gsap,b.renderTransform&&!t.parseTransform||Ot(e,t.parseTransform),k=t.smoothOrigin!==!1&&b.smooth,C=this._pt=new ne(this._pt,o,U,0,1,b.renderTransform,b,0,-1),C.dep=1),u==="scale")this._pt=new ne(this._pt,b,"scaleY",b.scaleY,(v?st(b.scaleY,v+d):d)-b.scaleY||0,wr),this._pt.u=0,s.push("scaleY",u),u+="X";else if(u==="transformOrigin"){x.push(se,0,o[se]),h=Co(h),b.svg?Sr(e,h,0,k,0,this):(y=parseFloat(h.split(" ")[2])||0,y!==b.zOrigin&&Le(this,b,"zOrigin",b.zOrigin,y),Le(this,o,u,Gt(c),Gt(h)));continue}else if(u==="svgOrigin"){Sr(e,h,1,k,0,this);continue}else if(u in bn){So(this,b,u,g,v?st(g,v+h):h);continue}else if(u==="smoothOrigin"){Le(this,b,"smooth",b.smooth,h);continue}else if(u==="force3D"){b[u]=h;continue}else if(u==="transform"){ko(this,h,e);continue}}else u in o||(u=ft(u)||u);if(T||(d||d===0)&&(g||g===0)&&!so.test(h)&&u in o)m=(c+"").substr((g+"").length),d||(d=0),y=Z(h)||(u in de.units?de.units[u]:m),m!==y&&(g=He(e,u,c,y)),this._pt=new ne(this._pt,T?b:o,u,g,(v?st(g,v+d):d)-g,!T&&(y==="px"||u==="zIndex")&&t.autoRound!==!1?co:wr),this._pt.u=y||0,T&&w!==h?(this._pt.b=c,this._pt.e=w,this._pt.r=lo):m!==y&&y!=="%"&&(this._pt.b=c,this._pt.r=ao);else if(u in o)vo.call(this,e,u,c,v?v+h:h);else if(u in e)this.add(e,u,c||e[u],v?v+h:h,i,n);else if(u!=="parseTransform"){Pr(u,h);continue}T||(u in o?x.push(u,0,o[u]):typeof e[u]=="function"?x.push(u,2,e[u]()):x.push(u,1,c||e[u])),s.push(u)}}S&&hn(this)},render:function(e,t){if(t.tween._time||!$r())for(var r=t._pt;r;)r.r(e,r.d),r=r._next;else t.styles.revert()},get:Ee,aliases:we,getSetter:function(e,t,r){var i=we[t];return i&&i.indexOf(",")<0&&(t=i),t in Ie&&t!==se&&(e._gsap.x||Ee(e,"x"))?r&&ni===r?t==="scale"?go:fo:(ni=r||{})&&(t==="scale"?po:mo):e.style&&!Ar(e.style[t])?ho:~t.indexOf("-")?uo:zr(e,t)},core:{_removeProperty:ze,_getMatrix:Wr}};oe.utils.checkPrefix=ft;oe.core.getStyleSaver=pn;(function(a,e,t,r){var i=ie(a+","+e+","+t,function(n){Ie[n]=1});ie(e,function(n){de.units[n]="deg",bn[n]=1}),we[i[13]]=a+","+e,ie(r,function(n){var s=n.split(":");we[s[1]]=i[s[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ie("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(a){de.units[a]="px"});oe.registerPlugin(wn);var Ze=oe.registerPlugin(wn)||oe;Ze.core.Tween;function Eo(a){return new Promise((e,t)=>{console.log("Speech function called with text:",a),window.speechSynthesis.cancel();const r=document.createElement("div");r.innerHTML=a;const i=r.textContent||r.innerText||"";console.log("Clean text for speech:",i);const n=new SpeechSynthesisUtterance(i);n.onend=()=>{console.log("Speech utterance ended"),e()},n.onerror=s=>{console.error("Speech utterance error:",s),t(s)},console.log("Starting speech after 50ms delay"),setTimeout(()=>{window.speechSynthesis.speak(n),console.log("Speech synthesis.speak() called")},50)})}function Ao(a){const e=document.querySelector(a);if(!e)return;const t=e.getBoundingClientRect(),r=10,i=(t.top-r)/window.innerHeight*100,n=(t.left-r)/window.innerWidth*100,s=(t.right+r)/window.innerWidth*100,o=(t.bottom+r)/window.innerHeight*100,l=`polygon(0% 0%, 0% 100%, ${n}% 100%, ${n}% ${i}%, ${s}% ${i}%, ${s}% ${o}%, ${n}% ${o}%, ${n}% 100%, 100% 100%, 100% 0%, 0% 0%)`;Ze.to("#tutorial-mask",{clipPath:l,duration:.4,ease:"power2.inOut"})}function Io(){Ze.to("#tutorial-mask",{clipPath:"polygon(0% 0%, 0% 100%, 50% 100%, 50% 50%, 50% 50%, 50% 50%, 50% 50%, 50% 100%, 100% 100%, 100% 0%, 0% 0%)",duration:.4,ease:"power2.inOut"})}function Oo(a){const e=document.querySelector(a);e&&Ze.to(e,{position:"relative",zIndex:2001,boxShadow:"0 0 20px 8px #33c6dc",duration:.4})}function Po(a){const e=document.querySelector(a);e&&Ze.to(e,{boxShadow:"0 0 0px 0px rgba(51,198,220,0)",duration:.3,onComplete:()=>{Ze.set(e,{clearProps:"all"})}})}function ar(a){return new Promise(e=>{const t=_.rings[a];let r=!1;const i=()=>{if(!r)_.rings[a]!==t&&(r=!0);else if(!_.drag.active&&!_.animation){cancelAnimationFrame(n),e();return}n=requestAnimationFrame(i)};let n=requestAnimationFrame(i)})}function Do(){console.log("=== TUTORIAL START ==="),K.toggleSidebar(!1);const a=document.getElementById("tutorial-bubble"),e=document.getElementById("tutorial-mask"),t=document.getElementById("tutorial-text");if(console.log("Tutorial elements check:",{tutorialBubble:!!a,tutorialMask:!!e,tutorialText:!!t,bubbleStyles:a?{opacity:a.style.opacity,visibility:a.style.visibility,display:getComputedStyle(a).display}:null,textStyles:t?{opacity:t.style.opacity,visibility:t.style.visibility,display:getComputedStyle(t).display,innerHTML:t.innerHTML}:null}),a&&e&&t)console.log("All tutorial elements found successfully");else{console.error("Tutorial elements missing!",{tutorialBubble:!!a,tutorialMask:!!e,tutorialText:!!t});return}window.diatonicCompassTutorial&&(console.log("Killing existing tutorial timeline"),window.diatonicCompassTutorial.kill()),console.log("Creating new GSAP timeline");const r=Ze.timeline({onComplete:()=>{console.log("Tutorial timeline completed"),window.diatonicCompassTutorial=null}});window.diatonicCompassTutorial=r;const i=n=>{console.log("=== ADDING STEP TO TIMELINE ===",n.text),r.call(()=>{(async()=>{console.log("=== EXECUTING STEP ===",n.text),r.pause();const s=document.getElementById("tutorial-text"),o=document.getElementById("tutorial-bubble");console.log("Tutorial elements during step execution:",{textEl:!!s,bubbleEl:!!o,textElStyles:s?{opacity:s.style.opacity,visibility:s.style.visibility,display:getComputedStyle(s).display,currentHTML:s.innerHTML}:null,bubbleElStyles:o?{opacity:o.style.opacity,visibility:o.style.visibility,display:getComputedStyle(o).display}:null}),s?(console.log("BEFORE setting text - innerHTML:",s.innerHTML),s.innerHTML=n.text,s.style.opacity="1",s.style.visibility="visible",console.log("AFTER setting text - innerHTML:",s.innerHTML),console.log("Text element computed styles after update:",{opacity:getComputedStyle(s).opacity,visibility:getComputedStyle(s).visibility,display:getComputedStyle(s).display,fontSize:getComputedStyle(s).fontSize,color:getComputedStyle(s).color})):console.error("Tutorial text element not found during step execution!"),n.highlightTarget&&(console.log("Adding highlight to:",n.highlightTarget),Ao(n.highlightTarget),Oo(n.highlightTarget)),console.log("Starting speech synthesis for:",n.text),await Eo(n.text),console.log("Speech synthesis completed"),n.waitFor&&(console.log("Waiting for user interaction..."),await n.waitFor(),console.log("User interaction completed")),n.highlightTarget&&(console.log("Removing highlight from:",n.highlightTarget),Po(n.highlightTarget),Io()),await new Promise(l=>setTimeout(l,500)),console.log("Step completed, resuming timeline"),r.resume()})()})};console.log("Adding tutorial mask animation to timeline"),r.to("#tutorial-mask",{autoAlpha:1,duration:.3}),r.call(()=>{console.log("=== SHOWING TUTORIAL BUBBLE ===");const n=document.getElementById("tutorial-bubble"),s=document.getElementById("tutorial-text");console.log("Bubble show elements check:",{bubble:!!n,textEl:!!s,bubbleCurrentStyles:n?{opacity:n.style.opacity,visibility:n.style.visibility,display:getComputedStyle(n).display}:null,textCurrentStyles:s?{opacity:s.style.opacity,visibility:s.style.visibility,innerHTML:s.innerHTML}:null}),n?(console.log("Setting bubble visibility styles"),n.style.display="block",n.style.opacity="1",n.style.visibility="visible",n.setAttribute("aria-hidden","false"),console.log("Bubble styles after setting:",{opacity:n.style.opacity,visibility:n.style.visibility,computedOpacity:getComputedStyle(n).opacity,computedVisibility:getComputedStyle(n).visibility,computedDisplay:getComputedStyle(n).display}),console.log("Tutorial bubble shown successfully")):console.error("Tutorial bubble element not found during show!")}),i({text:"Welcome to the <strong>Diatonic Compass!</strong>"}),i({text:"Rotate the <strong>Pitch</strong> belt so we leave <strong>C Major.</strong>",highlightTarget:".pitch-belt",waitFor:()=>ar("pitchClass")}),i({text:"Nice! <br>Change the <strong>mode</strong> by spinning the <strong>Degree belt.</strong>",highlightTarget:".degree-belt",waitFor:()=>ar("degree")}),i({text:"Wonderful!<br>Now shift the perspective by spinning the <strong>Chromatic belt</strong>.",highlightTarget:".chromatic-belt",waitFor:()=>ar("chromatic")}),r.to("#tutorial-bubble",{bottom:"110px",duration:.3,ease:"power2.out"}),i({text:"Almost there!<br> Tap the <strong>result bar</strong> to <strong>hear your scale.</strong>",highlightTarget:"#result-container",waitFor:async()=>{await new Promise(n=>{const s=()=>_.playback.isPlaying?n():requestAnimationFrame(s);s()}),await new Promise(n=>{const s=()=>_.playback.isPlaying?requestAnimationFrame(s):n();s()})}}),r.to("#tutorial-bubble",{bottom:"20px",duration:.3,ease:"power2.in"}),i({text:"You did it!<br><strong>Enjoy exploring.</strong>"}),r.to(["#tutorial-mask","#tutorial-bubble"],{autoAlpha:0,duration:.4,delay:1}),r.call(()=>{const n=document.getElementById("tutorial-bubble");n&&(n.style.display="none",console.log("Tutorial bubble hidden"))})}class Pe{static hasStateChanged(e,t){return!t||e.animation!==null||e.drag.active!==null||e.playback.isPlaying!==t.playback.isPlaying||e.playback.currentNoteIndex!==t.playback.currentNoteIndex||!this._ringsEqual(e.rings,t.rings)||e.display.sharp!==t.display.sharp||e.display.flat!==t.display.flat||e.ui.darkMode!==t.ui.darkMode||e.ui.sidebarOpen!==t.ui.sidebarOpen||e.belts.orientation!==t.belts.orientation||!this._dimensionsEqual(e.dimensions,t.dimensions)}static _ringsEqual(e,t){return Math.abs(e.pitchClass-t.pitchClass)<1e-4&&Math.abs(e.degree-t.degree)<1e-4&&Math.abs(e.chromatic-t.chromatic)<1e-4&&Math.abs(e.highlightPosition-t.highlightPosition)<1e-4}static _dimensionsEqual(e,t){return e.size===t.size&&e.dpr===t.dpr}static createSnapshot(e){return{rings:{...e.rings},playback:{isPlaying:e.playback.isPlaying,currentNoteIndex:e.playback.currentNoteIndex},display:{...e.display},ui:{darkMode:e.ui.darkMode,sidebarOpen:e.ui.sidebarOpen},belts:{orientation:e.belts.orientation},dimensions:{...e.dimensions},animation:e.animation,drag:{active:e.drag.active}}}static markDirty(e){e.performance&&(e.performance.needsRedraw=!0)}static markClean(e){e.performance&&(e.performance.needsRedraw=!1,e.performance.lastRenderState=this.createSnapshot(e))}static needsRedraw(e){return e.performance?.needsRedraw?!0:this.hasStateChanged(e,e.performance?.lastRenderState)}}const Mo=Object.freeze(Object.defineProperty({__proto__:null,StateTracker:Pe},Symbol.toStringTag,{value:"Module"}));function De(a,e){if(_.rings.hasOwnProperty(a)){const t=F(e);_.rings[a]=t,Pe.markDirty(_)}}function Tn(a,e,t){const r=e;_.rings.chromatic=F(a.startChrom+r),_.rings.pitchClass=F(a.startPitchClass+e),_.rings.degree=F(a.startDegree+e),_.rings.highlightPosition=F(a.startHighlight+e),Pe.markDirty(_)}function xn(a){if(!a)return"#000000";const e=parseInt(a.slice(1,3),16),t=parseInt(a.slice(3,5),16),r=parseInt(a.slice(5,7),16);return .299*e+.587*t+.114*r>140?"#000000":"#FFFFFF"}const Ro={red:{solid:"red",fill:"rgba(255, 0, 0, 0.2)"},blue:{solid:"blue",fill:"rgba(0, 0, 255, 0.2)"},green:{solid:"green",fill:"rgba(0, 255, 0, 0.2)"},yellow:{solid:"#FFD700",fill:"rgba(255, 215, 0, 0.2)"}};class Lo{canvas;ctx;state;onInteractionEnd;cachedLayers;constructor(e,t,r){this.canvas=e,this.ctx=e.getContext("2d"),this.state=t,this.onInteractionEnd=r,this.cachedLayers={outerRing:null,middleRing:null,innerRing:null,labels:null,lastSize:0},this._initInteraction()}_regenerateCachedLayers(e,t){}update(e,t,r){const{size:i,dpr:n}=this.state.dimensions;this._draw(i,n,e,t,r)}_initInteraction(){const e=r=>{const i=this.canvas.getBoundingClientRect(),{cx:n,cy:s,size:o}=this.state.dimensions,l=r.clientX-i.left-n,c=r.clientY-i.top-s,h=Math.hypot(l,c),d=o*.5,g=o*.35,f=o*.2;let p=null;return h>f&&h<g?p="degree":h>g&&h<d?p="pitchClass":h<=f&&(p="chromatic"),{x:l,y:c,ring:p}},t=()=>{if(!this.state.drag.active)return;const r=this.state.drag.active;this.state.drag.active=null,this.canvas.style.cursor="grab",r==="chromatic"?bi(this.onInteractionEnd):r==="pitchClass"?yi("pitchClass",this.onInteractionEnd):r==="degree"&&hr(this.onInteractionEnd)};this.canvas.addEventListener("pointerdown",r=>{const{x:i,y:n,ring:s}=e(r);if(!s)return;const{drag:o,rings:l}=this.state;o.active=s,o.startX=i,o.startY=n,o.startPitchClass=l.pitchClass,o.startDegree=l.degree,o.startChrom=l.chromatic,o.startHighlight=l.highlightPosition,this.canvas.setPointerCapture(r.pointerId),this.canvas.style.cursor="grabbing"}),this.canvas.addEventListener("pointermove",r=>{if(this.state.drag.active){const{x:i,y:n}=e(r),s=this.state.drag,o=Math.atan2(s.startY,s.startX),c=Math.atan2(n,i)-o;s.active==="pitchClass"?De("pitchClass",s.startPitchClass+c):s.active==="degree"?(De("degree",s.startDegree+c),De("highlightPosition",s.startHighlight+c)):s.active==="chromatic"&&Tn({startPitchClass:s.startPitchClass,startDegree:s.startDegree,startChrom:s.startChrom,startHighlight:s.startHighlight},c)}else{const{ring:i}=e(r);this.canvas.style.cursor=i?"grab":"default"}}),this.canvas.addEventListener("pointerup",t),this.canvas.addEventListener("pointercancel",t),this.canvas.addEventListener("pointerleave",()=>{this.state.drag.active||(this.canvas.style.cursor="default")})}_draw(e,t,r,i,n){console.log("=== Wheel._draw CALLED ===",{size:e,dpr:t});const s=this.ctx;s.save(),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.scale(t,t);const o=e/2,l=e/2,{pitchClass:c,degree:h,chromatic:d}=r,{chromaticLabels:g,diatonicLabels:f}=i;this.cachedLayers.lastSize!==e&&(this._regenerateCachedLayers(e,t),this.cachedLayers.lastSize=e);const u=(k,S,x)=>{const w=x-G/2,A=x+G/2;s.beginPath(),s.arc(o,l,S,w,A),s.arc(o,l,k,A,w,!0),s.closePath()},m=()=>{const k=e*.5,S=e*.35;Object.keys(mt).forEach((w,A)=>{const O=A*G+c-Math.PI/2;u(S,k,O),s.fillStyle=mt[w]?"#fff":"#000",s.fill(),s.lineWidth=e*.002,s.strokeStyle="#000",s.stroke()})},y=()=>{const k=e*.35,S=e*.2;for(let x=0;x<12;x++){const w=x*G+h-Math.PI/2;u(S,k,w),s.fillStyle=cr[x]||"#e0e0e0",s.fill(),s.lineWidth=e*.002,s.strokeStyle="#000",s.stroke()}},v=()=>{s.beginPath(),s.arc(o,l,e*.2,0,Math.PI*2),s.fillStyle="#000",s.fill()},T=()=>{const k=e*.5*.85,S=e*.35*.8,x=e*.2*.8,w=Object.keys(mt),A=(M,R,L,z,X)=>{s.fillStyle=z,s.font=`${X}px 'Atkinson Hyperlegible Next'`,s.textAlign="center",s.textBaseline="middle";const $e=o+Math.cos(M)*R,Oe=l+Math.sin(M)*R,_e=String(L);if(_e.includes("/")||_e.includes("<br>")){const be=_e.includes("/")?_e.split("/"):_e.split("<br>"),gt=X*1.1,ye=Oe-gt*(be.length-1)/2;be.forEach((xe,Sn)=>{s.fillText(xe,$e,ye+Sn*gt)})}else s.fillText(String(L),$e,Oe)},O=e*Wn;g.forEach((M,R)=>{const L=w[R],z=M,X=mt[L]?"#000":"#fff";A(R*G+c-Math.PI/2,k,z,X,O)});const P=e*Vn;f.forEach((M,R)=>{const L=cr[R]||"#e0e0e0",z=xn(L),X=M;A(R*G+h-Math.PI/2,S,X,z,P)});const D=e*Yn;Hn.forEach(M=>A(M*G+d-Math.PI/2,x,M.toString(),"#fff",D))},C=()=>{if(!n||!n.isPlaying||n.currentNoteIndex===null)return;const S=n.currentNoteIndex%12*G+c-Math.PI/2,x=e*.5,w=e*.2;u(w,x,S),s.fillStyle="rgba(255, 255, 0, 0.6)",s.fill()},b=()=>{const k=this.state.ui.cursorColor||"red",S=this.state.ui.cursorFill,x=Ro[k],w=d-Math.PI/2,A=e*.5,O=e*.12;u(O,A,w),S&&(s.fillStyle=x.fill,s.fill()),s.strokeStyle=x.solid,s.lineWidth=e*.005,s.stroke()};console.log("Drawing outer ring..."),m(),console.log("Drawing middle ring..."),y(),console.log("Drawing inner circle..."),v(),console.log("Drawing labels..."),T(),console.log("Drawing playback highlight..."),C(),console.log("Drawing tonal center marker..."),b(),console.log("Wheel drawing complete"),s.restore()}destroy(){}}class No{container;state;onInteractionEnd;elements;cachedCells;lastAppliedLabels;_chromaticColorsApplied;constructor(e,t,r){this.container=e,this.state=t,this.onInteractionEnd=r,this.elements={pitchBelt:e.querySelector("#pitchBelt"),degreeBelt:e.querySelector("#degreeBelt"),chromaticBelt:e.querySelector("#chromaticBelt"),chromaticColorsTrack:e.querySelector("#chromatic-colors-track"),chromaticNumbersTrack:e.querySelector("#chromatic-numbers-track"),intervalBracketsTrackContainer:e.querySelector("#intervalBracketsContainer"),intervalBracketsWrapper:e.querySelector(".interval-brackets-wrapper"),intervalBrackets:null,cursor:e.querySelector("#belt-cursor"),flashOverlay:e.querySelector("#belt-flash-overlay")},this.state.belts.tracks={},this.cachedCells={pitch:null,degree:null,chromaticColors:null,chromaticNumbers:null},this.lastAppliedLabels={chromatic:null,diatonic:null},this._chromaticColorsApplied=!1,this._initInteraction()}_calculateRingAngleToBeltPixelsRatio(e){return!e||e<=0?(console.warn("Invalid beltCellWidth for ring-to-belt conversion:",e),0):Se*e/Ge}_getCellOriginalIndex(e){const t=e.dataset.originalIndex;if(t===void 0)return null;const r=Number(t);return Number.isFinite(r)?r:null}_formatLabelForCell(e,t){if(!e||!e.includes("/"))return e;const r=this.state.belts.orientation,i=t.closest(".belt")?.className||"unknown";return t.dataset.originalIndex==="1"&&console.log(`🔍 Format check [${i}] (${r}):`,{label:e,orientation:r,decision:r==="vertical"?"SIDE-BY-SIDE (vertical mode)":"STACKED (horizontal mode)"}),r==="vertical"?e.replace("/"," "):e.replace("/","<br>")}update(e,t){const{orientation:r}=this.state.belts,{diatonicLabels:i,chromaticLabels:n}=e;if(console.log("=== Belts.update CALLED ===",{init:this.state.belts.init,orientation:r}),!this.state.belts.init){console.log("Belts not initialized - setting up..."),this.cachedCells={pitch:null,degree:null,chromaticColors:null,chromaticNumbers:null},this.lastAppliedLabels={chromatic:null,diatonic:null},this._chromaticColorsApplied=!1,this._setupAllBelts(i,n),requestAnimationFrame(()=>{this._calculateAllBeltCellWidths(r)&&(console.log("Belt sizes calculated, marking as initialized"),this.state.belts.init=!0,Qe(async()=>{const{StateTracker:y}=await Promise.resolve().then(()=>Mo);return{StateTracker:y}},void 0).then(({StateTracker:y})=>{y.markDirty(this.state)}))});return}console.log("Belts initialized, applying styles...");const{pitchClass:s,degree:o,chromatic:l,highlightPosition:c}=this.state.rings,{tracks:h,itemSize:d}=this.state.belts;this._applyBeltStyles(t,i,n);let g=r==="vertical"?-s:s,f=r==="vertical"?-o:o,p=r==="vertical"?-l:l,u=r==="vertical"?-c:c;this._positionBeltFromRingAngle(h.pitchBelt,g,d.pitchBelt,r),this._positionBeltFromRingAngle(h.degreeBelt,f,d.degreeBelt,r),this._positionBeltFromRingAngle(h.chromaticColors,u,d.chromaticBelt,r),this._positionBeltFromRingAngle(h.chromaticNumbers,p,d.chromaticBelt,r),this._positionIntervalBeltFromDegreeRing(f,d.degreeBelt,r),this._positionBeltCursorFromRingAngle(p,d.chromaticBelt,r),this._updatePlaybackFlashOnBelt()}_initInteraction(){const{pitchBelt:e,degreeBelt:t,chromaticNumbersTrack:r}=this.elements;e&&this._addDragHandler(e,s=>{const o=this.state.drag.startPitchClass+(this.state.belts.orientation==="vertical"?-s:s);De("pitchClass",o)},()=>yi("pitchClass",this.onInteractionEnd));const i=s=>{const o=this.state.belts.orientation==="vertical"?-s:s;De("degree",this.state.drag.startDegree+o),De("highlightPosition",this.state.drag.startHighlight+o)},n=()=>{hr(this.onInteractionEnd)};t&&this._addDragHandler(t,i,n),r&&this._addDragHandler(r,s=>{const o=this.state.belts.orientation==="vertical"?-s:s,l={startPitchClass:this.state.drag.startPitchClass,startDegree:this.state.drag.startDegree,startChrom:this.state.drag.startChrom,startHighlight:this.state.drag.startHighlight};Tn(l,o)},()=>bi(this.onInteractionEnd))}_addDragHandler(e,t,r){e.style.cursor="grab";let i=null,n=0,s=0;const o=h=>{i=h.pointerId,e.setPointerCapture(i),n=h.clientX,s=h.clientY;const{drag:d,rings:g}=this.state;d.active=e.id||"belt-drag",d.startPitchClass=g.pitchClass,d.startDegree=g.degree,d.startChrom=g.chromatic,d.startHighlight=g.highlightPosition,e.style.cursor="grabbing"},l=h=>{if(i!==h.pointerId)return;const{orientation:d,itemSize:g}=this.state.belts,f=d==="vertical"?h.clientY-s:h.clientX-n;let p=null;const u=e.id||e.className||"";u.includes("pitch")?p="pitchBelt":u.includes("degree")||u.includes("interval")?p="degreeBelt":u.includes("chromatic")&&(p="chromaticBelt");const m=p?g[p]:void 0;if(!m||m===0)return;const y=f/m*G;t(y)},c=()=>{i!==null&&(e.releasePointerCapture(i),i=null,this.state.drag.active=null,e.style.cursor="grab",r())};e.addEventListener("pointerdown",o),e.addEventListener("pointermove",l),e.addEventListener("pointerup",c),e.addEventListener("pointercancel",c)}_setupAllBelts(e,t){this.elements.pitchBelt.innerHTML="",this.elements.degreeBelt.innerHTML="",this.elements.intervalBracketsTrackContainer.innerHTML="";const r=3;this.state.belts.tracks.pitchBelt=this._createBeltTrack(this.elements.pitchBelt,t,r),this.state.belts.tracks.degreeBelt=this._createBeltTrack(this.elements.degreeBelt,e,r),this._populateBeltTrack(this.elements.chromaticColorsTrack,Array(12).fill(""),r),this._populateBeltTrack(this.elements.chromaticNumbersTrack,[...Array(12).keys()],r),this.state.belts.tracks.chromaticColors=this.elements.chromaticColorsTrack,this.state.belts.tracks.chromaticNumbers=this.elements.chromaticNumbersTrack,this._createIntervalBeltTrack(r)}_createBeltTrack(e,t,r){const i=document.createElement("div");return i.className="belt-track",this._populateBeltTrack(i,t,r),e.appendChild(i),i}_populateBeltTrack(e,t,r){e.innerHTML="";const i=3,n=t.length;for(let s=0;s<r*Se+i;s++){const o=s%n,l=t[o],c=document.createElement("div");c.className="belt-cell",c.innerHTML=String(l),c.dataset.originalIndex=String(o),e.appendChild(c)}}_createIntervalBeltTrack(e){const t=document.createElement("div");t.className="interval-brackets-track";const r=3;for(let s=0;s<Se*e+r;s++){const o=s%Se,l=zt.indexOf(o),c=document.createElement("div");if(c.className="interval-bracket-cell",l!==-1){const h=Un[l];c.dataset.steps=String(h),c.innerHTML=`<span>+${h}</span>`}t.appendChild(c)}this.elements.intervalBracketsTrackContainer.appendChild(t),this.elements.intervalBrackets=this.elements.intervalBracketsWrapper;const i=s=>{const o=this.state.belts.orientation==="vertical"?-s:s;De("degree",this.state.drag.startDegree+o),De("highlightPosition",this.state.drag.startHighlight+o)},n=()=>{hr(this.onInteractionEnd)};this.elements.intervalBrackets&&this._addDragHandler(this.elements.intervalBrackets,i,n)}_calculateAllBeltCellWidths(e){return this._calculateBeltCellWidth("pitchBelt",this.elements.pitchBelt,e)&&this._calculateBeltCellWidth("degreeBelt",this.elements.degreeBelt,e)&&this._calculateBeltCellWidth("chromaticBelt",this.elements.chromaticBelt,e)&&this._calculateBeltCellWidth("intervalBracketsContainer",this.elements.intervalBracketsWrapper,e)}_calculateBeltCellWidth(e,t,r){const i=r==="vertical"?t.offsetHeight:t.offsetWidth;return i>0?(this.state.belts.itemSize[e]=i/Se,!0):!1}_applyBeltStyles(e,t,r){console.log("=== _applyBeltStyles CALLED ===");const i=r.join(","),n=t.join(","),s=this.lastAppliedLabels.chromatic!==i||this.lastAppliedLabels.diatonic!==n,o=this.lastAppliedLabels.chromatic===null;!this.cachedCells.pitch&&this.state.belts.tracks.pitchBelt&&(this.cachedCells.pitch=this.state.belts.tracks.pitchBelt.querySelectorAll(".belt-cell"),console.log("Cached pitch cells:",this.cachedCells.pitch.length)),!this.cachedCells.degree&&this.state.belts.tracks.degreeBelt&&(this.cachedCells.degree=this.state.belts.tracks.degreeBelt.querySelectorAll(".belt-cell"),console.log("Cached degree cells:",this.cachedCells.degree.length)),!this.cachedCells.chromaticColors&&this.elements.chromaticColorsTrack&&(this.cachedCells.chromaticColors=this.elements.chromaticColorsTrack.querySelectorAll(".belt-cell"),console.log("Cached chromatic color cells:",this.cachedCells.chromaticColors.length)),!this.cachedCells.chromaticNumbers&&this.elements.chromaticNumbersTrack&&(this.cachedCells.chromaticNumbers=this.elements.chromaticNumbersTrack.querySelectorAll(".belt-cell"),console.log("Cached chromatic number cells:",this.cachedCells.chromaticNumbers.length)),console.log("Belt styling state:",{isFirstRun:o,labelsChanged:s,hasPitchCells:!!this.cachedCells.pitch,pitchCellCount:this.cachedCells.pitch?.length||0,hasDegreeCells:!!this.cachedCells.degree,degreeCellCount:this.cachedCells.degree?.length||0,hasChromaticColors:!!this.cachedCells.chromaticColors,chromaticColorCount:this.cachedCells.chromaticColors?.length||0});const l=(s||o)&&this.cachedCells.pitch,c=this.cachedCells.pitch&&this.cachedCells.pitch.length>0&&!this.cachedCells.pitch[0].style.background;(l||c)&&this.cachedCells.pitch?(console.log("APPLYING PITCH BELT COLORS!",{shouldUpdatePitch:l,needsInitialColors:c,cellCount:this.cachedCells.pitch.length}),this.cachedCells.pitch.forEach(f=>{const p=this._getCellOriginalIndex(f);if(p===null)return;const u=Bt[p],m=mt[u];f.style.background=m?"#fff":"#000",f.style.color=m?"#000":"#fff",f.innerHTML=this._formatLabelForCell(r[p],f)})):this.cachedCells.pitch&&s?(console.log("UPDATING PITCH LABELS ONLY"),this.cachedCells.pitch.forEach(f=>{const p=this._getCellOriginalIndex(f);p!==null&&(f.innerHTML=this._formatLabelForCell(r[p],f))})):console.log("SKIPPED pitch belt colors:",{shouldUpdatePitch:l,needsInitialColors:c,hasCells:!!this.cachedCells.pitch});const h=(s||o)&&this.cachedCells.degree,d=this.cachedCells.degree&&this.cachedCells.degree.length>0&&!this.cachedCells.degree[0].style.background;(h||d)&&this.cachedCells.degree?(console.log("APPLYING DEGREE BELT COLORS!",{shouldUpdateDegree:h,needsInitialDegreeColors:d,cellCount:this.cachedCells.degree.length}),this.cachedCells.degree.forEach(f=>{const p=this._getCellOriginalIndex(f);if(p===null)return;const u=cr[p]||"#f0f0f0";f.style.background=u,f.style.color=xn(u),f.innerHTML=this._formatLabelForCell(t[p],f)})):this.cachedCells.degree&&s?(console.log("UPDATING DEGREE LABELS ONLY"),this.cachedCells.degree.forEach(f=>{const p=this._getCellOriginalIndex(f);p!==null&&(f.innerHTML=this._formatLabelForCell(t[p],f))})):console.log("SKIPPED degree belt colors:",{shouldUpdateDegree:h,needsInitialDegreeColors:d,hasCells:!!this.cachedCells.degree});const g=this.cachedCells.chromaticColors&&this.cachedCells.chromaticColors.length>0&&!this.cachedCells.chromaticColors[0].style.background;if((!this._chromaticColorsApplied||o||g)&&this.cachedCells.chromaticColors?(console.log("APPLYING CHROMATIC COLORS!",{chromaticColorsApplied:this._chromaticColorsApplied,isFirstRun:o,needsInitialChromatic:g,cellCount:this.cachedCells.chromaticColors.length}),this.cachedCells.chromaticColors.forEach(f=>{const p=this._getCellOriginalIndex(f);p!==null&&(f.style.background=e.includes(p)?"#e0e0e0":"#4a4a4a")}),this._chromaticColorsApplied=!0):console.log("SKIPPED chromatic colors:",{chromaticColorsApplied:this._chromaticColorsApplied,isFirstRun:o,needsInitialChromatic:g,hasCells:!!this.cachedCells.chromaticColors}),this.cachedCells.chromaticNumbers){const{chromatic:f,highlightPosition:p}=this.state.rings,m=F(p-f)/G;this.cachedCells.chromaticNumbers.forEach(y=>{const v=this._getCellOriginalIndex(y);if(v===null)return;const T=Math.round((v-m+1200)%12)%12,C=e.includes(T)?"black":"lightgray";y.style.color!==C&&(y.style.color=C)})}s&&(this.lastAppliedLabels.chromatic=i,this.lastAppliedLabels.diatonic=n)}_convertRingAngleToBeltDistance(e,t,r){const i=this._calculateRingAngleToBeltPixelsRatio(t);if(i===0)return 0;const n=e*i;let s,o=0;return r==="vertical"?(s=-(t*Se),o=3*t,s-o+n):(s=-(t*Se),s+n)}_positionBeltFromRingAngle(e,t,r,i){if(!e||!r)return;const n=this._convertRingAngleToBeltDistance(t,r,i),s=i==="vertical"?`translateY(${n}px)`:`translateX(${n}px)`;e.style.transform=s}_positionIntervalBeltFromDegreeRing(e,t,r){const i=this.elements.intervalBracketsTrackContainer;if(!i||!t)return;const n=i.querySelector(".interval-brackets-track");if(!n)return;let s=this._convertRingAngleToBeltDistance(e,t,r);r==="horizontal"&&(s+=.5*t);const o=r==="vertical"?`translateY(${s}px)`:`translateX(${s}px)`;n.style.transform=o}_positionBeltCursorFromRingAngle(e,t,r){const i=this.elements.cursor;if(console.log("=== Positioning belt cursor ===",{hasCursor:!!i,beltCellWidth:t,orientation:r,chromaticRingAngle:e}),!i||!t){console.warn("Cannot position cursor - missing element or cell width");return}this._updateBeltCursorColors(i);const n=this._calculateRingAngleToBeltPixelsRatio(t);if(n===0){console.warn("Cannot position cursor - invalid pixel ratio");return}const s=e*n;let o;if(r==="vertical"){const c=-Se*t;o=(s%c+c)%c}else o=s;const l=r==="vertical"?`translateY(${o}px)`:`translateX(${o}px)`;i.style.transform=l,console.log("Belt cursor positioned:",{transform:l,cursorBeltPosition:o})}_updateBeltCursorColors(e){const t=this.state.ui.cursorColor||"red",r=this.state.ui.cursorFill,n={red:{solid:"red",fill:"rgba(255, 0, 0, 0.2)"},blue:{solid:"blue",fill:"rgba(0, 0, 255, 0.2)"},green:{solid:"green",fill:"rgba(0, 255, 0, 0.2)"},yellow:{solid:"#FFD700",fill:"rgba(255, 215, 0, 0.2)"}}[t];e.style.borderColor=n.solid,e.style.background=r?n.fill:"transparent"}_updatePlaybackFlashOnBelt(){const{rings:e,playback:t,belts:r}=this.state,i=this.elements.flashOverlay,n=r.itemSize.chromaticBelt,s=r.orientation;if(!i)return;if(!n||!t.isPlaying||t.currentNoteIndex===null||t.rootNoteIndexForPlayback===null){i.style.display="none";return}const o=this._calculateRingAngleToBeltPixelsRatio(n);if(o===0){i.style.display="none";return}let l;if(s==="vertical"){const h=-e.chromatic,d=(t.currentNoteIndex-t.rootNoteIndexForPlayback)*G,f=(h-d)*o,p=-Se*n;l=(f%p+p)%p}else l=(e.chromatic+(t.currentNoteIndex-t.rootNoteIndexForPlayback)*G)*o;const c=s==="vertical"?`translateY(${l}px)`:`translateX(${l}px)`;i.style.transform=c,i.style.display="block"}destroy(){}}const lr=["pitch","degree","intervals","chromatic"];class Bo{container;draggedItem;dragOverItem;onOrderChange;touchStartY;touchStartX;isDraggingTouch;touchScrollThreshold;dragGhost;constructor(){this.container=null,this.draggedItem=null,this.dragOverItem=null,this.onOrderChange=null,this.touchStartY=0,this.touchStartX=0,this.isDraggingTouch=!1,this.touchScrollThreshold=10,this.dragGhost=null,this.init()}init(){try{if(this.container=document.getElementById("belt-order-list"),!this.container)throw new Error("Order list container not found");this._setupEventListeners(),this._loadSavedOrder(),this._updateDisplay()}catch(e){E.handle(e,"OrderManager",()=>{console.error("Failed to initialize Order Manager")})}}_setupEventListeners(){this.container&&(this.container.addEventListener("dragstart",this._handleDragStart.bind(this)),this.container.addEventListener("dragover",this._handleDragOver.bind(this)),this.container.addEventListener("dragenter",this._handleDragEnter.bind(this)),this.container.addEventListener("dragleave",this._handleDragLeave.bind(this)),this.container.addEventListener("drop",this._handleDrop.bind(this)),this.container.addEventListener("dragend",this._handleDragEnd.bind(this)),this.container.addEventListener("touchstart",this._handleTouchStart.bind(this),{passive:!1}),this.container.addEventListener("touchmove",this._handleTouchMove.bind(this),{passive:!1}),this.container.addEventListener("touchend",this._handleTouchEnd.bind(this),{passive:!1}),this.container.addEventListener("touchcancel",this._handleTouchEnd.bind(this),{passive:!1}))}_handleDragStart(e){console.log("Drag start event triggered",e.target);const t=e.target;if(!t||!t.classList.contains("drag-handle")){console.log("Not a drag-handle, ignoring");return}if(this.draggedItem=t.closest(".order-item"),!this.draggedItem){console.log("No parent order-item found, ignoring");return}this.draggedItem.classList.add("dragging"),console.log("Dragging item:",this.draggedItem.dataset.component),e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.draggedItem.outerHTML),setTimeout(()=>{this.draggedItem&&(this.draggedItem.style.opacity="0")},1))}_handleDragOver(e){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move")}_handleDragEnter(e){const t=e.target;t?.classList.contains("order-item")&&t!==this.draggedItem&&(this.dragOverItem=t,t.classList.add("drag-over"),this._animateReorder(t))}_handleDragLeave(e){const t=e.target;t?.classList.contains("order-item")&&t.classList.remove("drag-over")}_handleDrop(e){if(e.preventDefault(),console.log("Drop event triggered"),!this.draggedItem||!this.dragOverItem||this.dragOverItem===this.draggedItem){console.log("Drop cancelled - no valid target");return}const t=this.draggedItem.dataset.component,r=this.dragOverItem.dataset.component;if(!t||!r){console.log("Drop cancelled - missing component id");return}console.log(`Dropping ${t} onto ${r}`),this._reorderComponents(t,r),this._saveOrder(),this._updateDisplay(),this._applyComponentOrder()}_handleDragEnd(e){this.container&&(this.draggedItem&&(this.draggedItem.classList.remove("dragging"),this.draggedItem.style.opacity=""),this.container.querySelectorAll(".drag-over").forEach(t=>{t.classList.remove("drag-over")}),this._resetAnimations(),this.draggedItem=null,this.dragOverItem=null)}_reorderComponents(e,t){const r=_.belts.orientation,i=[..._.belts.layoutOrder[r]];r==="vertical"?this._reorderVerticalLayout(e,t,i):this._reorderHorizontalLayout(e,t,i)}_reorderHorizontalLayout(e,t,r){const i=r.indexOf(e),n=r.indexOf(t);if(console.log("=== HORIZONTAL REORDER DEBUG ===",{draggedId:e,targetId:t,currentOrder:[...r],draggedIndex:i,targetIndex:n}),i===-1||n===-1){console.log("Invalid indices - horizontal reorder cancelled");return}r.splice(i,1);const s=i<n?n-1:n;console.log("Horizontal reorder calculation:",{afterRemoval:[...r],adjustedTargetIndex:s,calculation:`${i} < ${n} ? ${n-1} : ${n}`,explanation:i<n?"Moving forward: target shifted down after removal":"Moving backward: target index unchanged"}),r.splice(s,0,e),console.log("Final horizontal order:",[...r]),_.belts.layoutOrder.horizontal=r}_reorderVerticalLayout(e,t,r){if(console.log("=== VERTICAL REORDER DEBUG ===",{draggedId:e,targetId:t,currentOrder:r,isCompassInvolved:e==="compass"||t==="compass"}),e==="compass"||t==="compass"){const i=lr;let n=t,s=e;i.includes(t)&&(n="result",console.log(`Converting belt target '${t}' to 'result'`)),i.includes(e)&&(s="result",console.log(`Converting belt dragged '${e}' to 'result'`));const o=r.indexOf(s),l=r.indexOf(n);if(console.log("Compass reorder indices:",{draggedIndex:o,targetIndex:l,actualDraggedId:s,actualTargetId:n}),o!==-1&&l!==-1&&o!==l){r.splice(o,1);let c;s==="compass"&&i.includes(t)?(c=r.length,console.log("Placing compass after result group at index:",c)):(c=o<l?l-1:l,console.log("Normal reorder to index:",c)),r.splice(c,0,s),_.belts.layoutOrder.vertical=r,console.log("New vertical layout order:",r)}else console.log("Invalid indices or same position - reorder cancelled")}else console.log("Belt reorder within result group"),lr.includes(e)&&lr.includes(t)&&this._reorderBelts(e,t)}_reorderBelts(e,t){const r=[..._.belts.order],i=r.indexOf(e),n=r.indexOf(t);if(console.log("=== BELT REORDER DEBUG ===",{draggedBelt:e,targetBelt:t,currentOrder:[...r],draggedIndex:i,targetIndex:n}),i===-1||n===-1)return;r.splice(i,1);const s=i<n?n-1:n;console.log("Belt reorder calculation:",{afterRemoval:[...r],adjustedTargetIndex:s,calculation:`${i} < ${n} ? ${n-1} : ${n}`,explanation:i<n?"Moving forward: target shifted down after removal":"Moving backward: target index unchanged"}),r.splice(s,0,e),console.log("Final belt order:",[...r]),_.belts.order=r}_updateDisplay(){if(!this.container)return;const e=_.belts.orientation,t=this.container;t&&(t.innerHTML="",e==="horizontal"?this._renderHorizontalLayout():this._renderVerticalLayout())}_renderHorizontalLayout(){const e=this.container;if(!e)return;_.belts.layoutOrder.horizontal.forEach(r=>{const i=this._createOrderItem(r,this._getComponentLabel(r));e.appendChild(i)})}_renderVerticalLayout(){const e=this.container;if(!e)return;const t=_.belts.layoutOrder.vertical;console.log("=== RENDERING VERTICAL LAYOUT ===",{order:t,beltOrder:_.belts.order}),t.forEach((r,i)=>{if(console.log(`Rendering component ${i}: ${r}`),r==="result"){const n=this._createOrderItem("result","Mode Name",!0);e.appendChild(n),console.log("Added result group item"),_.belts.order.forEach((s,o)=>{const l=this._createOrderItem(s,this._getComponentLabel(s),!1,!0);e.appendChild(l),console.log(`Added nested belt item ${o}: ${s}`)})}else{const n=this._createOrderItem(r,this._getComponentLabel(r));e.appendChild(n),console.log(`Added regular item: ${r}`)}}),console.log("Final sidebar structure:",Array.from(e.children).map(r=>{const i=r;return{className:i.className,textContent:i.textContent?.trim()||"",dataComponent:i.dataset.component}}))}_createOrderItem(e,t,r=!1,i=!1){const n=document.createElement("div");n.className=`order-item${r?" group":""}${i?" nested":""}`,n.draggable=!1,n.dataset.component=e;const s=document.createElement("span");s.className="drag-handle",s.textContent="⋮⋮",s.draggable=!0;const o=document.createElement("span");if(o.className="component-label",o.textContent=t,i){const l=document.createElement("span");l.className="nested-indent",l.textContent="  ",n.appendChild(l)}return n.appendChild(s),n.appendChild(o),n}_getComponentLabel(e){return{compass:"Compass",result:"Mode Name",pitch:"Pitch",degree:"Degrees",intervals:"Intervals",chromatic:"Chromatic"}[e]}_saveOrder(){try{const e=wt()||{};e.layoutOrder=_.belts.layoutOrder,e.beltOrder=_.belts.order,jt(e)}catch(e){console.warn("Failed to save order preferences:",e)}}_loadSavedOrder(){try{const e=wt();e&&e.layoutOrder&&(_.belts.layoutOrder=e.layoutOrder),e&&e.beltOrder&&(_.belts.order=e.beltOrder)}catch(e){console.warn("Failed to load order preferences:",e)}}_applyComponentOrder(){this.onOrderChange&&this.onOrderChange(_.belts.layoutOrder,_.belts.order)}setOrderChangeCallback(e){this.onOrderChange=e}onOrientationChange(){this._updateDisplay()}_animateReorder(e){if(!this.container||!this.draggedItem||!e)return;const t=this.draggedItem,r=Array.from(this.container.querySelectorAll(".order-item")),i=r.indexOf(t),n=r.indexOf(e);if(i===-1||n===-1)return;const s=i>n;r.forEach((o,l)=>{if(o===t)return;let c=0;s?l>=n&&l<i&&(c=t.offsetHeight+8):l>i&&l<=n&&(c=-(t.offsetHeight+8)),o.style.transform=`translateY(${c}px)`,o.style.transition="transform 0.2s ease"})}_resetAnimations(){if(!this.container)return;this.container.querySelectorAll(".order-item").forEach(t=>{t.style.transform="",t.style.transition=""})}_createDragGhost(e,t,r){const i=e.cloneNode(!0);return i.classList.add("drag-ghost"),i.style.position="fixed",i.style.pointerEvents="none",i.style.zIndex="9999",i.style.opacity="0.8",i.style.width=e.offsetWidth+"px",i.style.left=t-e.offsetWidth/2+"px",i.style.top=r-e.offsetHeight/2+"px",i.style.transform="rotate(-2deg)",i.style.transition="none",document.body.appendChild(i),i}_updateDragGhost(e,t){this.dragGhost&&(this.dragGhost.style.left=e-this.dragGhost.offsetWidth/2+"px",this.dragGhost.style.top=t-this.dragGhost.offsetHeight/2+"px")}_removeDragGhost(){this.dragGhost&&(this.dragGhost.remove(),this.dragGhost=null)}_handleTouchStart(e){const t=e.target;if(!t||!t.classList.contains("drag-handle"))return;const r=e.touches[0];this.touchStartY=r.clientY,this.touchStartX=r.clientX,this.isDraggingTouch=!1,this.draggedItem=t.closest(".order-item"),this.draggedItem&&console.log("Touch start on drag handle:",this.draggedItem.dataset.component)}_handleTouchMove(e){if(!this.draggedItem)return;const t=e.touches[0],r=Math.abs(t.clientY-this.touchStartY),i=Math.abs(t.clientX-this.touchStartX);if(!this.isDraggingTouch&&(r>this.touchScrollThreshold||i>this.touchScrollThreshold)&&(this.isDraggingTouch=!0,this.draggedItem.classList.add("dragging"),e.preventDefault(),this.dragGhost=this._createDragGhost(this.draggedItem,t.clientX,t.clientY),console.log("Started touch dragging")),this.isDraggingTouch){e.preventDefault(),this._updateDragGhost(t.clientX,t.clientY);const s=document.elementFromPoint(t.clientX,t.clientY)?.closest(".order-item")??null;s&&s!==this.draggedItem&&(this.dragOverItem&&this.dragOverItem!==s&&this.dragOverItem.classList.remove("drag-over"),this.dragOverItem=s,s.classList.add("drag-over"),this._animateReorder(s))}}_handleTouchEnd(e){if(this.draggedItem){if(this.isDraggingTouch){if(e.preventDefault(),console.log("Touch drag ended"),this.dragOverItem&&this.dragOverItem!==this.draggedItem){const t=this.draggedItem.dataset.component,r=this.dragOverItem.dataset.component;if(!t||!r)return;console.log(`Touch dropping ${t} onto ${r}`),this._reorderComponents(t,r),this._saveOrder(),this._updateDisplay(),this._applyComponentOrder()}this._removeDragGhost()}this.draggedItem&&this.draggedItem.classList.remove("dragging"),this.dragOverItem&&this.dragOverItem.classList.remove("drag-over"),this._resetAnimations(),this.draggedItem=null,this.dragOverItem=null,this.isDraggingTouch=!1}}destroy(){this.container&&(this.container.removeEventListener("dragstart",this._handleDragStart.bind(this)),this.container.removeEventListener("dragover",this._handleDragOver.bind(this)),this.container.removeEventListener("dragenter",this._handleDragEnter.bind(this)),this.container.removeEventListener("dragleave",this._handleDragLeave.bind(this)),this.container.removeEventListener("drop",this._handleDrop.bind(this)),this.container.removeEventListener("dragend",this._handleDragEnd.bind(this)))}}class Fo{state;callbacks;elements;orderManager;_lastOrientation;constructor(e,t,r){this.state=t,this.callbacks=r,this.orderManager=null,this._lastOrientation=null,this.elements={resultContainer:e.querySelector("#result-container"),resultText:e.querySelector("#result-text"),flatBtn:document.getElementById("flat-btn"),sharpBtn:document.getElementById("sharp-btn"),settingsBtn:document.getElementById("settings-btn"),sidebar:document.getElementById("sidebar"),sidebarOverlay:document.getElementById("sidebar-overlay"),orientationHorizontal:document.getElementById("orientation-horizontal"),orientationVertical:document.getElementById("orientation-vertical"),themeLight:document.getElementById("theme-light"),themeDark:document.getElementById("theme-dark"),startTutorialBtn:document.getElementById("start-tutorial-btn")},this._initListeners(),this._initBeltOrderManager(),this._loadSavedPreferences()}_initListeners(){this.elements.flatBtn.addEventListener("click",this.callbacks.onToggleFlat),this.elements.sharpBtn.addEventListener("click",this.callbacks.onToggleSharp),this.elements.resultContainer.addEventListener("click",i=>{i.target?.closest("button")||this.callbacks.onTogglePlayback()}),this.elements.settingsBtn.addEventListener("click",i=>{i.stopPropagation(),this.callbacks.onToggleSidebar()}),this.elements.sidebarOverlay.addEventListener("click",()=>{this.state.ui.sidebarOpen&&this.callbacks.onToggleSidebar(!1)}),this.elements.orientationHorizontal.addEventListener("change",()=>{this.elements.orientationHorizontal.checked&&this.callbacks.onToggleOrientation("horizontal")}),this.elements.orientationVertical.addEventListener("change",()=>{this.elements.orientationVertical.checked&&this.callbacks.onToggleOrientation("vertical")}),this.elements.themeLight.addEventListener("change",()=>{this.elements.themeLight.checked&&this.callbacks.onToggleDarkMode(!1)}),this.elements.themeDark.addEventListener("change",()=>{this.elements.themeDark.checked&&this.callbacks.onToggleDarkMode(!0)}),this.elements.startTutorialBtn.addEventListener("click",this.callbacks.onStartTutorial);const e=document.querySelectorAll(".cursor-color-btn");e.forEach(i=>{i.addEventListener("click",()=>{const n=i.dataset.color,s=i.dataset.fill==="true";e.forEach(o=>{o.classList.remove("active"),o.setAttribute("aria-checked","false")}),i.classList.add("active"),i.setAttribute("aria-checked","true"),this.callbacks.onSetCursorColor&&this.callbacks.onSetCursorColor(n,s)})});const t=document.getElementById("orientation-toggle"),r=document.getElementById("theme-toggle");t&&t.addEventListener("click",i=>{console.log("Orientation toggle clicked",i.target);const n=this.elements.orientationHorizontal.checked;console.log("Current orientation horizontal checked:",n),n?(console.log("Switching to vertical"),this.callbacks.onToggleOrientation("vertical")):(console.log("Switching to horizontal"),this.callbacks.onToggleOrientation("horizontal"))}),r&&r.addEventListener("click",i=>{console.log("Theme toggle clicked",i.target);const n=this.elements.themeLight.checked;console.log("Current theme light checked:",n),n?(console.log("Switching to dark mode"),this.callbacks.onToggleDarkMode(!0)):(console.log("Switching to light mode"),this.callbacks.onToggleDarkMode(!1))})}_initBeltOrderManager(){try{this.orderManager=new Bo,this.orderManager.setOrderChangeCallback((e,t)=>{this.callbacks.onOrderChange&&this.callbacks.onOrderChange(e,t)})}catch(e){console.warn("Order Manager failed to initialize:",e)}}async _loadSavedPreferences(){try{const{loadPreferences:e}=await Qe(async()=>{const{loadPreferences:r}=await Promise.resolve().then(()=>Ti);return{loadPreferences:r}},void 0),t=e();t&&t.cursorColor&&t.cursorFill!==void 0&&(this.state.ui.cursorColor=t.cursorColor,this.state.ui.cursorFill=t.cursorFill,document.querySelectorAll(".cursor-color-btn").forEach(i=>{const n=i.dataset.color===t.cursorColor,s=i.dataset.fill===String(t.cursorFill),o=n&&s;i.classList.toggle("active",o),i.setAttribute("aria-checked",String(o))}))}catch(e){console.warn("Could not load saved cursor preferences:",e)}}update(){const{display:e,playback:t,ui:r,belts:i}=this.state,{resultContainer:n,flatBtn:s,sharpBtn:o,resultText:l,sidebar:c,sidebarOverlay:h,settingsBtn:d,orientationHorizontal:g,orientationVertical:f,themeLight:p,themeDark:u}=this.elements;s.classList.toggle("active",e.flat),o.classList.toggle("active",e.sharp),s.setAttribute("aria-pressed",String(e.flat)),o.setAttribute("aria-pressed",String(e.sharp)),n.classList.toggle("playback-active",t.isPlaying),rs(this.state,l);const m=i.orientation==="horizontal";g.checked=m,f.checked=!m,p.checked=!r.darkMode,u.checked=r.darkMode;const y=r.sidebarOpen;c.classList.toggle("open",y),y?c.removeAttribute("aria-hidden"):c.setAttribute("aria-hidden","true"),h.classList.toggle("visible",y),d.setAttribute("aria-expanded",String(y)),this.orderManager&&this._lastOrientation!==i.orientation&&(this.orderManager.onOrientationChange(),this._lastOrientation=i.orientation)}destroy(){this.orderManager&&(this.orderManager.destroy(),this.orderManager=null)}}class zo{container;state;isInitialized;cleanupFunctions;performanceMonitor;keyboardManager;screenReaderManager;elements;wheel;belts;uiControls;constructor(e){this.container=e,this.state=_,this.isInitialized=!1,this.cleanupFunctions=[],this.performanceMonitor=null,this.keyboardManager=null,this.screenReaderManager=null,this.wheel=null,this.belts=null,this.uiControls=null;try{this._initializeApp()}catch(t){E.handle(t,"App",()=>{console.error("Failed to initialize app")})}}_initializeApp(){this.elements={canvas:this.container.querySelector("#chromaWheel"),beltsContainer:this.container.querySelector(".belts-container")};const{canvas:e,beltsContainer:t}=this.elements;if(!e)throw new Error("Canvas element not found");if(!t)throw new Error("Belts container not found");const r={onToggleFlat:E.wrap(()=>{K.toggleAccidental("flat"),this._announceChange(`Flat names ${this.state.display.flat?"enabled":"disabled"}`)},"UI"),onToggleSharp:E.wrap(()=>{K.toggleAccidental("sharp"),this._announceChange(`Sharp names ${this.state.display.sharp?"enabled":"disabled"}`)},"UI"),onToggleDarkMode:E.wrap(i=>{typeof i=="boolean"?this.state.ui.darkMode!==i&&K.toggleDarkMode():K.toggleDarkMode(),this._announceChange(`${this.state.ui.darkMode?"Dark":"Light"} mode enabled`)},"UI"),onTogglePlayback:E.wrap(()=>{K.togglePlayback(),this._announceChange(this.state.playback.isPlaying?"Scale playing":"Playback stopped")},"UI"),onToggleSidebar:E.wrap(i=>{K.toggleSidebar(i),this._announceChange(`Settings ${this.state.ui.sidebarOpen?"opened":"closed"}`)},"UI"),onToggleOrientation:E.wrap(i=>{let n;typeof i=="string"?n=i:n=this.state.belts.orientation==="horizontal"?"vertical":"horizontal",this.state.belts.orientation!==n&&(K.setOrientation(n),this._announceChange(`Layout changed to ${n}`))},"UI"),onStartTutorial:E.wrap(()=>{this._announceChange("Tutorial started"),Do()},"Tutorial"),onShowKeyboardHelp:E.wrap(()=>{this._showKeyboardHelp()},"UI"),onOrderChange:E.wrap((i,n)=>{console.log("Order change triggered:",{layoutOrder:i,beltOrder:n}),this._applyComponentOrder(i,n)},"UI"),onSetCursorColor:E.wrap((i,n)=>{K.setCursorColor(i,n),this._announceChange(`Cursor color changed to ${i}${n?" with fill":""}`)},"UI")};try{this.wheel=new Lo(e,this.state,this.onInteractionEnd.bind(this))}catch(i){E.handle(i,"Wheel",()=>{console.error("Wheel component failed to initialize")})}try{this.belts=new No(t,this.state,this.onInteractionEnd.bind(this))}catch(i){E.handle(i,"Belts",()=>{console.error("Belts component failed to initialize")})}try{this.uiControls=new Fo(this.container,this.state,r)}catch(i){E.handle(i,"UIControls",()=>{console.error("UI Controls failed to initialize")})}this._initializeAccessibility(),this._setupResponsiveLogic();try{Bn(E.wrap(this.redraw.bind(this),"RenderLoop"))}catch(i){E.handle(i,"RenderLoop",()=>{console.error("Render loop failed to start")})}this._setupPerformanceMonitoring(),this._setupAccessibilityMonitoring(),Pe.markDirty(this.state),this.isInitialized=!0}_initializeAccessibility(){try{this._loadAccessibilityModules().then(()=>{console.log("Accessibility features loaded")}).catch(()=>{console.log("Using basic accessibility features"),this._setupBasicAccessibility()})}catch(e){E.handle(e,"Accessibility",()=>{console.warn("Some accessibility features may not be available"),this._setupBasicAccessibility()})}}async _loadAccessibilityModules(){try{const{KeyboardManager:e}=await Qe(async()=>{const{KeyboardManager:r}=await import("./KeyboardManager-BrMYO6Id.js");return{KeyboardManager:r}},__vite__mapDeps([0,1])),{ScreenReaderManager:t}=await Qe(async()=>{const{ScreenReaderManager:r}=await import("./ScreenReaderManager-C4lztOWC.js");return{ScreenReaderManager:r}},__vite__mapDeps([2,1]));return e.init(),t.init(),this.keyboardManager=e,this.screenReaderManager=t,!0}catch{throw new Error("Accessibility modules not available")}}_setupBasicAccessibility(){this._setupBasicKeyboard(),this._setupBasicARIA(),this._setupBasicAnnouncements()}_setupBasicKeyboard(){const e=t=>{if(this._isTextInputActive()||t.ctrlKey||t.altKey||t.metaKey)return;const r=t.target;switch(t.key){case"ArrowLeft":(r?.id==="chromaWheel"||r?.closest(".belt"))&&(t.preventDefault(),this._rotateRing("pitchClass",-1),this._announceChange("Pitch ring rotated left"));break;case"ArrowRight":(r?.id==="chromaWheel"||r?.closest(".belt"))&&(t.preventDefault(),this._rotateRing("pitchClass",1),this._announceChange("Pitch ring rotated right"));break;case"ArrowUp":(r?.id==="chromaWheel"||r?.closest(".belt"))&&(t.preventDefault(),this._rotateRing("pitchClass",1),this._announceChange("Pitch ring rotated up"));break;case"ArrowDown":(r?.id==="chromaWheel"||r?.closest(".belt"))&&(t.preventDefault(),this._rotateRing("pitchClass",-1),this._announceChange("Pitch ring rotated down"));break;case" ":case"Enter":!r?.closest("button")&&!r?.closest("input")&&!r?.closest("select")&&(t.preventDefault(),K.togglePlayback());break;case"Escape":K.toggleSidebar(),this._announceChange(this.state.ui.sidebarOpen?"Settings opened":"Settings closed");break;case"f":case"F":t.preventDefault(),K.toggleAccidental("flat"),this._announceChange(`Flat names ${this.state.display.flat?"enabled":"disabled"}`);break;case"s":case"S":t.preventDefault(),K.toggleAccidental("sharp"),this._announceChange(`Sharp names ${this.state.display.sharp?"enabled":"disabled"}`);break;case"v":case"V":t.preventDefault();const i=this.state.belts.orientation==="horizontal"?"vertical":"horizontal";K.setOrientation(i),this._announceChange(`Layout changed to ${i}`);break}};document.addEventListener("keydown",e),this.cleanupFunctions.push(()=>{document.removeEventListener("keydown",e)})}_rotateRing(e,t){const r=t*(Math.PI*2/12),n=(this.state.rings[e]+r)%(Math.PI*2);K.setRingAngle(e,n)}_isTextInputActive(){const e=document.activeElement;return["INPUT","TEXTAREA","SELECT"].includes(e?.tagName||"")||e?.contentEditable==="true"}_applyComponentOrder(e,t){console.log("Applying component order:",{layoutOrder:e,beltOrder:t});const r=this.state.belts.orientation,i=e[r];console.log(`Current orientation: ${r}, order:`,i);let n=this.container.querySelector(".main-container");n||(n=document.querySelector(".main-container")),n&&this._restoreOriginalStructure(n),r==="horizontal"?(console.log("Calling _applyHorizontalOrder"),this._applyHorizontalOrder(i)):(console.log("Calling _applyVerticalOrder"),this._applyVerticalOrder(i)),t&&(console.log("Applying belt order:",t),this._applyBeltOrder(t))}_applyHorizontalOrder(e){console.log("_applyHorizontalOrder called with order:",e);let t=this.container.querySelector(".main-container");if(t||(t=document.querySelector(".main-container")),!t){console.log("ERROR: main-container not found anywhere"),console.log("this.container is:",this.container);return}console.log("Container element:",t),console.log("Container classes:",t.className),console.log("Container computed styles before:",{display:getComputedStyle(t).display,flexDirection:getComputedStyle(t).flexDirection,width:getComputedStyle(t).width,height:getComputedStyle(t).height});const r=t.querySelector(".belts-container"),i={compass:t.querySelector(".wheel-container"),result:t.querySelector("#result-container"),pitch:r?.querySelector(".pitch-belt")||null,degree:r?.querySelector(".degree-belt")||null,intervals:r?.querySelector(".interval-brackets-wrapper")||null,chromatic:r?.querySelector(".chromatic-belt")||null};console.log("Found components:",Object.keys(i).reduce((o,l)=>(o[l]=!!i[l],o),{})),console.log("Components dimensions before flattening:",{compass:i.compass?{width:i.compass.offsetWidth,height:i.compass.offsetHeight,display:getComputedStyle(i.compass).display}:null,beltsContainer:r?{width:r.offsetWidth,height:r.offsetHeight,display:getComputedStyle(r).display}:null});const n=["pitch","degree","intervals","chromatic"],s=[];n.forEach(o=>{const l=i[o];l&&(l._originalParent=l.parentNode,l._originalNextSibling=l.nextSibling,t.appendChild(l),s.push(l))}),r&&(r.style.display="none"),console.log("After flattening, container children:",Array.from(t.children).map(o=>{const l=o;return{tagName:l.tagName,className:l.className,id:l.id,display:getComputedStyle(l).display,flex:getComputedStyle(l).flex,width:l.offsetWidth,height:l.offsetHeight}})),e.forEach((o,l)=>{const c=i[o];c&&(c.style.setProperty("order",String(l+1),"important"),console.log(`Set order ${l+1} for component:`,o),console.log("Element after order applied:",{width:c.offsetWidth,height:c.offsetHeight,display:getComputedStyle(c).display,flex:getComputedStyle(c).flex,order:getComputedStyle(c).order}))}),console.log("Container computed styles after:",{display:getComputedStyle(t).display,flexDirection:getComputedStyle(t).flexDirection,width:getComputedStyle(t).width,height:getComputedStyle(t).height}),t._isFlattened=!0,t._beltElements=s,t._beltsContainer=r}_applyVerticalOrder(e){let t=this.container.querySelector(".main-container");if(t||(t=document.querySelector(".main-container")),!t)return;this._restoreOriginalStructure(t);const r=e.indexOf("compass"),i=e.indexOf("result");console.log("Vertical layout indices:",{order:e,compassIndex:r,resultIndex:i,compassFirst:r<i}),r>i?(t.style.gridTemplateAreas=`
        "wheel belts"
        "wheel result"
      `,console.log("Applied vertical order: compass left, belts right (compass after result)")):(t.style.gridTemplateAreas=`
        "belts wheel"
        "result wheel"
      `,console.log("Applied vertical order: belts left, compass right (compass before result)"))}_restoreOriginalStructure(e){e._isFlattened&&(console.log("Restoring original DOM structure"),e._beltElements&&e._beltsContainer&&(e._beltElements.forEach(t=>{t.style.removeProperty("order");const r=t._originalParent;r&&(t._originalNextSibling?r.insertBefore(t,t._originalNextSibling):r.appendChild(t),delete t._originalParent,delete t._originalNextSibling)}),e._beltsContainer.style.display=""),delete e._isFlattened,delete e._beltElements,delete e._beltsContainer)}_applyBeltOrder(e){const t=this.elements.beltsContainer;if(!t)return;const r={pitch:t.querySelector(".pitch-belt"),degree:t.querySelector(".degree-belt"),intervals:t.querySelector(".interval-brackets-wrapper"),chromatic:t.querySelector(".chromatic-belt")};e.forEach((i,n)=>{const s=r[i];s&&(s.style.setProperty("order",String(n+1),"important"),console.log(`Set belt order ${n+1} for belt:`,i))})}_setupBasicARIA(){this.container.setAttribute("role","main"),this.container.setAttribute("aria-label","Diatonic Compass Music Theory Tool"),this.elements.canvas&&(this.elements.canvas.setAttribute("tabindex","0"),this.elements.canvas.setAttribute("role","application"),this.elements.canvas.setAttribute("aria-label","Interactive Diatonic Compass - use arrow keys to explore"));const e=document.querySelector("#result-container");e&&(e.setAttribute("tabindex","0"),e.setAttribute("aria-label","Current musical key and mode - click to play"))}_setupBasicAnnouncements(){const e=document.createElement("div");e.id="basic-announcements",e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","false"),e.style.cssText=`
      position: absolute;
      left: -10000px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    `,document.body.appendChild(e),this.cleanupFunctions.push(()=>{e.parentNode&&e.parentNode.removeChild(e)})}_announceChange(e){const t=document.getElementById("basic-announcements");t&&(t.textContent="",setTimeout(()=>{t.textContent=e},100)),this.screenReaderManager&&this.screenReaderManager.queueAnnouncement(e)}_showKeyboardHelp(){const e=`
Keyboard Shortcuts:
- Tab: Navigate between controls
- Arrow keys: Rotate pitch ring (when focused on wheel/belts)
- Ctrl + arrows: Large steps (when focused on wheel/belts)
- Space/Enter: Play scale (when focused on wheel/result)
- F: Toggle flat note names
- S: Toggle sharp note names  
- V: Toggle vertical/horizontal layout
- H: Show this help
- Escape: Open/close settings

Focus the wheel or belts first, then use arrow keys to rotate rings.
    `.trim();alert(e)}_setupAccessibilityMonitoring(){const e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=n=>{document.body.classList.toggle("reduced-motion",n.matches)};e.addListener(t),t(e),this.cleanupFunctions.push(()=>{e.removeListener(t)});const r=window.matchMedia("(prefers-contrast: high)"),i=n=>{document.body.classList.toggle("high-contrast",n.matches)};r.addListener(i),i(r),this.cleanupFunctions.push(()=>{r.removeListener(i)})}onInteractionEnd(){setTimeout(()=>{const e=document.querySelector("#result-text");e&&this._announceChange(`Current key: ${e.textContent}`)},100)}_setupResponsiveLogic(){let e=!1;const t=()=>{e||(e=!0,this.elements.beltsContainer&&(this.elements.beltsContainer.style.opacity="0"))},r=rt.debounce(()=>{try{const s=window.innerWidth>window.innerHeight?"vertical":"horizontal";this.state.belts.orientation!==s&&(K.setOrientation(s),this._announceChange(`Layout changed to ${s}`)),this.state.belts.init=!1,Pe.markDirty(this.state),requestAnimationFrame(()=>{this.elements.beltsContainer&&(this.elements.beltsContainer.style.opacity="1"),e=!1})}catch(n){E.handle(n,"Resize",()=>{console.warn("Resize handling failed")}),this.elements.beltsContainer&&(this.elements.beltsContainer.style.opacity="1"),e=!1}},250),i=()=>{t(),r()};window.addEventListener("resize",i),this.cleanupFunctions.push(()=>{window.removeEventListener("resize",i),r.cancel()});try{const s=window.innerWidth>window.innerHeight?"vertical":"horizontal";K.setOrientation(s)}catch(n){E.handle(n,"Resize")}}_setupPerformanceMonitoring(){let e=0;const t=3;if(this.performanceMonitor=rt.createFPSMonitor(r=>{r<30?(e++,console.warn(`Low FPS detected: ${r} (count: ${e})`),e>=t&&!this.state.performance.isLowPowerMode&&(this.state.performance.isLowPowerMode=!0,document.body.classList.add("low-power-mode"),console.log("Low-power mode enabled due to poor performance"),this._announceChange("Performance mode adjusted for this device"))):r>=50&&(e=Math.max(0,e-1),e===0&&this.state.performance.isLowPowerMode&&(this.state.performance.isLowPowerMode=!1,document.body.classList.remove("low-power-mode"),console.log("Low-power mode disabled - performance improved")))},120),rt.getMemoryInfo()){const r=setInterval(()=>{const i=rt.getMemoryInfo();i&&i.used>100&&console.warn(`High memory usage: ${i.used}MB`)},3e4);this.cleanupFunctions.push(()=>clearInterval(r))}this.cleanupFunctions.push(()=>{this.performanceMonitor&&(this.performanceMonitor(),this.performanceMonitor=null)})}redraw(e){try{const t=is(e);if(Fn(this.elements.canvas,this.state.dimensions)&&Pe.markDirty(this.state),!this.state.performance.isLowPowerMode&&!Pe.needsRedraw(this.state)||!this.state.dimensions.size||this.state.performance.isLowPowerMode&&t&&(this.state.performance.frameSkipCounter++,this.state.performance.frameSkipCounter%2===1))return;const i=mi(this.state),{rings:n,playback:s}=this.state,o=zt;if(this.wheel)try{this.wheel.update(n,i,s)}catch(l){E.handle(l,"Wheel",()=>{console.warn("Wheel update failed - skipping frame")})}if(this.belts)try{this.belts.update(i,o)}catch(l){E.handle(l,"Belts",()=>{console.warn("Belts update failed - skipping frame")})}if(this.uiControls)try{this.uiControls.update()}catch(l){E.handle(l,"UIControls",()=>{console.warn("UI Controls update failed - skipping frame")})}Pe.markClean(this.state)}catch(t){E.handle(t,"RenderLoop",()=>{console.error("Critical render error - app may be unstable")})}}destroy(){try{this.keyboardManager,this.screenReaderManager&&this.screenReaderManager.cleanup(),this.cleanupFunctions.forEach(e=>{try{e()}catch(t){console.warn("Cleanup function failed:",t)}}),this.cleanupFunctions=[],this.wheel&&typeof this.wheel.destroy=="function"&&this.wheel.destroy(),this.belts&&typeof this.belts.destroy=="function"&&this.belts.destroy(),this.uiControls&&typeof this.uiControls.destroy=="function"&&this.uiControls.destroy(),this.performanceMonitor&&(this.performanceMonitor(),this.performanceMonitor=null),this.isInitialized=!1}catch(e){E.handle(e,"App",()=>{console.error("App cleanup failed")})}}_isDevelopment(){return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.protocol==="file:"}getStatus(){return{initialized:this.isInitialized,components:{wheel:!!this.wheel,belts:!!this.belts,uiControls:!!this.uiControls},accessibility:{keyboardEnabled:this.keyboardManager?.isEnabled,screenReaderEnabled:this.screenReaderManager?.isEnabled},dimensions:this.state.dimensions,errors:E.getErrorLog()}}}const Ho=`<!-- Apply dark mode immediately to prevent FOUC -->\r
\r
\r
<!-- Settings button with enhanced accessibility -->\r
<button id="settings-btn"\r
        aria-label="Open settings sidebar"\r
        aria-controls="sidebar"\r
        aria-expanded="false"\r
        aria-describedby="settings-btn-help">\r
  <img src="public/assets/Settings_optimized.svg" alt="" width="48" height="48">\r
</button>\r
<div id="settings-btn-help" class="sr-only">\r
  Opens a panel with display options, theme settings, and keyboard shortcuts\r
</div>\r
\r
<!-- Enhanced sidebar with better structure -->\r
<nav id="sidebar" \r
     role="complementary" \r
     aria-hidden="true"\r
     aria-labelledby="sidebar-title">\r
  <div class="sidebar-content">\r
    <h2 id="sidebar-title">Diatonic Compass</h2>\r
    \r
    <!-- Tutorial button at top -->\r
    <button id="start-tutorial-btn" \r
            class="sidebar-btn tutorial-btn"\r
            aria-describedby="tutorial-help">Start Tutorial</button>\r
    <div id="tutorial-help" class="sr-only">\r
      Begin an interactive tutorial explaining how to use the Diatonic Compass\r
    </div>\r
    \r
    <!-- Layout Orientation setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Orientation</h3>\r
      <div class="toggle-switch-container">\r
        <div class="toggle-switch" id="orientation-toggle">\r
          <input type="radio" name="orientation" id="orientation-horizontal" value="horizontal" checked>\r
          <label for="orientation-horizontal">Horizontal</label>\r
          <input type="radio" name="orientation" id="orientation-vertical" value="vertical">\r
          <label for="orientation-vertical">Vertical</label>\r
          <div class="toggle-slider"></div>\r
        </div>\r
      </div>\r
    </div>\r
    \r
    <!-- Accidentals setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Accidentals</h3>\r
      <div class="accidentals-controls">\r
        <button id="flat-btn" \r
                class="accidental-toggle" \r
                aria-pressed="true" \r
                aria-label="Show flat note names">♭</button>\r
        <button id="sharp-btn" \r
                class="accidental-toggle" \r
                aria-pressed="true" \r
                aria-label="Show sharp note names">♯</button>\r
      </div>\r
    </div>\r
    \r
    <!-- Theme setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Colour Theme</h3>\r
      <div class="toggle-switch-container">\r
        <div class="toggle-switch" id="theme-toggle">\r
          <input type="radio" name="theme" id="theme-light" value="light" checked>\r
          <label for="theme-light">Light</label>\r
          <input type="radio" name="theme" id="theme-dark" value="dark">\r
          <label for="theme-dark">Dark</label>\r
          <div class="toggle-slider"></div>\r
        </div>\r
      </div>\r
    </div>\r
\r
    <!-- Cursor Color setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Cursor Colour</h3>\r
      <div class="cursor-color-picker" role="radiogroup" aria-label="Select cursor color">\r
        <button class="cursor-color-btn active"\r
                data-color="red"\r
                data-fill="false"\r
                aria-label="Red outline"\r
                role="radio"\r
                aria-checked="true">\r
          <div class="color-square red-outline"></div>\r
        </button>\r
        <button class="cursor-color-btn"\r
                data-color="red"\r
                data-fill="true"\r
                aria-label="Red with fill"\r
                role="radio"\r
                aria-checked="false">\r
          <div class="color-square red-fill"></div>\r
        </button>\r
        <button class="cursor-color-btn"\r
                data-color="blue"\r
                data-fill="true"\r
                aria-label="Blue with fill"\r
                role="radio"\r
                aria-checked="false">\r
          <div class="color-square blue-fill"></div>\r
        </button>\r
        <button class="cursor-color-btn"\r
                data-color="green"\r
                data-fill="true"\r
                aria-label="Green with fill"\r
                role="radio"\r
                aria-checked="false">\r
          <div class="color-square green-fill"></div>\r
        </button>\r
        <button class="cursor-color-btn"\r
                data-color="yellow"\r
                data-fill="true"\r
                aria-label="Yellow with fill"\r
                role="radio"\r
                aria-checked="false">\r
          <div class="color-square yellow-fill"></div>\r
        </button>\r
      </div>\r
    </div>\r
\r
    <!-- Component Order setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Component Order</h3>\r
      <div id="order-container" aria-describedby="order-help">\r
        <div id="order-help" class="sr-only">\r
          Drag the components to reorder how they appear in the interface\r
        </div>\r
        <div id="belt-order-list" role="listbox" aria-label="Component ordering controls">\r
          <!-- Components will be populated by OrderManager -->\r
        </div>\r
      </div>\r
    </div>\r
    \r
    <!-- Keyboard Shortcuts info -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Keyboard Shortcuts</h3>\r
      <div class="accessibility-text">\r
        <p> <span class="key">Tab</span> Navigate between controls</p>\r
        <p> <span class="key">Arrow keys</span> Rotate ring / belt</p>\r
        <p> <span class="key">Space</span>/<span class="key">Enter</span>: Play scale</p>\r
        <p> <span class="key">F</span> Toggle flat note names</p>\r
        <p> <span class="key">S</span> Toggle sharp note names</p>\r
        <p> <span class="key">V</span> Toggle vertical/horizontal layout</p>\r
        <p> <span class="key">F1</span> Open/close settings</p>\r
      </div>\r
    </div>\r
    \r
    <!-- Credit -->\r
    <div class="sidebar-credit">\r
      <small>Created by Quinn Fleming</small>\r
    </div>\r
  </div>\r
</nav>\r
\r
<!-- Sidebar overlay for mobile -->\r
<div id="sidebar-overlay" aria-hidden="true"></div>\r
\r
<!-- Main application content -->\r
<main class="main-container" \r
      id="main-content"\r
      role="application" \r
      aria-label="Diatonic Compass interactive music theory tool">\r
  \r
  <!-- Wheel container with enhanced accessibility -->\r
  <section class="wheel-container" aria-labelledby="wheel-title">\r
    <h2 id="wheel-title" class="sr-only">Interactive Compass Wheel</h2>\r
    <canvas id="chromaWheel" \r
            aria-label="Three-ring musical compass: outer ring for pitch classes, middle ring for scale degrees, inner ring for chromatic positions"\r
            aria-describedby="wheel-instructions"\r
            tabindex="0"\r
            role="img"></canvas>\r
    <div id="wheel-instructions" class="sr-only">\r
      Use arrow keys to rotate the rings and explore different musical keys and modes. \r
      Left and right arrows control the outer pitch ring, \r
      up and down arrows control the middle degree ring, \r
      shift plus arrows control the inner chromatic ring.\r
    </div>\r
  </section>\r
  \r
  <!-- Belts container with enhanced structure -->\r
  <section class="belts-container" aria-labelledby="belts-title">\r
    <h2 id="belts-title" class="sr-only">Musical Information Belts</h2>\r
    \r
    <!-- Visual cursor and flash overlay -->\r
    <div id="belt-cursor" aria-hidden="true"></div>\r
    <div id="belt-flash-overlay" aria-hidden="true"></div>\r
    \r
    <!-- Pitch belt -->\r
    <div class="belt pitch-belt" \r
         id="pitchBelt" \r
         role="listbox" \r
         aria-label="Pitch names belt"\r
         aria-describedby="pitch-belt-desc"\r
         tabindex="0">\r
      <div id="pitch-belt-desc" class="sr-only">\r
        Shows pitch class names like C, D, E. Drag or use left/right arrow keys to change.\r
      </div>\r
    </div>\r
    \r
    <!-- Degree belt -->\r
    <div class="belt degree-belt" \r
         id="degreeBelt" \r
         role="listbox" \r
         aria-label="Scale degrees belt"\r
         aria-describedby="degree-belt-desc"\r
         tabindex="0">\r
      <div id="degree-belt-desc" class="sr-only">\r
        Shows scale degree numbers like 1, 2, 3. Drag or use up/down arrow keys to change mode.\r
      </div>\r
    </div>\r
\r
    <!-- Interval brackets (decorative) -->\r
    <div class="interval-brackets-wrapper" \r
         aria-hidden="true" \r
         role="presentation">\r
      <div class="interval-brackets-container" \r
           id="intervalBracketsContainer" \r
           role="presentation"></div>\r
    </div>\r
\r
    <!-- Chromatic belt -->\r
    <div class="belt chromatic-belt" \r
         id="chromaticBelt" \r
         role="listbox" \r
         aria-label="Chromatic positions belt"\r
         aria-describedby="chromatic-belt-desc"\r
         tabindex="0">\r
      <div id="chromatic-belt-desc" class="sr-only">\r
        Shows chromatic position numbers 0 through 11. Drag or use shift+arrow keys to change perspective.\r
      </div>\r
      <!-- Color track (moves with degree ring) -->\r
      <div id="chromatic-colors-track" \r
           class="belt-track" \r
           aria-hidden="true"></div>\r
      <!-- Numbers track (moves with chromatic ring) -->\r
      <div id="chromatic-numbers-track" \r
           class="belt-track"\r
           aria-hidden="true"></div>\r
    </div>\r
  </section>\r
  \r
  <!-- Result display with enhanced accessibility -->\r
  <section id="result-container"\r
           role="region"\r
           aria-label="Current musical key and mode"\r
           aria-describedby="result-instructions"\r
           tabindex="0">\r
    <div id="result-text"\r
         role="status"\r
         aria-live="polite"\r
         aria-atomic="true"></div>\r
    <div id="result-instructions" class="sr-only">\r
      Shows the current key and mode. Click or press space to play the scale.\r
    </div>\r
  </section>\r
</main>\r
\r
<!-- Tutorial elements with enhanced accessibility -->\r
<div id="tutorial-mask" \r
     aria-hidden="true" \r
     role="presentation"></div>\r
<dialog id="tutorial-bubble" \r
        role="dialog" \r
        aria-labelledby="tutorial-text" \r
        aria-modal="true"\r
        aria-describedby="tutorial-instructions">\r
  <div id="tutorial-text" aria-live="assertive"></div>\r
  <div id="tutorial-instructions" class="sr-only">\r
    Tutorial dialog. Follow the spoken instructions and interact with the highlighted elements.\r
  </div>\r
</dialog>\r
\r
<!-- Status messages for screen readers -->\r
<div id="status-messages" aria-live="polite" aria-atomic="false" class="sr-only"></div>\r
<div id="urgent-messages" aria-live="assertive" aria-atomic="true" class="sr-only"></div>\r
\r
<!-- Scripts -->\r
\r
\r
\r
<!-- Feature detection and graceful degradation -->\r
\r
\r

\r
<!-- Structured data for search engines -->
`,qo=Object.assign({"../public/apple-touch-icon.png":kn,"../public/assets/Settings_optimized.svg":En,"../public/assets/Volume_optimized.svg":An,"../public/favicon-96x96.png":In,"../public/favicon.ico":On,"../public/favicon.svg":Pn,"../public/site.webmanifest":Dn,"../public/web-app-manifest-192x192.png":Mn,"../public/web-app-manifest-512x512.png":Rn}),$o="../public/";function Uo(a){const e=a.replace(/^\/?public\//,""),t=`${$o}${e}`;return qo[t]??a}function Wo(a){a.querySelectorAll("[src], [href]").forEach(t=>{const r=t.hasAttribute("src")?"src":"href",i=t.getAttribute(r);!i||i.startsWith("http")||i.startsWith("data:")||i.startsWith("#")||i.startsWith("public/")&&t.setAttribute(r,Uo(i))})}function Vo(){const a=wt();if(a&&(typeof a.darkMode=="boolean"&&(_.ui.darkMode=a.darkMode,document.body.classList.toggle("dark-mode",a.darkMode)),Array.isArray(a.beltOrder))){const e=["pitch","degree","intervals","chromatic"],t=a.beltOrder;if(e.every(i=>t.includes(i))&&t.length===e.length){_.belts.order=t;const i=document.querySelector(".belts-container");if(i){const n={pitch:".pitch-belt",degree:".degree-belt",intervals:".interval-brackets-wrapper",chromatic:".chromatic-belt"};t.forEach((s,o)=>{const l=n[s],c=l?i.querySelector(l):null;c&&(c.style.order=String(o+1))})}}}}function Yo(a){a.innerHTML=Ho,Wo(a),Vo();const e=a.querySelector(".main-container");if(!e)throw new Error("Diatonic Compass root container not found.");const t=new zo(e);return{destroy:()=>{t.destroy(),document.body.classList.remove("dark-mode","low-power-mode","high-contrast","reduced-motion"),a.innerHTML=""}}}const fi=document.getElementById("app");fi&&Yo(fi);export{K as A,J as C,zt as D,E,_ as a,G as b,mi as c,Xo as g,F as n,Xt as s};
