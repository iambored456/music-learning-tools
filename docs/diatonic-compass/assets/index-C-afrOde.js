var kn=Object.defineProperty;var En=(a,e,t)=>e in a?kn(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var A=(a,e,t)=>En(a,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();const On="/assets/apple-touch-icon-BWxcdW_v.png",An="/assets/Settings_optimized-TJsqx0gz.svg",In="/assets/Volume_optimized-BF7HNWqG.svg",Pn="/assets/favicon-96x96-BFjbGiHf.png",Dn="/assets/favicon-EiJHQ7f4.ico",Mn="/assets/favicon-oxmeNcL9.svg",Rn="data:application/manifest+json;base64,ew0KICAibmFtZSI6ICJEaWF0b25pYyBDb21wYXNzIiwNCiAgInNob3J0X25hbWUiOiAiRGlhQ29tcGFzcyIsDQogICJpY29ucyI6IFsNCiAgICB7DQogICAgICAic3JjIjogIi9EaWF0b25pYy1Db21wYXNzL3dlYi1hcHAtbWFuaWZlc3QtMTkyeDE5Mi5wbmciLA0KICAgICAgInNpemVzIjogIjE5MngxOTIiLA0KICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIiwNCiAgICAgICJwdXJwb3NlIjogIm1hc2thYmxlIg0KICAgIH0sDQogICAgew0KICAgICAgInNyYyI6ICIvRGlhdG9uaWMtQ29tcGFzcy93ZWItYXBwLW1hbmlmZXN0LTUxMng1MTIucG5nIiwNCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwNCiAgICAgICJ0eXBlIjogImltYWdlL3BuZyIsDQogICAgICAicHVycG9zZSI6ICJtYXNrYWJsZSINCiAgICB9DQogIF0sDQogICJ0aGVtZV9jb2xvciI6ICIjZmZmZmZmIiwNCiAgImJhY2tncm91bmRfY29sb3IiOiAiI2ZmZmZmZiIsDQogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiDQp9",Ln="/assets/web-app-manifest-192x192-CQUvWY5p.png",Nn="/assets/web-app-manifest-512x512-DMiNyMET.png",Bn="modulepreload",Fn=function(a){return"/"+a},Yr={},Ze=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let s=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=s(t.map(c=>{if(c=Fn(c),c in Yr)return;Yr[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":Bn,h||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),h)return new Promise((g,m)=>{f.addEventListener("load",g),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&n(o.reason);return e().catch(n)})},y={rings:{pitchClass:0,degree:0,chromatic:0,highlightPosition:0},drag:{active:null,startX:0,startY:0,startPitchClass:0,startDegree:0,startChrom:0,startHighlight:0},animation:null,belts:{itemSize:{},tracks:{},init:!1,orientation:"horizontal",order:["pitch","degree","intervals","chromatic"],layoutOrder:{horizontal:["compass","pitch","degree","intervals","chromatic","result"],vertical:["compass","result"]}},dimensions:{size:0,cx:0,cy:0,dpr:1},playback:{isPlaying:!1,currentNoteIndex:null,sequence:[],timeoutId:null,audioContext:null,rootNoteIndexForPlayback:null},display:{sharp:!0,flat:!0},ui:{sidebarOpen:!1,darkMode:!1,cursorColor:"red",cursorFill:!1,display:{get sharp(){return y.display.sharp},get flat(){return y.display.flat},set sharp(a){y.display.sharp=a},set flat(a){y.display.flat=a}}},performance:{needsRedraw:!0,lastRenderState:null,frameSkipCounter:0,isLowPowerMode:!1}},Gr=Object.freeze(Object.defineProperty({__proto__:null,appState:y},Symbol.toStringTag,{value:"Module"}));function zn(a){function e(t){a(t),requestAnimationFrame(e)}requestAnimationFrame(e)}class E{static handle(e,t,r=null){const i=e instanceof Error?e:new Error(String(e)),n={message:i.message,stack:i.stack,context:t,timestamp:Date.now(),userAgent:navigator.userAgent};if(console.error(`[${t}] Error:`,i),this.logError(n),r)try{r()}catch(s){console.error(`[${t}] Fallback failed:`,s)}this.attemptRecovery(t,i)}static logError(e){try{const t=JSON.parse(sessionStorage.getItem("diatonic-errors")||"[]");t.push(e);const r=t.slice(-20);sessionStorage.setItem("diatonic-errors",JSON.stringify(r))}catch(t){this.isDebugMode&&console.warn("Could not log error to sessionStorage:",t)}}static attemptRecovery(e,t){switch(e){case"AudioContext":this.recoverAudioContext();break;case"Canvas":this.recoverCanvas();break;case"Animation":this.recoverAnimation();break;case"LocalStorage":this.recoverLocalStorage();break;case"Resize":console.warn("Resize error detected - may self-resolve");break;default:this.isDebugMode&&console.warn(`No specific recovery strategy for context: ${e}`)}}static recoverAudioContext(){Ze(async()=>{const{appState:e}=await Promise.resolve().then(()=>Gr);return{appState:e}},void 0).then(({appState:e})=>{if(e.playback.audioContext){try{e.playback.audioContext.close()}catch{}e.playback.audioContext=null}e.playback.isPlaying&&(e.playback.isPlaying=!1,e.playback.currentNoteIndex=null,e.playback.sequence=[],e.playback.timeoutId&&(clearTimeout(e.playback.timeoutId),e.playback.timeoutId=null))})}static recoverCanvas(){requestAnimationFrame(()=>{console.log("Attempting canvas recovery via redraw")})}static recoverAnimation(){Ze(async()=>{const{appState:e}=await Promise.resolve().then(()=>Gr);return{appState:e}},void 0).then(({appState:e})=>{e.animation=null,e.drag.active=null})}static recoverLocalStorage(){console.warn("LocalStorage unavailable - preferences will not persist")}static getErrorLog(){try{return JSON.parse(sessionStorage.getItem("diatonic-errors")||"[]")}catch{return[]}}static clearErrorLog(){try{sessionStorage.removeItem("diatonic-errors")}catch{}}static enableDebugMode(){this.isDebugMode=!0,console.log("ErrorHandler debug mode enabled")}static isFeatureSupported(e){switch(e){case"AudioContext":return!!(window.AudioContext||window.webkitAudioContext);case"localStorage":try{const t="__localStorage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}case"requestIdleCallback":return typeof window.requestIdleCallback=="function";case"OffscreenCanvas":return typeof OffscreenCanvas<"u";default:return!0}}static wrap(e,t,r=null){return(...i)=>{try{return e(...i)}catch(n){return this.handle(n,t,r?()=>{r(...i)}:null),r?r(...i):void 0}}}}A(E,"isDebugMode",!1);function Hn(a,e){try{if(!a)return console.warn("No canvas element provided"),!1;if(!e)return console.warn("No dimensions object provided"),!1;if(!a.parentElement)return!1;const t=a.closest(".main-container"),r=t&&t.classList.contains("vertical-layout"),i=a.parentElement.offsetWidth,n=a.parentElement.offsetHeight,s=window.innerWidth,o=window.innerHeight,l=t?t.offsetWidth:0,c=t?t.offsetHeight:0;let h=a;const d=[];for(;h&&h!==document.body;)d.push({tagName:h.tagName,className:h.className,id:h.id,width:h.offsetWidth,height:h.offsetHeight,style:{width:h.style.width,height:h.style.height,display:getComputedStyle(h).display,position:getComputedStyle(h).position}}),h=h.parentElement;const f=qn();let g;if(r){const C=Math.max(i,s*.8),b=Math.max(n,o*.8);g=Math.min(C,b)}else{const C=Math.min(i,n);g=Math.min(C,window.innerHeight*.8)}const m=e.size||0,u=Math.abs(g-m),p=m===0||u>=2,_=e.dpr!==f;if(u>50&&(console.log("=== CANVAS CONTAINER DEBUG ==="),console.log("Vertical mode:",r),console.log("Canvas size:",{width:a.width,height:a.height}),console.log("Container dimensions:",{containerWidth:i,containerHeight:n}),console.log("Viewport dimensions:",{viewportWidth:s,viewportHeight:o}),console.log("Calculated size:",g),console.log("DOM Hierarchy (from canvas to body):"),d.forEach((C,b)=>{console.log(`  ${b}: ${C.tagName}${C.id?"#"+C.id:""}${C.className?"."+C.className.replace(/\s+/g,"."):""}`,{dimensions:`${C.width}x${C.height}`,styles:C.style})})),g===0||!p&&!_)return!1;console.log("Canvas resize proceeding:",{oldSize:e.size,newSize:g,sizeChanged:p,dprChanged:_,difference:u}),e.size=g,e.cx=g/2,e.cy=g/2,e.dpr=f;const v=g*f,T=g*f;return console.log("Setting canvas dimensions:",{cssSize:`${g}px`,bufferSize:`${v}x${T}`,dpr:f,beforeCSS:{width:a.style.width,height:a.style.height},beforeBuffer:{width:a.width,height:a.height}}),a.width=v,a.height=T,a.style.width=`${g}px`,a.style.height=`${g}px`,console.log("Canvas dimensions after setting:",{cssSize:{width:a.style.width,height:a.style.height},bufferSize:{width:a.width,height:a.height},offsetSize:{width:a.offsetWidth,height:a.offsetHeight}}),!0}catch(t){return E.handle(t,"Canvas",()=>{try{if(a&&a.parentElement&&e){const r=Math.min(a.parentElement.offsetWidth,a.parentElement.offsetHeight);r>0&&r!==e.size&&(e.size=r,e.cx=r/2,e.cy=r/2,e.dpr=e.dpr||1,a.width=r*e.dpr,a.height=r*e.dpr)}}catch{console.error("Canvas resize fallback failed")}}),!1}}function qn(){try{return Math.min(window.devicePixelRatio||1,3)}catch(a){return E.handle(a,"Canvas"),1}}const Ft=["C","C♯/D♭","D","D♯/E♭","E","F","F♯/G♭","G","G♯/A♭","A","A♯/B♭","B"],zt=["1","♯1/♭2","2","♯2/♭3","3","4","♯4/♭5","5","♯5/♭6","6","♯6/♭7","7"],$n=[...Array(12).keys()],ke=12,Ht=[0,2,4,5,7,9,11],_t={C:!0,"C♯/D♭":!1,D:!0,"D♯/E♭":!1,E:!0,F:!0,"F♯/G♭":!1,G:!0,"G♯/A♭":!1,A:!0,"A♯/B♭":!1,B:!0},hr={0:"#f090ae",2:"#ea9e5e",4:"#a8bd61",5:"#76c788",7:"#33c6dc",9:"#94adff",11:"#dd95d6",1:"#a46055",3:"#8a722f",6:"#258677",8:"#3d7ca5",10:"#7d68a3"},Un={1:[0,2,4,5,7,9,11],2:[0,2,3,5,7,9,10],3:[0,1,3,5,7,8,10],4:[0,2,4,6,7,9,11],5:[0,2,4,5,7,9,10],6:[0,2,3,5,7,8,10],7:[0,1,3,5,6,8,10]},gi={1:"1","♯1/♭2":"2",2:"2","♯2/♭3":"3",3:"3",4:"4","♯4/♭5":"5",5:"5","♯5/♭6":"6",6:"6","♯6/♭7":"7",7:"7"},Wn={1:"Major",2:"Dorian",3:"Phrygian",4:"Lydian",5:"Mixolydian",6:"Minor",7:"Locrian"},Vn=[2,2,1,2,2,2,1],Xe=Math.PI*2,X=Xe/12,Q={ANIMATION:{DURATION_MS:300},WHEEL:{FONTS:{OUTER_FACTOR:.057,MIDDLE_FACTOR:.052,INNER_FACTOR:.042}},AUDIO:{BASE_FREQUENCY:261.63,NOTE_DURATION_MS:250,PAUSE_BETWEEN_NOTES_MS:50},ERROR_HANDLING:{CONTEXTS:{AUDIO:"AudioContext",ANIMATION:"Animation",UI:"UI",APP:"App"}}},Yn=Q.WHEEL.FONTS.OUTER_FACTOR,Gn=Q.WHEEL.FONTS.MIDDLE_FACTOR,Xn=Q.WHEEL.FONTS.INNER_FACTOR,jn=Q.ANIMATION.DURATION_MS,Xr=Q.AUDIO.NOTE_DURATION_MS,Kn=Q.AUDIO.PAUSE_BETWEEN_NOTES_MS,Jn=Q.AUDIO.BASE_FREQUENCY,Qn=1/X,z=a=>(a%Xe+Xe)%Xe;function pi(a,e){const t=z(e)-z(a);return t>Math.PI?t-Xe:t<-Math.PI?t+Xe:t}const Zn=a=>a<.5?2*a*a:-1+(4-2*a)*a,qt=a=>(Math.round(-z(a)*Qn)%12+12)%12;class it{static debounce(e,t){let r=null;const i=(...n)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>e.apply(this,n),t)};return i.cancel=()=>{r!==null&&clearTimeout(r),r=null},i}static throttle(e,t){let r=!1,i=null,n=0;return(...s)=>{r?(i!==null&&clearTimeout(i),i=setTimeout(()=>{Date.now()-n>=t&&(e.apply(this,s),n=Date.now())},t-(Date.now()-n))):(e.apply(this,s),n=Date.now(),r=!0)}}static memoize(e,t=JSON.stringify,r=100){const i=new Map,n=(...s)=>{const o=t(s);if(i.has(o))return i.get(o);const l=e(...s);if(i.size>=r){const c=i.keys().next().value;c!==void 0&&i.delete(c)}return i.set(o,l),l};return n.clearCache=()=>i.clear(),n.getCacheSize=()=>i.size,n.getCacheStats=()=>({size:i.size,maxSize:r,keys:Array.from(i.keys())}),n}static startMeasure(e){const t=performance.now();return()=>{const i=performance.now()-t;return console.log(`[Performance] ${e}: ${i.toFixed(2)}ms`),i}}static monitor(e,t){return(...r)=>{const i=this.startMeasure(t);try{const n=e(...r);return i(),n}catch(n){throw i(),n}}}static requestOptimizedFrame(e,t={}){return typeof window.requestIdleCallback=="function"?window.requestIdleCallback(e,{timeout:16,...t}):requestAnimationFrame(()=>{e({didTimeout:!1,timeRemaining:()=>0})})}static cancelOptimizedFrame(e){typeof window.cancelIdleCallback=="function"?window.cancelIdleCallback(e):cancelAnimationFrame(e)}static batchDOMUpdates(e){return new Promise(t=>{requestAnimationFrame(()=>{e(),t()})})}static createFPSMonitor(e,t=60){let r=0,i=performance.now(),n=null;const s=o=>{if(r++,r%t===0){const l=Math.round(t*1e3/(o-i));e(l),i=o}n=requestAnimationFrame(s)};return n=requestAnimationFrame(s),()=>{n!==null&&(cancelAnimationFrame(n),n=null)}}static prefersReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}static getViewportSize(){return{width:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}}static isElementVisible(e,t=0){const r=e.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth;return r.bottom>=t*i&&r.top<=(1-t)*i&&r.right>=t*n&&r.left<=(1-t)*n}static getMemoryInfo(){return performance.memory?{used:Math.round(performance.memory.usedJSHeapSize/1048576),total:Math.round(performance.memory.totalJSHeapSize/1048576),limit:Math.round(performance.memory.jsHeapSizeLimit/1048576)}:null}}function es([a]){const{sharp:e,flat:t}=a.display;return`${e}-${t}`}function ts([a]){const{sharp:e,flat:t}=a.display,{pitchClass:r,degree:i,chromatic:n}=a.rings,s=Math.round(r*1e3)/1e3,o=Math.round(i*1e3)/1e3,l=Math.round(n*1e3)/1e3;return`${e}-${t}-${s}-${o}-${l}`}function jr(a,e,t){try{if(!a||!a.includes("/"))return a||"";const[r,i]=a.split("/");return!r||!i?(console.warn(`Invalid label format: ${a}`),a):e&&t?`${r}/${i}`:e?r:t?i:`${r}/${i}`}catch(r){return E.handle(r,"Logic",()=>{console.warn(`Label processing failed for: ${a}`)}),a||""}}function rs(a){try{const{sharp:e,flat:t}=a.display;if(typeof e!="boolean"||typeof t!="boolean")throw new Error("Invalid display state - sharp/flat must be booleans");const r=Ft.map(n=>jr(n,e,t)),i=zt.map(n=>jr(n,e,t));if(r.length!==12||i.length!==12)throw new Error("Invalid label array lengths");return{chromaticLabels:r,diatonicLabels:i}}catch(e){return E.handle(e,"Logic",()=>{console.warn("Falling back to default labels")}),{chromaticLabels:Ft.slice(),diatonicLabels:zt.slice()}}}const mi=it.memoize(rs,es,50);function is(a){try{const{sharp:e,flat:t}=a.display,{pitchClass:r,degree:i,chromatic:n}=a.rings;if(typeof r!="number"||typeof i!="number"||typeof n!="number")throw new Error("Invalid ring state - angles must be numbers");const s=_=>{if(!_.includes("/"))return _;const[v,T]=_.split("/");return e&&t?_:e?v:t?T:v},o=Ft.map(s),l=z(r-n),c=z(i-n),h=qt(l),d=qt(c);if(h<0||h>=12||d<0||d>=12)throw new Error(`Invalid note indices: root=${h}, mode=${d}`);const f=o[h],g=zt[d],m=gi[g]||null,u=m?Wn[m]:"...";if(!f||!u)throw new Error("Could not determine pitch or mode name");const p=`${f} ${u}`;return{pitch:f,modeName:u,result:p,rootNoteIndex:h,modeDegreeIndex:d,modeKey:m}}catch(e){return E.handle(e,"Logic",()=>{console.warn("Musical result calculation failed")}),{pitch:"C",modeName:"Major",result:"C Major",rootNoteIndex:0,modeDegreeIndex:0,modeKey:"1"}}}const _i=it.memoize(is,ts,100);function ns(a,e){try{if(!a||!e)throw new Error("Invalid state or result element");const t=_i(a);e.textContent!==t.result&&(e.textContent=t.result)}catch(t){E.handle(t,"Logic",()=>{e&&(e.textContent="C Major")})}}function Ko(a){try{const e=_i(a),t=mi(a);return{...e,labels:t,angles:{pitchClass:a.rings.pitchClass,degree:a.rings.degree,chromatic:a.rings.chromatic,effectivePitch:z(a.rings.pitchClass-a.rings.chromatic),effectiveDegree:z(a.rings.degree-a.rings.chromatic)},display:{sharp:a.display.sharp,flat:a.display.flat}}}catch(e){return E.handle(e,"Logic"),null}}function jt(a,e){const t=performance.now(),r=y.animation,i={fromPitchClass:y.rings.pitchClass,fromDegree:y.rings.degree,fromChrom:y.rings.chromatic,fromHighlight:y.rings.highlightPosition},n={toPitchClass:a.pitchClass??(r==null?void 0:r.to.toPitchClass)??i.fromPitchClass,toDegree:a.degree??(r==null?void 0:r.to.toDegree)??i.fromDegree,toChrom:a.chromatic??(r==null?void 0:r.to.toChrom)??i.fromChrom,toHighlight:a.highlightPosition??(r==null?void 0:r.to.toHighlight)??i.fromHighlight};y.animation={t0:t,from:i,to:n,onComplete:e??null}}function ss(a){const e=y.animation;if(!e)return!1;const t=(a-e.t0)/jn,r=t>=1?1:Zn(t),i=(n,s)=>z(n+pi(n,s)*r);return y.rings.pitchClass=i(e.from.fromPitchClass,e.to.toPitchClass),y.rings.degree=i(e.from.fromDegree,e.to.toDegree),y.rings.chromatic=i(e.from.fromChrom,e.to.toChrom),y.rings.highlightPosition=i(e.from.fromHighlight,e.to.toHighlight),r===1&&(e.onComplete&&e.onComplete(),y.animation=null),!0}function yi(a,e){const t=y.rings[a],r=Math.round(-t/X),i=z(-r*X);jt({[a]:i},e)}function dr(a){const{degree:e,chromatic:t}=y.rings,r=z(e-t),i=z(-r)/X;let n=Ht[0],s=1/0;Ht.forEach(c=>{const h=Math.abs(i-c),d=Math.min(h,12-h);d<s&&(s=d,n=c)});const o=z(-n*X),l=z(o+t);jt({degree:l,highlightPosition:l},a)}function bi(a){const e=Math.round(-y.rings.chromatic/X),t=z(-e*X),r=pi(y.rings.chromatic,t),i=z(y.rings.pitchClass+r),n=z(y.rings.degree-y.rings.chromatic),s=z(n+t);jt({pitchClass:i,degree:s,chromatic:t,highlightPosition:s},a)}function vi(){try{if(y.playback.audioContext)return y.playback.audioContext.state==="suspended"?y.playback.audioContext.resume().catch(e=>{E.handle(e,"AudioContext",()=>{y.playback.audioContext=null,vi()})}):Promise.resolve();if(!E.isFeatureSupported("AudioContext"))return console.warn("Web Audio API not supported - audio playback disabled"),Promise.resolve();const a=window.AudioContext||window.webkitAudioContext;return a?(y.playback.audioContext=new a,y.playback.audioContext.addEventListener("statechange",()=>{if(!y.playback.audioContext)return;const e=y.playback.audioContext.state;console.log(`Audio context state changed to: ${e}`),(e==="interrupted"||e==="suspended")&&setTimeout(()=>{var t;((t=y.playback.audioContext)==null?void 0:t.state)==="suspended"&&y.playback.audioContext.resume().catch(r=>{E.handle(r,"AudioContext")})},100)}),y.playback.audioContext.state==="suspended"?y.playback.audioContext.resume().catch(e=>{E.handle(e,"AudioContext",()=>{console.warn("Could not resume audio context - user interaction may be required")})}):Promise.resolve()):Promise.resolve()}catch(a){return E.handle(a,"AudioContext",()=>{console.warn("Audio initialization failed - continuing without audio"),y.playback.audioContext=null}),Promise.resolve()}}function os(a,e){try{const t=y.playback.audioContext;if(!t){console.warn("No audio context available");return}if(t.state==="closed"){console.warn("Audio context is closed");return}if(typeof a!="number"||a<0)throw new Error(`Invalid chromatic index: ${a}`);typeof e!="number"||e<=0;const r=t.createOscillator(),i=t.createGain(),n=a%12,s=Math.floor(a/12),o=Jn*Math.pow(2,n/12+s);if(o<20||o>2e4)throw new Error(`Frequency out of audible range: ${o}Hz`);r.frequency.setValueAtTime(o,t.currentTime),r.type="sine",r.connect(i),i.connect(t.destination);const l=t.currentTime,c=.01,h=Math.min(.1,e*.3);i.gain.setValueAtTime(0,l),i.gain.linearRampToValueAtTime(.3,l+c),i.gain.setValueAtTime(.3,l+e-h),i.gain.linearRampToValueAtTime(0,l+e),r.start(l),r.stop(l+e),r.addEventListener("ended",()=>{try{r.disconnect(),i.disconnect()}catch{}}),r.addEventListener("error",d=>{E.handle(new Error("Oscillator error"),"AudioContext")})}catch(t){E.handle(t,"AudioContext",()=>{console.warn(`Failed to play note ${a} - continuing silently`)})}}function as(){const{pitchClass:a,degree:e,chromatic:t}=y.rings,r=qt(z(a-t)),i=qt(z(e-t)),n=zt[i],s=gi[n];if(!s)return[];const l=Un[s].map(c=>r+c);return l.push(l[0]+12),l}function Ci(){if(!y.playback.isPlaying){Rt();return}const a=y.playback.sequence;if(a.length===0){Rt();return}const e=a.shift();if(e===void 0){Rt();return}y.playback.currentNoteIndex=e,os(e,Xr/1e3);const t=setTimeout(Ci,Xr+Kn);y.playback.timeoutId=t}function ls(){if(y.playback.isPlaying)return;vi();const a=as();a.length!==0&&(y.playback.rootNoteIndexForPlayback=a[0],y.playback.isPlaying=!0,y.playback.sequence=a,Ci())}function Rt(){y.playback.isPlaying&&(clearTimeout(y.playback.timeoutId??void 0),y.playback.isPlaying=!1,y.playback.currentNoteIndex=null,y.playback.sequence=[],y.playback.timeoutId=null,y.playback.rootNoteIndexForPlayback=null)}const ur="diatonicCompassPreferences",wi="diatonicCompassPreferencesBackup";function Kt(a){try{if(!a||typeof a!="object")throw new Error("Invalid preferences object");if(!E.isFeatureSupported("localStorage"))return console.warn("localStorage not available - preferences will not persist"),!1;const t={...Tt()||xt(),...a},r=Er(t),i=JSON.stringify(r);try{localStorage.setItem(wi,localStorage.getItem(ur)||"{}")}catch{console.warn("Could not create preferences backup")}return localStorage.setItem(ur,i),!0}catch(e){return E.handle(e,"LocalStorage",()=>{console.warn("Preferences could not be saved - will use session defaults")}),!1}}function Tt(){try{if(!E.isFeatureSupported("localStorage"))return xt();const a=localStorage.getItem(ur);if(!a)return null;const e=JSON.parse(a),t=Er(e);return JSON.stringify(t)!==a&&(console.log("Preferences were corrected during load - saving updated version"),Kt(t)),t}catch(a){return E.handle(a,"LocalStorage",()=>{const e=cs();if(e)return console.log("Loaded preferences from backup"),e}),xt()}}function cs(){try{const a=localStorage.getItem(wi);if(a){const e=JSON.parse(a);return Er(e)}}catch{console.warn("Could not load backup preferences")}return null}function Er(a){if(!a||typeof a!="object")return xt();const e=xt(),t={...e},r=a;return Object.keys(e).forEach(i=>{if(i in r){const n=r[i],s=typeof e[i];if(typeof n===s)switch(i){case"darkMode":t[i]=!!n;break;case"orientation":t[i]=n==="horizontal"||n==="vertical"?n:e[i];break;case"volume":t[i]=Math.max(0,Math.min(1,Number(n)))||e[i];break;case"tutorialCompleted":t[i]=!!n;break;case"beltOrder":if(Array.isArray(n)){const o=["pitch","degree","intervals","chromatic"];o.every(c=>n.includes(c))&&n.length===o.length?t[i]=[...n]:t[i]=e[i]}else t[i]=e[i];break;case"cursorColor":t[i]=["red","blue","green","yellow"].includes(String(n))?n:e[i];break;case"cursorFill":t[i]=!!n;break;default:t[i]=n}else console.warn(`Invalid type for preference ${String(i)}: expected ${s}, got ${typeof n}`),t[i]=e[i]}else t[i]=e[i]}),"layoutOrder"in r&&typeof r.layoutOrder=="object"&&r.layoutOrder!==null&&(t.layoutOrder=r.layoutOrder),t}function xt(){return{darkMode:!1,orientation:"horizontal",volume:.5,tutorialCompleted:!1,showAdvancedControls:!1,beltOrder:["pitch","degree","intervals","chromatic"],cursorColor:"red",cursorFill:!1}}const Ti=Object.freeze(Object.defineProperty({__proto__:null,loadPreferences:Tt,savePreferences:Kt},Symbol.toStringTag,{value:"Module"})),J={toggleAccidental(a){try{if(!["sharp","flat"].includes(a))throw new Error(`Invalid accidental type: ${a}`);const t=!y.display[a],r=a==="sharp"?"flat":"sharp",i=y.display[r];!t&&!i&&(y.display[r]=!0),y.display[a]=t}catch(e){E.handle(e,Q.ERROR_HANDLING.CONTEXTS.UI)}},toggleDarkMode(){try{const a=!y.ui.darkMode;y.ui.darkMode=a,document.body.classList.toggle("dark-mode",a),Kt({darkMode:a})}catch(a){E.handle(a,Q.ERROR_HANDLING.CONTEXTS.UI,()=>{document.body.classList.toggle("dark-mode")})}},togglePlayback(){try{y.playback.isPlaying?Rt():!y.drag.active&&!y.animation&&ls()}catch(a){E.handle(a,Q.ERROR_HANDLING.CONTEXTS.AUDIO)}},toggleSidebar(a){try{const e=typeof a=="boolean"?a:!y.ui.sidebarOpen;y.ui.sidebarOpen=e,y.performance&&(y.performance.needsRedraw=!0)}catch(e){E.handle(e,Q.ERROR_HANDLING.CONTEXTS.UI)}},setOrientation(a){try{if(!["horizontal","vertical"].includes(a))throw new Error(`Invalid orientation: ${a}`);if(y.belts.orientation===a)return;y.belts.orientation=a,y.rings.pitchClass=0,y.rings.degree=0,y.rings.chromatic=0,y.rings.highlightPosition=0,y.belts.init=!1;const e=document.querySelector(".main-container");e&&e.classList.toggle("vertical-layout",a==="vertical")}catch(e){E.handle(e,Q.ERROR_HANDLING.CONTEXTS.UI)}},snapTo(a,e){try{jt(a,e)}catch(t){E.handle(t,Q.ERROR_HANDLING.CONTEXTS.ANIMATION)}},setRingAngle(a,e){try{if(!["pitchClass","degree","chromatic","highlightPosition"].includes(a))throw new Error(`Invalid ring name: ${a}`);if(typeof e!="number"||!isFinite(e))throw new Error(`Invalid angle value: ${e}`);y.rings[a]=e}catch(t){E.handle(t,Q.ERROR_HANDLING.CONTEXTS.UI)}},setCursorColor(a,e){try{if(!["red","blue","green","yellow"].includes(a))throw new Error(`Invalid cursor color: ${a}`);y.ui.cursorColor=a,y.ui.cursorFill=e,Ze(async()=>{const{savePreferences:r}=await Promise.resolve().then(()=>Ti);return{savePreferences:r}},void 0).then(({savePreferences:r})=>{r({cursorColor:a,cursorFill:e})}),y.performance&&(y.performance.needsRedraw=!0)}catch(t){E.handle(t,Q.ERROR_HANDLING.CONTEXTS.UI)}},resetRings(){try{y.rings.pitchClass=0,y.rings.degree=0,y.rings.chromatic=0,y.rings.highlightPosition=0}catch(a){E.handle(a,Q.ERROR_HANDLING.CONTEXTS.UI)}},getStateSummary(){try{return{rings:{...y.rings},ui:{sidebarOpen:y.ui.sidebarOpen,darkMode:y.ui.darkMode,display:{sharp:y.display.sharp,flat:y.display.flat}},belts:{orientation:y.belts.orientation,init:y.belts.init},playback:{isPlaying:y.playback.isPlaying},interaction:{isDragging:!!y.drag.active,isAnimating:!!y.animation}}}catch(a){return E.handle(a,Q.ERROR_HANDLING.CONTEXTS.APP),null}}};function Ee(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function xi(a,e){a.prototype=Object.create(e.prototype),a.prototype.constructor=a,a.__proto__=e}/*!
 * GSAP 3.14.2
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var ue={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ct={duration:.5,overwrite:!1,delay:0},Or,Z,q,me=1e8,F=1/me,fr=Math.PI*2,hs=fr/4,ds=0,Si=Math.sqrt,us=Math.cos,fs=Math.sin,K=function(e){return typeof e=="string"},V=function(e){return typeof e=="function"},Ae=function(e){return typeof e=="number"},Ar=function(e){return typeof e>"u"},xe=function(e){return typeof e=="object"},ie=function(e){return e!==!1},Ir=function(){return typeof window<"u"},Mt=function(e){return V(e)||K(e)},ki=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},te=Array.isArray,gs=/random\([^)]+\)/g,ps=/,\s*/g,Kr=/(?:-?\.?\d|\.)+/gi,Ei=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,nt=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,er=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Oi=/[+-]=-?[.\d]+/,ms=/[^,'"\[\]\s]+/gi,_s=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,U,Ce,gr,Pr,fe={},$t={},Ai,Ii=function(e){return($t=ht(e,fe))&&ae},Dr=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},St=function(e,t){return!t&&console.warn(e)},Pi=function(e,t){return e&&(fe[e]=t)&&$t&&($t[e]=t)||fe},kt=function(){return 0},ys={suppressEvents:!0,isStart:!0,kill:!1},Lt={suppressEvents:!0,kill:!1},bs={suppressEvents:!0},Mr={},Be=[],pr={},Di,le={},tr={},Jr=30,Nt=[],Rr="",Lr=function(e){var t=e[0],r,i;if(xe(t)||V(t)||(e=[e]),!(r=(t._gsap||{}).harness)){for(i=Nt.length;i--&&!Nt[i].targetTest(t););r=Nt[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new rn(e[i],r)))||e.splice(i,1);return e},je=function(e){return e._gsap||Lr(_e(e))[0]._gsap},Mi=function(e,t,r){return(r=e[t])&&V(r)?e[t]():Ar(r)&&e.getAttribute&&e.getAttribute(t)||r},ne=function(e,t){return(e=e.split(",")).forEach(t)||e},Y=function(e){return Math.round(e*1e5)/1e5||0},$=function(e){return Math.round(e*1e7)/1e7||0},ot=function(e,t){var r=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),r==="+"?e+i:r==="-"?e-i:r==="*"?e*i:e/i},vs=function(e,t){for(var r=t.length,i=0;e.indexOf(t[i])<0&&++i<r;);return i<r},Ut=function(){var e=Be.length,t=Be.slice(0),r,i;for(pr={},Be.length=0,r=0;r<e;r++)i=t[r],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},Nr=function(e){return!!(e._initted||e._startAt||e.add)},Ri=function(e,t,r,i){Be.length&&!Z&&Ut(),e.render(t,r,!!(Z&&t<0&&Nr(e))),Be.length&&!Z&&Ut()},Li=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(ms).length<2?t:K(e)?e.trim():e},Ni=function(e){return e},ge=function(e,t){for(var r in t)r in e||(e[r]=t[r]);return e},Cs=function(e){return function(t,r){for(var i in r)i in t||i==="duration"&&e||i==="ease"||(t[i]=r[i])}},ht=function(e,t){for(var r in t)e[r]=t[r];return e},Qr=function a(e,t){for(var r in t)r!=="__proto__"&&r!=="constructor"&&r!=="prototype"&&(e[r]=xe(t[r])?a(e[r]||(e[r]={}),t[r]):t[r]);return e},Wt=function(e,t){var r={},i;for(i in e)i in t||(r[i]=e[i]);return r},vt=function(e){var t=e.parent||U,r=e.keyframes?Cs(te(e.keyframes)):ge;if(ie(e.inherit))for(;t;)r(e,t.vars.defaults),t=t.parent||t._dp;return e},ws=function(e,t){for(var r=e.length,i=r===t.length;i&&r--&&e[r]===t[r];);return r<0},Bi=function(e,t,r,i,n){var s=e[i],o;if(n)for(o=t[n];s&&s[n]>o;)s=s._prev;return s?(t._next=s._next,s._next=t):(t._next=e[r],e[r]=t),t._next?t._next._prev=t:e[i]=t,t._prev=s,t.parent=t._dp=e,t},Jt=function(e,t,r,i){r===void 0&&(r="_first"),i===void 0&&(i="_last");var n=t._prev,s=t._next;n?n._next=s:e[r]===t&&(e[r]=s),s?s._prev=n:e[i]===t&&(e[i]=n),t._next=t._prev=t.parent=null},ze=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Ke=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var r=e;r;)r._dirty=1,r=r.parent;return e},Ts=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},mr=function(e,t,r,i){return e._startAt&&(Z?e._startAt.revert(Lt):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},xs=function a(e){return!e||e._ts&&a(e.parent)},Zr=function(e){return e._repeat?dt(e._tTime,e=e.duration()+e._rDelay)*e:0},dt=function(e,t){var r=Math.floor(e=$(e/t));return e&&r===e?r-1:r},Vt=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Qt=function(e){return e._end=$(e._start+(e._tDur/Math.abs(e._ts||e._rts||F)||0))},Zt=function(e,t){var r=e._dp;return r&&r.smoothChildTiming&&e._ts&&(e._start=$(r._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Qt(e),r._dirty||Ke(r,e)),e},Fi=function(e,t){var r;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(r=Vt(e.rawTime(),t),(!t._dur||Dt(0,t.totalDuration(),r)-t._tTime>F)&&t.render(r,!0)),Ke(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(r=e;r._dp;)r.rawTime()>=0&&r.totalTime(r._tTime),r=r._dp;e._zTime=-F}},we=function(e,t,r,i){return t.parent&&ze(t),t._start=$((Ae(r)?r:r||e!==U?pe(e,r,t):e._time)+t._delay),t._end=$(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Bi(e,t,"_first","_last",e._sort?"_start":0),_r(t)||(e._recent=t),i||Fi(e,t),e._ts<0&&Zt(e,e._tTime),e},zi=function(e,t){return(fe.ScrollTrigger||Dr("scrollTrigger",t))&&fe.ScrollTrigger.create(t,e)},Hi=function(e,t,r,i,n){if(Fr(e,t,n),!e._initted)return 1;if(!r&&e._pt&&!Z&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&Di!==ce.frame)return Be.push(e),e._lazy=[n,i],1},Ss=function a(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||a(t))},_r=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},ks=function(e,t,r,i){var n=e.ratio,s=t<0||!t&&(!e._start&&Ss(e)&&!(!e._initted&&_r(e))||(e._ts<0||e._dp._ts<0)&&!_r(e))?0:1,o=e._rDelay,l=0,c,h,d;if(o&&e._repeat&&(l=Dt(0,e._tDur,t),h=dt(l,o),e._yoyo&&h&1&&(s=1-s),h!==dt(e._tTime,o)&&(n=1-s,e.vars.repeatRefresh&&e._initted&&e.invalidate())),s!==n||Z||i||e._zTime===F||!t&&e._zTime){if(!e._initted&&Hi(e,t,i,r,l))return;for(d=e._zTime,e._zTime=t||(r?F:0),r||(r=t&&!d),e.ratio=s,e._from&&(s=1-s),e._time=0,e._tTime=l,c=e._pt;c;)c.r(s,c.d),c=c._next;t<0&&mr(e,t,r,!0),e._onUpdate&&!r&&he(e,"onUpdate"),l&&e._repeat&&!r&&e.parent&&he(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===s&&(s&&ze(e,1),!r&&!Z&&(he(e,s?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},Es=function(e,t,r){var i;if(r>t)for(i=e._first;i&&i._start<=r;){if(i.data==="isPause"&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=r;){if(i.data==="isPause"&&i._start<t)return i;i=i._prev}},ut=function(e,t,r,i){var n=e._repeat,s=$(t)||0,o=e._tTime/e._tDur;return o&&!i&&(e._time*=s/e._dur),e._dur=s,e._tDur=n?n<0?1e10:$(s*(n+1)+e._rDelay*n):s,o>0&&!i&&Zt(e,e._tTime=e._tDur*o),e.parent&&Qt(e),r||Ke(e.parent,e),e},ei=function(e){return e instanceof re?Ke(e):ut(e,e._dur)},Os={_start:0,endTime:kt,totalDuration:kt},pe=function a(e,t,r){var i=e.labels,n=e._recent||Os,s=e.duration()>=me?n.endTime(!1):e._dur,o,l,c;return K(t)&&(isNaN(t)||t in i)?(l=t.charAt(0),c=t.substr(-1)==="%",o=t.indexOf("="),l==="<"||l===">"?(o>=0&&(t=t.replace(/=/,"")),(l==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(o<0?n:r).totalDuration()/100:1)):o<0?(t in i||(i[t]=s),i[t]):(l=parseFloat(t.charAt(o-1)+t.substr(o+1)),c&&r&&(l=l/100*(te(r)?r[0]:r).totalDuration()),o>1?a(e,t.substr(0,o-1),r)+l:s+l)):t==null?s:+t},Ct=function(e,t,r){var i=Ae(t[1]),n=(i?2:1)+(e<2?0:1),s=t[n],o,l;if(i&&(s.duration=t[1]),s.parent=r,e){for(o=s,l=r;l&&!("immediateRender"in o);)o=l.vars.defaults||{},l=ie(l.vars.inherit)&&l.parent;s.immediateRender=ie(o.immediateRender),e<2?s.runBackwards=1:s.startAt=t[n-1]}return new G(t[0],s,t[n+1])},$e=function(e,t){return e||e===0?t(e):t},Dt=function(e,t,r){return r<e?e:r>t?t:r},ee=function(e,t){return!K(e)||!(t=_s.exec(e))?"":t[1]},As=function(e,t,r){return $e(r,function(i){return Dt(e,t,i)})},yr=[].slice,qi=function(e,t){return e&&xe(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&xe(e[0]))&&!e.nodeType&&e!==Ce},Is=function(e,t,r){return r===void 0&&(r=[]),e.forEach(function(i){var n;return K(i)&&!t||qi(i,1)?(n=r).push.apply(n,_e(i)):r.push(i)})||r},_e=function(e,t,r){return q&&!t&&q.selector?q.selector(e):K(e)&&!r&&(gr||!ft())?yr.call((t||Pr).querySelectorAll(e),0):te(e)?Is(e,r):qi(e)?yr.call(e,0):e?[e]:[]},br=function(e){return e=_e(e)[0]||St("Invalid scope")||{},function(t){var r=e.current||e.nativeElement||e;return _e(t,r.querySelectorAll?r:r===e?St("Invalid scope")||Pr.createElement("div"):e)}},$i=function(e){return e.sort(function(){return .5-Math.random()})},Ui=function(e){if(V(e))return e;var t=xe(e)?e:{each:e},r=Je(t.ease),i=t.from||0,n=parseFloat(t.base)||0,s={},o=i>0&&i<1,l=isNaN(i)||o,c=t.axis,h=i,d=i;return K(i)?h=d={center:.5,edges:.5,end:1}[i]||0:!o&&l&&(h=i[0],d=i[1]),function(f,g,m){var u=(m||t).length,p=s[u],_,v,T,C,b,k,x,S,w;if(!p){if(w=t.grid==="auto"?0:(t.grid||[1,me])[1],!w){for(x=-me;x<(x=m[w++].getBoundingClientRect().left)&&w<u;);w<u&&w--}for(p=s[u]=[],_=l?Math.min(w,u)*h-.5:i%w,v=w===me?0:l?u*d/w-.5:i/w|0,x=0,S=me,k=0;k<u;k++)T=k%w-_,C=v-(k/w|0),p[k]=b=c?Math.abs(c==="y"?C:T):Si(T*T+C*C),b>x&&(x=b),b<S&&(S=b);i==="random"&&$i(p),p.max=x-S,p.min=S,p.v=u=(parseFloat(t.amount)||parseFloat(t.each)*(w>u?u-1:c?c==="y"?u/w:w:Math.max(w,u/w))||0)*(i==="edges"?-1:1),p.b=u<0?n-u:n,p.u=ee(t.amount||t.each)||0,r=r&&u<0?Zi(r):r}return u=(p[f]-p.min)/p.max||0,$(p.b+(r?r(u):u)*p.v)+p.u}},vr=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(r){var i=$(Math.round(parseFloat(r)/e)*e*t);return(i-i%1)/t+(Ae(r)?0:ee(r))}},Wi=function(e,t){var r=te(e),i,n;return!r&&xe(e)&&(i=r=e.radius||me,e.values?(e=_e(e.values),(n=!Ae(e[0]))&&(i*=i)):e=vr(e.increment)),$e(t,r?V(e)?function(s){return n=e(s),Math.abs(n-s)<=i?n:s}:function(s){for(var o=parseFloat(n?s.x:s),l=parseFloat(n?s.y:0),c=me,h=0,d=e.length,f,g;d--;)n?(f=e[d].x-o,g=e[d].y-l,f=f*f+g*g):f=Math.abs(e[d]-o),f<c&&(c=f,h=d);return h=!i||c<=i?e[h]:s,n||h===s||Ae(s)?h:h+ee(s)}:vr(e))},Vi=function(e,t,r,i){return $e(te(e)?!t:r===!0?!!(r=0):!i,function(){return te(e)?e[~~(Math.random()*e.length)]:(r=r||1e-5)&&(i=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((e-r/2+Math.random()*(t-e+r*.99))/r)*r*i)/i})},Ps=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return t.reduce(function(n,s){return s(n)},i)}},Ds=function(e,t){return function(r){return e(parseFloat(r))+(t||ee(r))}},Ms=function(e,t,r){return Gi(e,t,0,1,r)},Yi=function(e,t,r){return $e(r,function(i){return e[~~t(i)]})},Rs=function a(e,t,r){var i=t-e;return te(e)?Yi(e,a(0,e.length),t):$e(r,function(n){return(i+(n-e)%i)%i+e})},Ls=function a(e,t,r){var i=t-e,n=i*2;return te(e)?Yi(e,a(0,e.length-1),t):$e(r,function(s){return s=(n+(s-e)%n)%n||0,e+(s>i?n-s:s)})},Et=function(e){return e.replace(gs,function(t){var r=t.indexOf("[")+1,i=t.substring(r||7,r?t.indexOf("]"):t.length-1).split(ps);return Vi(r?i:+i[0],r?0:+i[1],+i[2]||1e-5)})},Gi=function(e,t,r,i,n){var s=t-e,o=i-r;return $e(n,function(l){return r+((l-e)/s*o||0)})},Ns=function a(e,t,r,i){var n=isNaN(e+t)?0:function(g){return(1-g)*e+g*t};if(!n){var s=K(e),o={},l,c,h,d,f;if(r===!0&&(i=1)&&(r=null),s)e={p:e},t={p:t};else if(te(e)&&!te(t)){for(h=[],d=e.length,f=d-2,c=1;c<d;c++)h.push(a(e[c-1],e[c]));d--,n=function(m){m*=d;var u=Math.min(f,~~m);return h[u](m-u)},r=t}else i||(e=ht(te(e)?[]:{},e));if(!h){for(l in t)Br.call(o,e,l,"get",t[l]);n=function(m){return qr(m,o)||(s?e.p:e)}}}return $e(r,n)},ti=function(e,t,r){var i=e.labels,n=me,s,o,l;for(s in i)o=i[s]-t,o<0==!!r&&o&&n>(o=Math.abs(o))&&(l=s,n=o);return l},he=function(e,t,r){var i=e.vars,n=i[t],s=q,o=e._ctx,l,c,h;if(n)return l=i[t+"Params"],c=i.callbackScope||e,r&&Be.length&&Ut(),o&&(q=o),h=l?n.apply(c,l):n.call(c),q=s,h},yt=function(e){return ze(e),e.scrollTrigger&&e.scrollTrigger.kill(!!Z),e.progress()<1&&he(e,"onInterrupt"),e},st,Xi=[],ji=function(e){if(e)if(e=!e.name&&e.default||e,Ir()||e.headless){var t=e.name,r=V(e),i=t&&!r&&e.init?function(){this._props=[]}:e,n={init:kt,render:qr,add:Br,kill:Qs,modifier:Js,rawVars:0},s={targetTest:0,get:0,getSetter:Hr,aliases:{},register:0};if(ft(),e!==i){if(le[t])return;ge(i,ge(Wt(e,n),s)),ht(i.prototype,ht(n,Wt(e,s))),le[i.prop=t]=i,e.targetTest&&(Nt.push(i),Mr[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Pi(t,i),e.register&&e.register(ae,i,se)}else Xi.push(e)},B=255,bt={aqua:[0,B,B],lime:[0,B,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,B],navy:[0,0,128],white:[B,B,B],olive:[128,128,0],yellow:[B,B,0],orange:[B,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[B,0,0],pink:[B,192,203],cyan:[0,B,B],transparent:[B,B,B,0]},rr=function(e,t,r){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(r-t)*e*6:e<.5?r:e*3<2?t+(r-t)*(2/3-e)*6:t)*B+.5|0},Ki=function(e,t,r){var i=e?Ae(e)?[e>>16,e>>8&B,e&B]:0:bt.black,n,s,o,l,c,h,d,f,g,m;if(!i){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),bt[e])i=bt[e];else if(e.charAt(0)==="#"){if(e.length<6&&(n=e.charAt(1),s=e.charAt(2),o=e.charAt(3),e="#"+n+n+s+s+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return i=parseInt(e.substr(1,6),16),[i>>16,i>>8&B,i&B,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),i=[e>>16,e>>8&B,e&B]}else if(e.substr(0,3)==="hsl"){if(i=m=e.match(Kr),!t)l=+i[0]%360/360,c=+i[1]/100,h=+i[2]/100,s=h<=.5?h*(c+1):h+c-h*c,n=h*2-s,i.length>3&&(i[3]*=1),i[0]=rr(l+1/3,n,s),i[1]=rr(l,n,s),i[2]=rr(l-1/3,n,s);else if(~e.indexOf("="))return i=e.match(Ei),r&&i.length<4&&(i[3]=1),i}else i=e.match(Kr)||bt.transparent;i=i.map(Number)}return t&&!m&&(n=i[0]/B,s=i[1]/B,o=i[2]/B,d=Math.max(n,s,o),f=Math.min(n,s,o),h=(d+f)/2,d===f?l=c=0:(g=d-f,c=h>.5?g/(2-d-f):g/(d+f),l=d===n?(s-o)/g+(s<o?6:0):d===s?(o-n)/g+2:(n-s)/g+4,l*=60),i[0]=~~(l+.5),i[1]=~~(c*100+.5),i[2]=~~(h*100+.5)),r&&i.length<4&&(i[3]=1),i},Ji=function(e){var t=[],r=[],i=-1;return e.split(Fe).forEach(function(n){var s=n.match(nt)||[];t.push.apply(t,s),r.push(i+=s.length+1)}),t.c=r,t},ri=function(e,t,r){var i="",n=(e+i).match(Fe),s=t?"hsla(":"rgba(",o=0,l,c,h,d;if(!n)return e;if(n=n.map(function(f){return(f=Ki(f,t,1))&&s+(t?f[0]+","+f[1]+"%,"+f[2]+"%,"+f[3]:f.join(","))+")"}),r&&(h=Ji(e),l=r.c,l.join(i)!==h.c.join(i)))for(c=e.replace(Fe,"1").split(nt),d=c.length-1;o<d;o++)i+=c[o]+(~l.indexOf(o)?n.shift()||s+"0,0,0,0)":(h.length?h:n.length?n:r).shift());if(!c)for(c=e.split(Fe),d=c.length-1;o<d;o++)i+=c[o]+n[o];return i+c[d]},Fe=(function(){var a="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in bt)a+="|"+e+"\\b";return new RegExp(a+")","gi")})(),Bs=/hsl[a]?\(/,Qi=function(e){var t=e.join(" "),r;if(Fe.lastIndex=0,Fe.test(t))return r=Bs.test(t),e[1]=ri(e[1],r),e[0]=ri(e[0],r,Ji(e[1])),!0},Ot,ce=(function(){var a=Date.now,e=500,t=33,r=a(),i=r,n=1e3/240,s=n,o=[],l,c,h,d,f,g,m=function u(p){var _=a()-i,v=p===!0,T,C,b,k;if((_>e||_<0)&&(r+=_-t),i+=_,b=i-r,T=b-s,(T>0||v)&&(k=++d.frame,f=b-d.time*1e3,d.time=b=b/1e3,s+=T+(T>=n?4:n-T),C=1),v||(l=c(u)),C)for(g=0;g<o.length;g++)o[g](b,f,k,p)};return d={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(p){return f/(1e3/(p||60))},wake:function(){Ai&&(!gr&&Ir()&&(Ce=gr=window,Pr=Ce.document||{},fe.gsap=ae,(Ce.gsapVersions||(Ce.gsapVersions=[])).push(ae.version),Ii($t||Ce.GreenSockGlobals||!Ce.gsap&&Ce||{}),Xi.forEach(ji)),h=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&d.sleep(),c=h||function(p){return setTimeout(p,s-d.time*1e3+1|0)},Ot=1,m(2))},sleep:function(){(h?cancelAnimationFrame:clearTimeout)(l),Ot=0,c=kt},lagSmoothing:function(p,_){e=p||1/0,t=Math.min(_||33,e)},fps:function(p){n=1e3/(p||240),s=d.time*1e3+n},add:function(p,_,v){var T=_?function(C,b,k,x){p(C,b,k,x),d.remove(T)}:p;return d.remove(p),o[v?"unshift":"push"](T),ft(),T},remove:function(p,_){~(_=o.indexOf(p))&&o.splice(_,1)&&g>=_&&g--},_listeners:o},d})(),ft=function(){return!Ot&&ce.wake()},I={},Fs=/^[\d.\-M][\d.\-,\s]/,zs=/["']/g,Hs=function(e){for(var t={},r=e.substr(1,e.length-3).split(":"),i=r[0],n=1,s=r.length,o,l,c;n<s;n++)l=r[n],o=n!==s-1?l.lastIndexOf(","):l.length,c=l.substr(0,o),t[i]=isNaN(c)?c.replace(zs,"").trim():+c,i=l.substr(o+1).trim();return t},qs=function(e){var t=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<r?e.indexOf(")",r+1):r)},$s=function(e){var t=(e+"").split("("),r=I[t[0]];return r&&t.length>1&&r.config?r.config.apply(null,~e.indexOf("{")?[Hs(t[1])]:qs(e).split(",").map(Li)):I._CE&&Fs.test(e)?I._CE("",e):r},Zi=function(e){return function(t){return 1-e(1-t)}},en=function a(e,t){for(var r=e._first,i;r;)r instanceof re?a(r,t):r.vars.yoyoEase&&(!r._yoyo||!r._repeat)&&r._yoyo!==t&&(r.timeline?a(r.timeline,t):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=t)),r=r._next},Je=function(e,t){return e&&(V(e)?e:I[e]||$s(e))||t},tt=function(e,t,r,i){r===void 0&&(r=function(l){return 1-t(1-l)}),i===void 0&&(i=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var n={easeIn:t,easeOut:r,easeInOut:i},s;return ne(e,function(o){I[o]=fe[o]=n,I[s=o.toLowerCase()]=r;for(var l in n)I[s+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=I[o+"."+l]=n[l]}),n},tn=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},ir=function a(e,t,r){var i=t>=1?t:1,n=(r||(e?.3:.45))/(t<1?t:1),s=n/fr*(Math.asin(1/i)||0),o=function(h){return h===1?1:i*Math.pow(2,-10*h)*fs((h-s)*n)+1},l=e==="out"?o:e==="in"?function(c){return 1-o(1-c)}:tn(o);return n=fr/n,l.config=function(c,h){return a(e,c,h)},l},nr=function a(e,t){t===void 0&&(t=1.70158);var r=function(s){return s?--s*s*((t+1)*s+t)+1:0},i=e==="out"?r:e==="in"?function(n){return 1-r(1-n)}:tn(r);return i.config=function(n){return a(e,n)},i};ne("Linear,Quad,Cubic,Quart,Quint,Strong",function(a,e){var t=e<5?e+1:e;tt(a+",Power"+(t-1),e?function(r){return Math.pow(r,t)}:function(r){return r},function(r){return 1-Math.pow(1-r,t)},function(r){return r<.5?Math.pow(r*2,t)/2:1-Math.pow((1-r)*2,t)/2})});I.Linear.easeNone=I.none=I.Linear.easeIn;tt("Elastic",ir("in"),ir("out"),ir());(function(a,e){var t=1/e,r=2*t,i=2.5*t,n=function(o){return o<t?a*o*o:o<r?a*Math.pow(o-1.5/e,2)+.75:o<i?a*(o-=2.25/e)*o+.9375:a*Math.pow(o-2.625/e,2)+.984375};tt("Bounce",function(s){return 1-n(1-s)},n)})(7.5625,2.75);tt("Expo",function(a){return Math.pow(2,10*(a-1))*a+a*a*a*a*a*a*(1-a)});tt("Circ",function(a){return-(Si(1-a*a)-1)});tt("Sine",function(a){return a===1?1:-us(a*hs)+1});tt("Back",nr("in"),nr("out"),nr());I.SteppedEase=I.steps=fe.SteppedEase={config:function(e,t){e===void 0&&(e=1);var r=1/e,i=e+(t?0:1),n=t?1:0,s=1-F;return function(o){return((i*Dt(0,s,o)|0)+n)*r}}};ct.ease=I["quad.out"];ne("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(a){return Rr+=a+","+a+"Params,"});var rn=function(e,t){this.id=ds++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:Mi,this.set=t?t.getSetter:Hr},At=(function(){function a(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,ut(this,+t.duration,1,1),this.data=t.data,q&&(this._ctx=q,q.data.push(this)),Ot||ce.wake()}var e=a.prototype;return e.delay=function(r){return r||r===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+r-this._delay),this._delay=r,this):this._delay},e.duration=function(r){return arguments.length?this.totalDuration(this._repeat>0?r+(r+this._rDelay)*this._repeat:r):this.totalDuration()&&this._dur},e.totalDuration=function(r){return arguments.length?(this._dirty=0,ut(this,this._repeat<0?r:(r-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(r,i){if(ft(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Zt(this,r),!n._dp||n.parent||Fi(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&r<this._tDur||this._ts<0&&r>0||!this._tDur&&!r)&&we(this._dp,this,this._start-this._delay)}return(this._tTime!==r||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===F||!this._initted&&this._dur&&r||!r&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=r),Ri(this,r,i)),this},e.time=function(r,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),r+Zr(this))%(this._dur+this._rDelay)||(r?this._dur:0),i):this._time},e.totalProgress=function(r,i){return arguments.length?this.totalTime(this.totalDuration()*r,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(r,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-r:r)+Zr(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(r,i){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(r-1)*n,i):this._repeat?dt(this._tTime,n)+1:1},e.timeScale=function(r,i){if(!arguments.length)return this._rts===-F?0:this._rts;if(this._rts===r)return this;var n=this.parent&&this._ts?Vt(this.parent._time,this):this._tTime;return this._rts=+r||0,this._ts=this._ps||r===-F?0:this._rts,this.totalTime(Dt(-Math.abs(this._delay),this.totalDuration(),n),i!==!1),Qt(this),Ts(this)},e.paused=function(r){return arguments.length?(this._ps!==r&&(this._ps=r,r?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ft(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==F&&(this._tTime-=F)))),this):this._ps},e.startTime=function(r){if(arguments.length){this._start=$(r);var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&we(i,this,this._start-this._delay),this}return this._start},e.endTime=function(r){return this._start+(ie(r)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(r){var i=this.parent||this._dp;return i?r&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Vt(i.rawTime(r),this):this._tTime:this._tTime},e.revert=function(r){r===void 0&&(r=bs);var i=Z;return Z=r,Nr(this)&&(this.timeline&&this.timeline.revert(r),this.totalTime(-.01,r.suppressEvents)),this.data!=="nested"&&r.kill!==!1&&this.kill(),Z=i,this},e.globalTime=function(r){for(var i=this,n=arguments.length?r:i.rawTime();i;)n=i._start+n/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(r):n},e.repeat=function(r){return arguments.length?(this._repeat=r===1/0?-2:r,ei(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(r){if(arguments.length){var i=this._time;return this._rDelay=r,ei(this),i?this.time(i):this}return this._rDelay},e.yoyo=function(r){return arguments.length?(this._yoyo=r,this):this._yoyo},e.seek=function(r,i){return this.totalTime(pe(this,r),ie(i))},e.restart=function(r,i){return this.play().totalTime(r?-this._delay:0,ie(i)),this._dur||(this._zTime=-F),this},e.play=function(r,i){return r!=null&&this.seek(r,i),this.reversed(!1).paused(!1)},e.reverse=function(r,i){return r!=null&&this.seek(r||this.totalDuration(),i),this.reversed(!0).paused(!1)},e.pause=function(r,i){return r!=null&&this.seek(r,i),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(r){return arguments.length?(!!r!==this.reversed()&&this.timeScale(-this._rts||(r?-F:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-F,this},e.isActive=function(){var r=this.parent||this._dp,i=this._start,n;return!!(!r||this._ts&&this._initted&&r.isActive()&&(n=r.rawTime(!0))>=i&&n<this.endTime(!0)-F)},e.eventCallback=function(r,i,n){var s=this.vars;return arguments.length>1?(i?(s[r]=i,n&&(s[r+"Params"]=n),r==="onUpdate"&&(this._onUpdate=i)):delete s[r],this):s[r]},e.then=function(r){var i=this,n=i._prom;return new Promise(function(s){var o=V(r)?r:Ni,l=function(){var h=i.then;i.then=null,n&&n(),V(o)&&(o=o(i))&&(o.then||o===i)&&(i.then=h),s(o),i.then=h};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?l():i._prom=l})},e.kill=function(){yt(this)},a})();ge(At.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-F,_prom:0,_ps:!1,_rts:1});var re=(function(a){xi(e,a);function e(r,i){var n;return r===void 0&&(r={}),n=a.call(this,r)||this,n.labels={},n.smoothChildTiming=!!r.smoothChildTiming,n.autoRemoveChildren=!!r.autoRemoveChildren,n._sort=ie(r.sortChildren),U&&we(r.parent||U,Ee(n),i),r.reversed&&n.reverse(),r.paused&&n.paused(!0),r.scrollTrigger&&zi(Ee(n),r.scrollTrigger),n}var t=e.prototype;return t.to=function(i,n,s){return Ct(0,arguments,this),this},t.from=function(i,n,s){return Ct(1,arguments,this),this},t.fromTo=function(i,n,s,o){return Ct(2,arguments,this),this},t.set=function(i,n,s){return n.duration=0,n.parent=this,vt(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new G(i,n,pe(this,s),1),this},t.call=function(i,n,s){return we(this,G.delayedCall(0,i,n),s)},t.staggerTo=function(i,n,s,o,l,c,h){return s.duration=n,s.stagger=s.stagger||o,s.onComplete=c,s.onCompleteParams=h,s.parent=this,new G(i,s,pe(this,l)),this},t.staggerFrom=function(i,n,s,o,l,c,h){return s.runBackwards=1,vt(s).immediateRender=ie(s.immediateRender),this.staggerTo(i,n,s,o,l,c,h)},t.staggerFromTo=function(i,n,s,o,l,c,h,d){return o.startAt=s,vt(o).immediateRender=ie(o.immediateRender),this.staggerTo(i,n,o,l,c,h,d)},t.render=function(i,n,s){var o=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,h=i<=0?0:$(i),d=this._zTime<0!=i<0&&(this._initted||!c),f,g,m,u,p,_,v,T,C,b,k,x;if(this!==U&&h>l&&i>=0&&(h=l),h!==this._tTime||s||d){if(o!==this._time&&c&&(h+=this._time-o,i+=this._time-o),f=h,C=this._start,T=this._ts,_=!T,d&&(c||(o=this._zTime),(i||!n)&&(this._zTime=i)),this._repeat){if(k=this._yoyo,p=c+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(p*100+i,n,s);if(f=$(h%p),h===l?(u=this._repeat,f=c):(b=$(h/p),u=~~b,u&&u===b&&(f=c,u--),f>c&&(f=c)),b=dt(this._tTime,p),!o&&this._tTime&&b!==u&&this._tTime-b*p-this._dur<=0&&(b=u),k&&u&1&&(f=c-f,x=1),u!==b&&!this._lock){var S=k&&b&1,w=S===(k&&u&1);if(u<b&&(S=!S),o=S?0:h%c?c:h,this._lock=1,this.render(o||(x?0:$(u*p)),n,!c)._lock=0,this._tTime=h,!n&&this.parent&&he(this,"onRepeat"),this.vars.repeatRefresh&&!x&&(this.invalidate()._lock=1,b=u),o&&o!==this._time||_!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,w&&(this._lock=2,o=S?c:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!x&&this.invalidate()),this._lock=0,!this._ts&&!_)return this;en(this,x)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(v=Es(this,$(o),$(f)),v&&(h-=f-(f=v._start))),this._tTime=h,this._time=f,this._act=!T,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,o=0),!o&&h&&c&&!n&&!b&&(he(this,"onStart"),this._tTime!==h))return this;if(f>=o&&i>=0)for(g=this._first;g;){if(m=g._next,(g._act||f>=g._start)&&g._ts&&v!==g){if(g.parent!==this)return this.render(i,n,s);if(g.render(g._ts>0?(f-g._start)*g._ts:(g._dirty?g.totalDuration():g._tDur)+(f-g._start)*g._ts,n,s),f!==this._time||!this._ts&&!_){v=0,m&&(h+=this._zTime=-F);break}}g=m}else{g=this._last;for(var O=i<0?i:f;g;){if(m=g._prev,(g._act||O<=g._end)&&g._ts&&v!==g){if(g.parent!==this)return this.render(i,n,s);if(g.render(g._ts>0?(O-g._start)*g._ts:(g._dirty?g.totalDuration():g._tDur)+(O-g._start)*g._ts,n,s||Z&&Nr(g)),f!==this._time||!this._ts&&!_){v=0,m&&(h+=this._zTime=O?-F:F);break}}g=m}}if(v&&!n&&(this.pause(),v.render(f>=o?0:-F)._zTime=f>=o?1:-1,this._ts))return this._start=C,Qt(this),this.render(i,n,s);this._onUpdate&&!n&&he(this,"onUpdate",!0),(h===l&&this._tTime>=this.totalDuration()||!h&&o)&&(C===this._start||Math.abs(T)!==Math.abs(this._ts))&&(this._lock||((i||!c)&&(h===l&&this._ts>0||!h&&this._ts<0)&&ze(this,1),!n&&!(i<0&&!o)&&(h||o||!l)&&(he(this,h===l&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(h<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(i,n){var s=this;if(Ae(n)||(n=pe(this,n,i)),!(i instanceof At)){if(te(i))return i.forEach(function(o){return s.add(o,n)}),this;if(K(i))return this.addLabel(i,n);if(V(i))i=G.delayedCall(0,i);else return this}return this!==i?we(this,i,n):this},t.getChildren=function(i,n,s,o){i===void 0&&(i=!0),n===void 0&&(n=!0),s===void 0&&(s=!0),o===void 0&&(o=-me);for(var l=[],c=this._first;c;)c._start>=o&&(c instanceof G?n&&l.push(c):(s&&l.push(c),i&&l.push.apply(l,c.getChildren(!0,n,s)))),c=c._next;return l},t.getById=function(i){for(var n=this.getChildren(1,1,1),s=n.length;s--;)if(n[s].vars.id===i)return n[s]},t.remove=function(i){return K(i)?this.removeLabel(i):V(i)?this.killTweensOf(i):(i.parent===this&&Jt(this,i),i===this._recent&&(this._recent=this._last),Ke(this))},t.totalTime=function(i,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=$(ce.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),a.prototype.totalTime.call(this,i,n),this._forcing=0,this):this._tTime},t.addLabel=function(i,n){return this.labels[i]=pe(this,n),this},t.removeLabel=function(i){return delete this.labels[i],this},t.addPause=function(i,n,s){var o=G.delayedCall(0,n||kt,s);return o.data="isPause",this._hasPause=1,we(this,o,pe(this,i))},t.removePause=function(i){var n=this._first;for(i=pe(this,i);n;)n._start===i&&n.data==="isPause"&&ze(n),n=n._next},t.killTweensOf=function(i,n,s){for(var o=this.getTweensOf(i,s),l=o.length;l--;)Re!==o[l]&&o[l].kill(i,n);return this},t.getTweensOf=function(i,n){for(var s=[],o=_e(i),l=this._first,c=Ae(n),h;l;)l instanceof G?vs(l._targets,o)&&(c?(!Re||l._initted&&l._ts)&&l.globalTime(0)<=n&&l.globalTime(l.totalDuration())>n:!n||l.isActive())&&s.push(l):(h=l.getTweensOf(o,n)).length&&s.push.apply(s,h),l=l._next;return s},t.tweenTo=function(i,n){n=n||{};var s=this,o=pe(s,i),l=n,c=l.startAt,h=l.onStart,d=l.onStartParams,f=l.immediateRender,g,m=G.to(s,ge({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:n.duration||Math.abs((o-(c&&"time"in c?c.time:s._time))/s.timeScale())||F,onStart:function(){if(s.pause(),!g){var p=n.duration||Math.abs((o-(c&&"time"in c?c.time:s._time))/s.timeScale());m._dur!==p&&ut(m,p,0,1).render(m._time,!0,!0),g=1}h&&h.apply(m,d||[])}},n));return f?m.render(0):m},t.tweenFromTo=function(i,n,s){return this.tweenTo(n,ge({startAt:{time:pe(this,i)}},s))},t.recent=function(){return this._recent},t.nextLabel=function(i){return i===void 0&&(i=this._time),ti(this,pe(this,i))},t.previousLabel=function(i){return i===void 0&&(i=this._time),ti(this,pe(this,i),1)},t.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+F)},t.shiftChildren=function(i,n,s){s===void 0&&(s=0);var o=this._first,l=this.labels,c;for(i=$(i);o;)o._start>=s&&(o._start+=i,o._end+=i),o=o._next;if(n)for(c in l)l[c]>=s&&(l[c]+=i);return Ke(this)},t.invalidate=function(i){var n=this._first;for(this._lock=0;n;)n.invalidate(i),n=n._next;return a.prototype.invalidate.call(this,i)},t.clear=function(i){i===void 0&&(i=!0);for(var n=this._first,s;n;)s=n._next,this.remove(n),n=s;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),Ke(this)},t.totalDuration=function(i){var n=0,s=this,o=s._last,l=me,c,h,d;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-i:i));if(s._dirty){for(d=s.parent;o;)c=o._prev,o._dirty&&o.totalDuration(),h=o._start,h>l&&s._sort&&o._ts&&!s._lock?(s._lock=1,we(s,o,h-o._delay,1)._lock=0):l=h,h<0&&o._ts&&(n-=h,(!d&&!s._dp||d&&d.smoothChildTiming)&&(s._start+=$(h/s._ts),s._time-=h,s._tTime-=h),s.shiftChildren(-h,!1,-1/0),l=0),o._end>n&&o._ts&&(n=o._end),o=c;ut(s,s===U&&s._time>n?s._time:n,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(i){if(U._ts&&(Ri(U,Vt(i,U)),Di=ce.frame),ce.frame>=Jr){Jr+=ue.autoSleep||120;var n=U._first;if((!n||!n._ts)&&ue.autoSleep&&ce._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||ce.sleep()}}},e})(At);ge(re.prototype,{_lock:0,_hasPause:0,_forcing:0});var Us=function(e,t,r,i,n,s,o){var l=new se(this._pt,e,t,0,1,cn,null,n),c=0,h=0,d,f,g,m,u,p,_,v;for(l.b=r,l.e=i,r+="",i+="",(_=~i.indexOf("random("))&&(i=Et(i)),s&&(v=[r,i],s(v,e,t),r=v[0],i=v[1]),f=r.match(er)||[];d=er.exec(i);)m=d[0],u=i.substring(c,d.index),g?g=(g+1)%5:u.substr(-5)==="rgba("&&(g=1),m!==f[h++]&&(p=parseFloat(f[h-1])||0,l._pt={_next:l._pt,p:u||h===1?u:",",s:p,c:m.charAt(1)==="="?ot(p,m)-p:parseFloat(m)-p,m:g&&g<4?Math.round:0},c=er.lastIndex);return l.c=c<i.length?i.substring(c,i.length):"",l.fp=o,(Oi.test(i)||_)&&(l.e=0),this._pt=l,l},Br=function(e,t,r,i,n,s,o,l,c,h){V(i)&&(i=i(n||0,e,s));var d=e[t],f=r!=="get"?r:V(d)?c?e[t.indexOf("set")||!V(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():d,g=V(d)?c?Xs:an:zr,m;if(K(i)&&(~i.indexOf("random(")&&(i=Et(i)),i.charAt(1)==="="&&(m=ot(f,i)+(ee(f)||0),(m||m===0)&&(i=m))),!h||f!==i||Cr)return!isNaN(f*i)&&i!==""?(m=new se(this._pt,e,t,+f||0,i-(f||0),typeof d=="boolean"?Ks:ln,0,g),c&&(m.fp=c),o&&m.modifier(o,this,e),this._pt=m):(!d&&!(t in e)&&Dr(t,i),Us.call(this,e,t,f,i,g,l||ue.stringFilter,c))},Ws=function(e,t,r,i,n){if(V(e)&&(e=wt(e,n,t,r,i)),!xe(e)||e.style&&e.nodeType||te(e)||ki(e))return K(e)?wt(e,n,t,r,i):e;var s={},o;for(o in e)s[o]=wt(e[o],n,t,r,i);return s},nn=function(e,t,r,i,n,s){var o,l,c,h;if(le[e]&&(o=new le[e]).init(n,o.rawVars?t[e]:Ws(t[e],i,n,s,r),r,i,s)!==!1&&(r._pt=l=new se(r._pt,n,e,0,1,o.render,o,0,o.priority),r!==st))for(c=r._ptLookup[r._targets.indexOf(n)],h=o._props.length;h--;)c[o._props[h]]=l;return o},Re,Cr,Fr=function a(e,t,r){var i=e.vars,n=i.ease,s=i.startAt,o=i.immediateRender,l=i.lazy,c=i.onUpdate,h=i.runBackwards,d=i.yoyoEase,f=i.keyframes,g=i.autoRevert,m=e._dur,u=e._startAt,p=e._targets,_=e.parent,v=_&&_.data==="nested"?_.vars.targets:p,T=e._overwrite==="auto"&&!Or,C=e.timeline,b,k,x,S,w,O,P,D,M,R,L,N,H;if(C&&(!f||!n)&&(n="none"),e._ease=Je(n,ct.ease),e._yEase=d?Zi(Je(d===!0?n:d,ct.ease)):0,d&&e._yoyo&&!e._repeat&&(d=e._yEase,e._yEase=e._ease,e._ease=d),e._from=!C&&!!i.runBackwards,!C||f&&!i.stagger){if(D=p[0]?je(p[0]).harness:0,N=D&&i[D.prop],b=Wt(i,Mr),u&&(u._zTime<0&&u.progress(1),t<0&&h&&o&&!g?u.render(-1,!0):u.revert(h&&m?Lt:ys),u._lazy=0),s){if(ze(e._startAt=G.set(p,ge({data:"isStart",overwrite:!1,parent:_,immediateRender:!0,lazy:!u&&ie(l),startAt:null,delay:0,onUpdate:c&&function(){return he(e,"onUpdate")},stagger:0},s))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Z||!o&&!g)&&e._startAt.revert(Lt),o&&m&&t<=0&&r<=0){t&&(e._zTime=t);return}}else if(h&&m&&!u){if(t&&(o=!1),x=ge({overwrite:!1,data:"isFromStart",lazy:o&&!u&&ie(l),immediateRender:o,stagger:0,parent:_},b),N&&(x[D.prop]=N),ze(e._startAt=G.set(p,x)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(Z?e._startAt.revert(Lt):e._startAt.render(-1,!0)),e._zTime=t,!o)a(e._startAt,F,F);else if(!t)return}for(e._pt=e._ptCache=0,l=m&&ie(l)||l&&!m,k=0;k<p.length;k++){if(w=p[k],P=w._gsap||Lr(p)[k]._gsap,e._ptLookup[k]=R={},pr[P.id]&&Be.length&&Ut(),L=v===p?k:v.indexOf(w),D&&(M=new D).init(w,N||b,e,L,v)!==!1&&(e._pt=S=new se(e._pt,w,M.name,0,1,M.render,M,0,M.priority),M._props.forEach(function(j){R[j]=S}),M.priority&&(O=1)),!D||N)for(x in b)le[x]&&(M=nn(x,b,e,L,w,v))?M.priority&&(O=1):R[x]=S=Br.call(e,w,x,"get",b[x],L,v,0,i.stringFilter);e._op&&e._op[k]&&e.kill(w,e._op[k]),T&&e._pt&&(Re=e,U.killTweensOf(w,R,e.globalTime(t)),H=!e.parent,Re=0),e._pt&&l&&(pr[P.id]=1)}O&&hn(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!H,f&&t<=0&&C.render(me,!0,!0)},Vs=function(e,t,r,i,n,s,o,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],h,d,f,g;if(!c)for(c=e._ptCache[t]=[],f=e._ptLookup,g=e._targets.length;g--;){if(h=f[g][t],h&&h.d&&h.d._pt)for(h=h.d._pt;h&&h.p!==t&&h.fp!==t;)h=h._next;if(!h)return Cr=1,e.vars[t]="+=0",Fr(e,o),Cr=0,l?St(t+" not eligible for reset"):1;c.push(h)}for(g=c.length;g--;)d=c[g],h=d._pt||d,h.s=(i||i===0)&&!n?i:h.s+(i||0)+s*h.c,h.c=r-h.s,d.e&&(d.e=Y(r)+ee(d.e)),d.b&&(d.b=h.s+ee(d.b))},Ys=function(e,t){var r=e[0]?je(e[0]).harness:0,i=r&&r.aliases,n,s,o,l;if(!i)return t;n=ht({},t);for(s in i)if(s in n)for(l=i[s].split(","),o=l.length;o--;)n[l[o]]=n[s];return n},Gs=function(e,t,r,i){var n=t.ease||i||"power1.inOut",s,o;if(te(t))o=r[e]||(r[e]=[]),t.forEach(function(l,c){return o.push({t:c/(t.length-1)*100,v:l,e:n})});else for(s in t)o=r[s]||(r[s]=[]),s==="ease"||o.push({t:parseFloat(e),v:t[s],e:n})},wt=function(e,t,r,i,n){return V(e)?e.call(t,r,i,n):K(e)&&~e.indexOf("random(")?Et(e):e},sn=Rr+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",on={};ne(sn+",id,stagger,delay,duration,paused,scrollTrigger",function(a){return on[a]=1});var G=(function(a){xi(e,a);function e(r,i,n,s){var o;typeof i=="number"&&(n.duration=i,i=n,n=null),o=a.call(this,s?i:vt(i))||this;var l=o.vars,c=l.duration,h=l.delay,d=l.immediateRender,f=l.stagger,g=l.overwrite,m=l.keyframes,u=l.defaults,p=l.scrollTrigger,_=l.yoyoEase,v=i.parent||U,T=(te(r)||ki(r)?Ae(r[0]):"length"in i)?[r]:_e(r),C,b,k,x,S,w,O,P;if(o._targets=T.length?Lr(T):St("GSAP target "+r+" not found. https://gsap.com",!ue.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=g,m||f||Mt(c)||Mt(h)){if(i=o.vars,C=o.timeline=new re({data:"nested",defaults:u||{},targets:v&&v.data==="nested"?v.vars.targets:T}),C.kill(),C.parent=C._dp=Ee(o),C._start=0,f||Mt(c)||Mt(h)){if(x=T.length,O=f&&Ui(f),xe(f))for(S in f)~sn.indexOf(S)&&(P||(P={}),P[S]=f[S]);for(b=0;b<x;b++)k=Wt(i,on),k.stagger=0,_&&(k.yoyoEase=_),P&&ht(k,P),w=T[b],k.duration=+wt(c,Ee(o),b,w,T),k.delay=(+wt(h,Ee(o),b,w,T)||0)-o._delay,!f&&x===1&&k.delay&&(o._delay=h=k.delay,o._start+=h,k.delay=0),C.to(w,k,O?O(b,w,T):0),C._ease=I.none;C.duration()?c=h=0:o.timeline=0}else if(m){vt(ge(C.vars.defaults,{ease:"none"})),C._ease=Je(m.ease||i.ease||"none");var D=0,M,R,L;if(te(m))m.forEach(function(N){return C.to(T,N,">")}),C.duration();else{k={};for(S in m)S==="ease"||S==="easeEach"||Gs(S,m[S],k,m.easeEach);for(S in k)for(M=k[S].sort(function(N,H){return N.t-H.t}),D=0,b=0;b<M.length;b++)R=M[b],L={ease:R.e,duration:(R.t-(b?M[b-1].t:0))/100*c},L[S]=R.v,C.to(T,L,D),D+=L.duration;C.duration()<c&&C.to({},{duration:c-C.duration()})}}c||o.duration(c=C.duration())}else o.timeline=0;return g===!0&&!Or&&(Re=Ee(o),U.killTweensOf(T),Re=0),we(v,Ee(o),n),i.reversed&&o.reverse(),i.paused&&o.paused(!0),(d||!c&&!m&&o._start===$(v._time)&&ie(d)&&xs(Ee(o))&&v.data!=="nested")&&(o._tTime=-F,o.render(Math.max(0,-h)||0)),p&&zi(Ee(o),p),o}var t=e.prototype;return t.render=function(i,n,s){var o=this._time,l=this._tDur,c=this._dur,h=i<0,d=i>l-F&&!h?l:i<F?0:i,f,g,m,u,p,_,v,T,C;if(!c)ks(this,i,n,s);else if(d!==this._tTime||!i||s||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==h||this._lazy){if(f=d,T=this.timeline,this._repeat){if(u=c+this._rDelay,this._repeat<-1&&h)return this.totalTime(u*100+i,n,s);if(f=$(d%u),d===l?(m=this._repeat,f=c):(p=$(d/u),m=~~p,m&&m===p?(f=c,m--):f>c&&(f=c)),_=this._yoyo&&m&1,_&&(C=this._yEase,f=c-f),p=dt(this._tTime,u),f===o&&!s&&this._initted&&m===p)return this._tTime=d,this;m!==p&&(T&&this._yEase&&en(T,_),this.vars.repeatRefresh&&!_&&!this._lock&&f!==u&&this._initted&&(this._lock=s=1,this.render($(u*m),!0).invalidate()._lock=0))}if(!this._initted){if(Hi(this,h?i:f,s,n,d))return this._tTime=0,this;if(o!==this._time&&!(s&&this.vars.repeatRefresh&&m!==p))return this;if(c!==this._dur)return this.render(i,n,s)}if(this._tTime=d,this._time=f,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=v=(C||this._ease)(f/c),this._from&&(this.ratio=v=1-v),!o&&d&&!n&&!p&&(he(this,"onStart"),this._tTime!==d))return this;for(g=this._pt;g;)g.r(v,g.d),g=g._next;T&&T.render(i<0?i:T._dur*T._ease(f/this._dur),n,s)||this._startAt&&(this._zTime=i),this._onUpdate&&!n&&(h&&mr(this,i,n,s),he(this,"onUpdate")),this._repeat&&m!==p&&this.vars.onRepeat&&!n&&this.parent&&he(this,"onRepeat"),(d===this._tDur||!d)&&this._tTime===d&&(h&&!this._onUpdate&&mr(this,i,!0,!0),(i||!c)&&(d===this._tDur&&this._ts>0||!d&&this._ts<0)&&ze(this,1),!n&&!(h&&!o)&&(d||o||_)&&(he(this,d===l?"onComplete":"onReverseComplete",!0),this._prom&&!(d<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),a.prototype.invalidate.call(this,i)},t.resetTo=function(i,n,s,o,l){Ot||ce.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),h;return this._initted||Fr(this,c),h=this._ease(c/this._dur),Vs(this,i,n,s,o,h,c,l)?this.resetTo(i,n,s,o,1):(Zt(this,0),this.parent||Bi(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(i,n){if(n===void 0&&(n="all"),!i&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?yt(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Z),this;if(this.timeline){var s=this.timeline.totalDuration();return this.timeline.killTweensOf(i,n,Re&&Re.vars.overwrite!==!0)._first||yt(this),this.parent&&s!==this.timeline.totalDuration()&&ut(this,this._dur*this.timeline._tDur/s,0,1),this}var o=this._targets,l=i?_e(i):o,c=this._ptLookup,h=this._pt,d,f,g,m,u,p,_;if((!n||n==="all")&&ws(o,l))return n==="all"&&(this._pt=0),yt(this);for(d=this._op=this._op||[],n!=="all"&&(K(n)&&(u={},ne(n,function(v){return u[v]=1}),n=u),n=Ys(o,n)),_=o.length;_--;)if(~l.indexOf(o[_])){f=c[_],n==="all"?(d[_]=n,m=f,g={}):(g=d[_]=d[_]||{},m=n);for(u in m)p=f&&f[u],p&&((!("kill"in p.d)||p.d.kill(u)===!0)&&Jt(this,p,"_pt"),delete f[u]),g!=="all"&&(g[u]=1)}return this._initted&&!this._pt&&h&&yt(this),this},e.to=function(i,n){return new e(i,n,arguments[2])},e.from=function(i,n){return Ct(1,arguments)},e.delayedCall=function(i,n,s,o){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:n,onReverseComplete:n,onCompleteParams:s,onReverseCompleteParams:s,callbackScope:o})},e.fromTo=function(i,n,s){return Ct(2,arguments)},e.set=function(i,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(i,n)},e.killTweensOf=function(i,n,s){return U.killTweensOf(i,n,s)},e})(At);ge(G.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ne("staggerTo,staggerFrom,staggerFromTo",function(a){G[a]=function(){var e=new re,t=yr.call(arguments,0);return t.splice(a==="staggerFromTo"?5:4,0,0),e[a].apply(e,t)}});var zr=function(e,t,r){return e[t]=r},an=function(e,t,r){return e[t](r)},Xs=function(e,t,r,i){return e[t](i.fp,r)},js=function(e,t,r){return e.setAttribute(t,r)},Hr=function(e,t){return V(e[t])?an:Ar(e[t])&&e.setAttribute?js:zr},ln=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},Ks=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},cn=function(e,t){var r=t._pt,i="";if(!e&&t.b)i=t.b;else if(e===1&&t.e)i=t.e;else{for(;r;)i=r.p+(r.m?r.m(r.s+r.c*e):Math.round((r.s+r.c*e)*1e4)/1e4)+i,r=r._next;i+=t.c}t.set(t.t,t.p,i,t)},qr=function(e,t){for(var r=t._pt;r;)r.r(e,r.d),r=r._next},Js=function(e,t,r,i){for(var n=this._pt,s;n;)s=n._next,n.p===i&&n.modifier(e,t,r),n=s},Qs=function(e){for(var t=this._pt,r,i;t;)i=t._next,t.p===e&&!t.op||t.op===e?Jt(this,t,"_pt"):t.dep||(r=1),t=i;return!r},Zs=function(e,t,r,i){i.mSet(e,t,i.m.call(i.tween,r,i.mt),i)},hn=function(e){for(var t=e._pt,r,i,n,s;t;){for(r=t._next,i=n;i&&i.pr>t.pr;)i=i._next;(t._prev=i?i._prev:s)?t._prev._next=t:n=t,(t._next=i)?i._prev=t:s=t,t=r}e._pt=n},se=(function(){function a(t,r,i,n,s,o,l,c,h){this.t=r,this.s=n,this.c=s,this.p=i,this.r=o||ln,this.d=l||this,this.set=c||zr,this.pr=h||0,this._next=t,t&&(t._prev=this)}var e=a.prototype;return e.modifier=function(r,i,n){this.mSet=this.mSet||this.set,this.set=Zs,this.m=r,this.mt=n,this.tween=i},a})();ne(Rr+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(a){return Mr[a]=1});fe.TweenMax=fe.TweenLite=G;fe.TimelineLite=fe.TimelineMax=re;U=new re({sortChildren:!1,defaults:ct,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});ue.stringFilter=Qi;var Qe=[],Bt={},eo=[],ii=0,to=0,sr=function(e){return(Bt[e]||eo).map(function(t){return t()})},wr=function(){var e=Date.now(),t=[];e-ii>2&&(sr("matchMediaInit"),Qe.forEach(function(r){var i=r.queries,n=r.conditions,s,o,l,c;for(o in i)s=Ce.matchMedia(i[o]).matches,s&&(l=1),s!==n[o]&&(n[o]=s,c=1);c&&(r.revert(),l&&t.push(r))}),sr("matchMediaRevert"),t.forEach(function(r){return r.onMatch(r,function(i){return r.add(null,i)})}),ii=e,sr("matchMedia"))},dn=(function(){function a(t,r){this.selector=r&&br(r),this.data=[],this._r=[],this.isReverted=!1,this.id=to++,t&&this.add(t)}var e=a.prototype;return e.add=function(r,i,n){V(r)&&(n=i,i=r,r=V);var s=this,o=function(){var c=q,h=s.selector,d;return c&&c!==s&&c.data.push(s),n&&(s.selector=br(n)),q=s,d=i.apply(s,arguments),V(d)&&s._r.push(d),q=c,s.selector=h,s.isReverted=!1,d};return s.last=o,r===V?o(s,function(l){return s.add(null,l)}):r?s[r]=o:o},e.ignore=function(r){var i=q;q=null,r(this),q=i},e.getTweens=function(){var r=[];return this.data.forEach(function(i){return i instanceof a?r.push.apply(r,i.getTweens()):i instanceof G&&!(i.parent&&i.parent.data==="nested")&&r.push(i)}),r},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(r,i){var n=this;if(r?(function(){for(var o=n.getTweens(),l=n.data.length,c;l--;)c=n.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(h){return o.splice(o.indexOf(h),1)}));for(o.map(function(h){return{g:h._dur||h._delay||h._sat&&!h._sat.vars.immediateRender?h.globalTime(0):-1/0,t:h}}).sort(function(h,d){return d.g-h.g||-1/0}).forEach(function(h){return h.t.revert(r)}),l=n.data.length;l--;)c=n.data[l],c instanceof re?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof G)&&c.revert&&c.revert(r);n._r.forEach(function(h){return h(r,n)}),n.isReverted=!0})():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),i)for(var s=Qe.length;s--;)Qe[s].id===this.id&&Qe.splice(s,1)},e.revert=function(r){this.kill(r||{})},a})(),ro=(function(){function a(t){this.contexts=[],this.scope=t,q&&q.data.push(this)}var e=a.prototype;return e.add=function(r,i,n){xe(r)||(r={matches:r});var s=new dn(0,n||this.scope),o=s.conditions={},l,c,h;q&&!s.selector&&(s.selector=q.selector),this.contexts.push(s),i=s.add("onMatch",i),s.queries=r;for(c in r)c==="all"?h=1:(l=Ce.matchMedia(r[c]),l&&(Qe.indexOf(s)<0&&Qe.push(s),(o[c]=l.matches)&&(h=1),l.addListener?l.addListener(wr):l.addEventListener("change",wr)));return h&&i(s,function(d){return s.add(null,d)}),this},e.revert=function(r){this.kill(r||{})},e.kill=function(r){this.contexts.forEach(function(i){return i.kill(r,!0)})},a})(),Yt={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach(function(i){return ji(i)})},timeline:function(e){return new re(e)},getTweensOf:function(e,t){return U.getTweensOf(e,t)},getProperty:function(e,t,r,i){K(e)&&(e=_e(e)[0]);var n=je(e||{}).get,s=r?Ni:Li;return r==="native"&&(r=""),e&&(t?s((le[t]&&le[t].get||n)(e,t,r,i)):function(o,l,c){return s((le[o]&&le[o].get||n)(e,o,l,c))})},quickSetter:function(e,t,r){if(e=_e(e),e.length>1){var i=e.map(function(h){return ae.quickSetter(h,t,r)}),n=i.length;return function(h){for(var d=n;d--;)i[d](h)}}e=e[0]||{};var s=le[t],o=je(e),l=o.harness&&(o.harness.aliases||{})[t]||t,c=s?function(h){var d=new s;st._pt=0,d.init(e,r?h+r:h,st,0,[e]),d.render(1,d),st._pt&&qr(1,st)}:o.set(e,l);return s?c:function(h){return c(e,l,r?h+r:h,o,1)}},quickTo:function(e,t,r){var i,n=ae.to(e,ge((i={},i[t]="+=0.1",i.paused=!0,i.stagger=0,i),r||{})),s=function(l,c,h){return n.resetTo(t,l,c,h)};return s.tween=n,s},isTweening:function(e){return U.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Je(e.ease,ct.ease)),Qr(ct,e||{})},config:function(e){return Qr(ue,e||{})},registerEffect:function(e){var t=e.name,r=e.effect,i=e.plugins,n=e.defaults,s=e.extendTimeline;(i||"").split(",").forEach(function(o){return o&&!le[o]&&!fe[o]&&St(t+" effect requires "+o+" plugin.")}),tr[t]=function(o,l,c){return r(_e(o),ge(l||{},n),c)},s&&(re.prototype[t]=function(o,l,c){return this.add(tr[t](o,xe(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){I[e]=Je(t)},parseEase:function(e,t){return arguments.length?Je(e,t):I},getById:function(e){return U.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var r=new re(e),i,n;for(r.smoothChildTiming=ie(e.smoothChildTiming),U.remove(r),r._dp=0,r._time=r._tTime=U._time,i=U._first;i;)n=i._next,(t||!(!i._dur&&i instanceof G&&i.vars.onComplete===i._targets[0]))&&we(r,i,i._start-i._delay),i=n;return we(U,r,0),r},context:function(e,t){return e?new dn(e,t):q},matchMedia:function(e){return new ro(e)},matchMediaRefresh:function(){return Qe.forEach(function(e){var t=e.conditions,r,i;for(i in t)t[i]&&(t[i]=!1,r=1);r&&e.revert()})||wr()},addEventListener:function(e,t){var r=Bt[e]||(Bt[e]=[]);~r.indexOf(t)||r.push(t)},removeEventListener:function(e,t){var r=Bt[e],i=r&&r.indexOf(t);i>=0&&r.splice(i,1)},utils:{wrap:Rs,wrapYoyo:Ls,distribute:Ui,random:Vi,snap:Wi,normalize:Ms,getUnit:ee,clamp:As,splitColor:Ki,toArray:_e,selector:br,mapRange:Gi,pipe:Ps,unitize:Ds,interpolate:Ns,shuffle:$i},install:Ii,effects:tr,ticker:ce,updateRoot:re.updateRoot,plugins:le,globalTimeline:U,core:{PropTween:se,globals:Pi,Tween:G,Timeline:re,Animation:At,getCache:je,_removeLinkedListItem:Jt,reverting:function(){return Z},context:function(e){return e&&q&&(q.data.push(e),e._ctx=q),q},suppressOverwrites:function(e){return Or=e}}};ne("to,from,fromTo,delayedCall,set,killTweensOf",function(a){return Yt[a]=G[a]});ce.add(re.updateRoot);st=Yt.to({},{duration:0});var io=function(e,t){for(var r=e._pt;r&&r.p!==t&&r.op!==t&&r.fp!==t;)r=r._next;return r},no=function(e,t){var r=e._targets,i,n,s;for(i in t)for(n=r.length;n--;)s=e._ptLookup[n][i],s&&(s=s.d)&&(s._pt&&(s=io(s,i)),s&&s.modifier&&s.modifier(t[i],e,r[n],i))},or=function(e,t){return{name:e,headless:1,rawVars:1,init:function(i,n,s){s._onInit=function(o){var l,c;if(K(n)&&(l={},ne(n,function(h){return l[h]=1}),n=l),t){l={};for(c in n)l[c]=t(n[c]);n=l}no(o,n)}}}},ae=Yt.registerPlugin({name:"attr",init:function(e,t,r,i,n){var s,o,l;this.tween=r;for(s in t)l=e.getAttribute(s)||"",o=this.add(e,"setAttribute",(l||0)+"",t[s],i,n,0,0,s),o.op=s,o.b=l,this._props.push(s)},render:function(e,t){for(var r=t._pt;r;)Z?r.set(r.t,r.p,r.b,r):r.r(e,r.d),r=r._next}},{name:"endArray",headless:1,init:function(e,t){for(var r=t.length;r--;)this.add(e,r,e[r]||0,t[r],0,0,0,0,0,1)}},or("roundProps",vr),or("modifiers"),or("snap",Wi))||Yt;G.version=re.version=ae.version="3.14.2";Ai=1;Ir()&&ft();I.Power0;I.Power1;I.Power2;I.Power3;I.Power4;I.Linear;I.Quad;I.Cubic;I.Quart;I.Quint;I.Strong;I.Elastic;I.Back;I.SteppedEase;I.Bounce;I.Sine;I.Expo;I.Circ;/*!
 * CSSPlugin 3.14.2
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var ni,Le,at,$r,Ge,si,Ur,so=function(){return typeof window<"u"},Ie={},Ye=180/Math.PI,lt=Math.PI/180,rt=Math.atan2,oi=1e8,Wr=/([A-Z])/g,oo=/(left|right|width|margin|padding|x)/i,ao=/[\s,\(]\S/,Te={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Tr=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},lo=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},co=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},ho=function(e,t){return t.set(t.t,t.p,e===1?t.e:e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},uo=function(e,t){var r=t.s+t.c*e;t.set(t.t,t.p,~~(r+(r<0?-.5:.5))+t.u,t)},un=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},fn=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},fo=function(e,t,r){return e.style[t]=r},go=function(e,t,r){return e.style.setProperty(t,r)},po=function(e,t,r){return e._gsap[t]=r},mo=function(e,t,r){return e._gsap.scaleX=e._gsap.scaleY=r},_o=function(e,t,r,i,n){var s=e._gsap;s.scaleX=s.scaleY=r,s.renderTransform(n,s)},yo=function(e,t,r,i,n){var s=e._gsap;s[t]=r,s.renderTransform(n,s)},W="transform",oe=W+"Origin",bo=function a(e,t){var r=this,i=this.target,n=i.style,s=i._gsap;if(e in Ie&&n){if(this.tfm=this.tfm||{},e!=="transform")e=Te[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return r.tfm[o]=Oe(i,o)}):this.tfm[e]=s.x?s[e]:Oe(i,e),e===oe&&(this.tfm.zOrigin=s.zOrigin);else return Te.transform.split(",").forEach(function(o){return a.call(r,o,t)});if(this.props.indexOf(W)>=0)return;s.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(oe,t,"")),e=W}(n||t)&&this.props.push(e,t,n[e])},gn=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},vo=function(){var e=this.props,t=this.target,r=t.style,i=t._gsap,n,s;for(n=0;n<e.length;n+=3)e[n+1]?e[n+1]===2?t[e[n]](e[n+2]):t[e[n]]=e[n+2]:e[n+2]?r[e[n]]=e[n+2]:r.removeProperty(e[n].substr(0,2)==="--"?e[n]:e[n].replace(Wr,"-$1").toLowerCase());if(this.tfm){for(s in this.tfm)i[s]=this.tfm[s];i.svg&&(i.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),n=Ur(),(!n||!n.isStart)&&!r[W]&&(gn(r),i.zOrigin&&r[oe]&&(r[oe]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},pn=function(e,t){var r={target:e,props:[],revert:vo,save:bo};return e._gsap||ae.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(i){return r.save(i)}),r},mn,xr=function(e,t){var r=Le.createElementNS?Le.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Le.createElement(e);return r&&r.style?r:Le.createElement(e)},de=function a(e,t,r){var i=getComputedStyle(e);return i[t]||i.getPropertyValue(t.replace(Wr,"-$1").toLowerCase())||i.getPropertyValue(t)||!r&&a(e,gt(t)||t,1)||""},ai="O,Moz,ms,Ms,Webkit".split(","),gt=function(e,t,r){var i=t||Ge,n=i.style,s=5;if(e in n&&!r)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);s--&&!(ai[s]+e in n););return s<0?null:(s===3?"ms":s>=0?ai[s]:"")+e},Sr=function(){so()&&window.document&&(ni=window,Le=ni.document,at=Le.documentElement,Ge=xr("div")||{style:{}},xr("div"),W=gt(W),oe=W+"Origin",Ge.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",mn=!!gt("perspective"),Ur=ae.core.reverting,$r=1)},li=function(e){var t=e.ownerSVGElement,r=xr("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=e.cloneNode(!0),n;i.style.display="block",r.appendChild(i),at.appendChild(r);try{n=i.getBBox()}catch{}return r.removeChild(i),at.removeChild(r),n},ci=function(e,t){for(var r=t.length;r--;)if(e.hasAttribute(t[r]))return e.getAttribute(t[r])},_n=function(e){var t,r;try{t=e.getBBox()}catch{t=li(e),r=1}return t&&(t.width||t.height)||r||(t=li(e)),t&&!t.width&&!t.x&&!t.y?{x:+ci(e,["x","cx","x1"])||0,y:+ci(e,["y","cy","y1"])||0,width:0,height:0}:t},yn=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&_n(e))},He=function(e,t){if(t){var r=e.style,i;t in Ie&&t!==oe&&(t=W),r.removeProperty?(i=t.substr(0,2),(i==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),r.removeProperty(i==="--"?t:t.replace(Wr,"-$1").toLowerCase())):r.removeAttribute(t)}},Ne=function(e,t,r,i,n,s){var o=new se(e._pt,t,r,0,1,s?fn:un);return e._pt=o,o.b=i,o.e=n,e._props.push(r),o},hi={deg:1,rad:1,turn:1},Co={grid:1,flex:1},qe=function a(e,t,r,i){var n=parseFloat(r)||0,s=(r+"").trim().substr((n+"").length)||"px",o=Ge.style,l=oo.test(t),c=e.tagName.toLowerCase()==="svg",h=(c?"client":"offset")+(l?"Width":"Height"),d=100,f=i==="px",g=i==="%",m,u,p,_;if(i===s||!n||hi[i]||hi[s])return n;if(s!=="px"&&!f&&(n=a(e,t,r,"px")),_=e.getCTM&&yn(e),(g||s==="%")&&(Ie[t]||~t.indexOf("adius")))return m=_?e.getBBox()[l?"width":"height"]:e[h],Y(g?n/m*d:n/100*m);if(o[l?"width":"height"]=d+(f?s:i),u=i!=="rem"&&~t.indexOf("adius")||i==="em"&&e.appendChild&&!c?e:e.parentNode,_&&(u=(e.ownerSVGElement||{}).parentNode),(!u||u===Le||!u.appendChild)&&(u=Le.body),p=u._gsap,p&&g&&p.width&&l&&p.time===ce.time&&!p.uncache)return Y(n/p.width*d);if(g&&(t==="height"||t==="width")){var v=e.style[t];e.style[t]=d+i,m=e[h],v?e.style[t]=v:He(e,t)}else(g||s==="%")&&!Co[de(u,"display")]&&(o.position=de(e,"position")),u===e&&(o.position="static"),u.appendChild(Ge),m=Ge[h],u.removeChild(Ge),o.position="absolute";return l&&g&&(p=je(u),p.time=ce.time,p.width=u[h]),Y(f?m*n/d:m&&n?d/m*n:0)},Oe=function(e,t,r,i){var n;return $r||Sr(),t in Te&&t!=="transform"&&(t=Te[t],~t.indexOf(",")&&(t=t.split(",")[0])),Ie[t]&&t!=="transform"?(n=Pt(e,i),n=t!=="transformOrigin"?n[t]:n.svg?n.origin:Xt(de(e,oe))+" "+n.zOrigin+"px"):(n=e.style[t],(!n||n==="auto"||i||~(n+"").indexOf("calc("))&&(n=Gt[t]&&Gt[t](e,t,r)||de(e,t)||Mi(e,t)||(t==="opacity"?1:0))),r&&!~(n+"").trim().indexOf(" ")?qe(e,t,n,r)+r:n},wo=function(e,t,r,i){if(!r||r==="none"){var n=gt(t,e,1),s=n&&de(e,n,1);s&&s!==r?(t=n,r=s):t==="borderColor"&&(r=de(e,"borderTopColor"))}var o=new se(this._pt,e.style,t,0,1,cn),l=0,c=0,h,d,f,g,m,u,p,_,v,T,C,b;if(o.b=r,o.e=i,r+="",i+="",i.substring(0,6)==="var(--"&&(i=de(e,i.substring(4,i.indexOf(")")))),i==="auto"&&(u=e.style[t],e.style[t]=i,i=de(e,t)||i,u?e.style[t]=u:He(e,t)),h=[r,i],Qi(h),r=h[0],i=h[1],f=r.match(nt)||[],b=i.match(nt)||[],b.length){for(;d=nt.exec(i);)p=d[0],v=i.substring(l,d.index),m?m=(m+1)%5:(v.substr(-5)==="rgba("||v.substr(-5)==="hsla(")&&(m=1),p!==(u=f[c++]||"")&&(g=parseFloat(u)||0,C=u.substr((g+"").length),p.charAt(1)==="="&&(p=ot(g,p)+C),_=parseFloat(p),T=p.substr((_+"").length),l=nt.lastIndex-T.length,T||(T=T||ue.units[t]||C,l===i.length&&(i+=T,o.e+=T)),C!==T&&(g=qe(e,t,u,T)||0),o._pt={_next:o._pt,p:v||c===1?v:",",s:g,c:_-g,m:m&&m<4||t==="zIndex"?Math.round:0});o.c=l<i.length?i.substring(l,i.length):""}else o.r=t==="display"&&i==="none"?fn:un;return Oi.test(i)&&(o.e=0),this._pt=o,o},di={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},To=function(e){var t=e.split(" "),r=t[0],i=t[1]||"50%";return(r==="top"||r==="bottom"||i==="left"||i==="right")&&(e=r,r=i,i=e),t[0]=di[r]||r,t[1]=di[i]||i,t.join(" ")},xo=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var r=t.t,i=r.style,n=t.u,s=r._gsap,o,l,c;if(n==="all"||n===!0)i.cssText="",l=1;else for(n=n.split(","),c=n.length;--c>-1;)o=n[c],Ie[o]&&(l=1,o=o==="transformOrigin"?oe:W),He(r,o);l&&(He(r,W),s&&(s.svg&&r.removeAttribute("transform"),i.scale=i.rotate=i.translate="none",Pt(r,1),s.uncache=1,gn(i)))}},Gt={clearProps:function(e,t,r,i,n){if(n.data!=="isFromStart"){var s=e._pt=new se(e._pt,t,r,0,0,xo);return s.u=i,s.pr=-10,s.tween=n,e._props.push(r),1}}},It=[1,0,0,1,0,0],bn={},vn=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},ui=function(e){var t=de(e,W);return vn(t)?It:t.substr(7).match(Ei).map(Y)},Vr=function(e,t){var r=e._gsap||je(e),i=e.style,n=ui(e),s,o,l,c;return r.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,n=[l.a,l.b,l.c,l.d,l.e,l.f],n.join(",")==="1,0,0,1,0,0"?It:n):(n===It&&!e.offsetParent&&e!==at&&!r.svg&&(l=i.display,i.display="block",s=e.parentNode,(!s||!e.offsetParent&&!e.getBoundingClientRect().width)&&(c=1,o=e.nextElementSibling,at.appendChild(e)),n=ui(e),l?i.display=l:He(e,"display"),c&&(o?s.insertBefore(e,o):s?s.appendChild(e):at.removeChild(e))),t&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},kr=function(e,t,r,i,n,s){var o=e._gsap,l=n||Vr(e,!0),c=o.xOrigin||0,h=o.yOrigin||0,d=o.xOffset||0,f=o.yOffset||0,g=l[0],m=l[1],u=l[2],p=l[3],_=l[4],v=l[5],T=t.split(" "),C=parseFloat(T[0])||0,b=parseFloat(T[1])||0,k,x,S,w;r?l!==It&&(x=g*p-m*u)&&(S=C*(p/x)+b*(-u/x)+(u*v-p*_)/x,w=C*(-m/x)+b*(g/x)-(g*v-m*_)/x,C=S,b=w):(k=_n(e),C=k.x+(~T[0].indexOf("%")?C/100*k.width:C),b=k.y+(~(T[1]||T[0]).indexOf("%")?b/100*k.height:b)),i||i!==!1&&o.smooth?(_=C-c,v=b-h,o.xOffset=d+(_*g+v*u)-_,o.yOffset=f+(_*m+v*p)-v):o.xOffset=o.yOffset=0,o.xOrigin=C,o.yOrigin=b,o.smooth=!!i,o.origin=t,o.originIsAbsolute=!!r,e.style[oe]="0px 0px",s&&(Ne(s,o,"xOrigin",c,C),Ne(s,o,"yOrigin",h,b),Ne(s,o,"xOffset",d,o.xOffset),Ne(s,o,"yOffset",f,o.yOffset)),e.setAttribute("data-svg-origin",C+" "+b)},Pt=function(e,t){var r=e._gsap||new rn(e);if("x"in r&&!t&&!r.uncache)return r;var i=e.style,n=r.scaleX<0,s="px",o="deg",l=getComputedStyle(e),c=de(e,oe)||"0",h,d,f,g,m,u,p,_,v,T,C,b,k,x,S,w,O,P,D,M,R,L,N,H,j,Ue,Pe,ye,ve,pt,be,Se;return h=d=f=u=p=_=v=T=C=0,g=m=1,r.svg=!!(e.getCTM&&yn(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(i[W]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[W]!=="none"?l[W]:"")),i.scale=i.rotate=i.translate="none"),x=Vr(e,r.svg),r.svg&&(r.uncache?(j=e.getBBox(),c=r.xOrigin-j.x+"px "+(r.yOrigin-j.y)+"px",H=""):H=!t&&e.getAttribute("data-svg-origin"),kr(e,H||c,!!H||r.originIsAbsolute,r.smooth!==!1,x)),b=r.xOrigin||0,k=r.yOrigin||0,x!==It&&(P=x[0],D=x[1],M=x[2],R=x[3],h=L=x[4],d=N=x[5],x.length===6?(g=Math.sqrt(P*P+D*D),m=Math.sqrt(R*R+M*M),u=P||D?rt(D,P)*Ye:0,v=M||R?rt(M,R)*Ye+u:0,v&&(m*=Math.abs(Math.cos(v*lt))),r.svg&&(h-=b-(b*P+k*M),d-=k-(b*D+k*R))):(Se=x[6],pt=x[7],Pe=x[8],ye=x[9],ve=x[10],be=x[11],h=x[12],d=x[13],f=x[14],S=rt(Se,ve),p=S*Ye,S&&(w=Math.cos(-S),O=Math.sin(-S),H=L*w+Pe*O,j=N*w+ye*O,Ue=Se*w+ve*O,Pe=L*-O+Pe*w,ye=N*-O+ye*w,ve=Se*-O+ve*w,be=pt*-O+be*w,L=H,N=j,Se=Ue),S=rt(-M,ve),_=S*Ye,S&&(w=Math.cos(-S),O=Math.sin(-S),H=P*w-Pe*O,j=D*w-ye*O,Ue=M*w-ve*O,be=R*O+be*w,P=H,D=j,M=Ue),S=rt(D,P),u=S*Ye,S&&(w=Math.cos(S),O=Math.sin(S),H=P*w+D*O,j=L*w+N*O,D=D*w-P*O,N=N*w-L*O,P=H,L=j),p&&Math.abs(p)+Math.abs(u)>359.9&&(p=u=0,_=180-_),g=Y(Math.sqrt(P*P+D*D+M*M)),m=Y(Math.sqrt(N*N+Se*Se)),S=rt(L,N),v=Math.abs(S)>2e-4?S*Ye:0,C=be?1/(be<0?-be:be):0),r.svg&&(H=e.getAttribute("transform"),r.forceCSS=e.setAttribute("transform","")||!vn(de(e,W)),H&&e.setAttribute("transform",H))),Math.abs(v)>90&&Math.abs(v)<270&&(n?(g*=-1,v+=u<=0?180:-180,u+=u<=0?180:-180):(m*=-1,v+=v<=0?180:-180)),t=t||r.uncache,r.x=h-((r.xPercent=h&&(!t&&r.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-h)?-50:0)))?e.offsetWidth*r.xPercent/100:0)+s,r.y=d-((r.yPercent=d&&(!t&&r.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-d)?-50:0)))?e.offsetHeight*r.yPercent/100:0)+s,r.z=f+s,r.scaleX=Y(g),r.scaleY=Y(m),r.rotation=Y(u)+o,r.rotationX=Y(p)+o,r.rotationY=Y(_)+o,r.skewX=v+o,r.skewY=T+o,r.transformPerspective=C+s,(r.zOrigin=parseFloat(c.split(" ")[2])||!t&&r.zOrigin||0)&&(i[oe]=Xt(c)),r.xOffset=r.yOffset=0,r.force3D=ue.force3D,r.renderTransform=r.svg?ko:mn?Cn:So,r.uncache=0,r},Xt=function(e){return(e=e.split(" "))[0]+" "+e[1]},ar=function(e,t,r){var i=ee(t);return Y(parseFloat(t)+parseFloat(qe(e,"x",r+"px",i)))+i},So=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Cn(e,t)},We="0deg",mt="0px",Ve=") ",Cn=function(e,t){var r=t||this,i=r.xPercent,n=r.yPercent,s=r.x,o=r.y,l=r.z,c=r.rotation,h=r.rotationY,d=r.rotationX,f=r.skewX,g=r.skewY,m=r.scaleX,u=r.scaleY,p=r.transformPerspective,_=r.force3D,v=r.target,T=r.zOrigin,C="",b=_==="auto"&&e&&e!==1||_===!0;if(T&&(d!==We||h!==We)){var k=parseFloat(h)*lt,x=Math.sin(k),S=Math.cos(k),w;k=parseFloat(d)*lt,w=Math.cos(k),s=ar(v,s,x*w*-T),o=ar(v,o,-Math.sin(k)*-T),l=ar(v,l,S*w*-T+T)}p!==mt&&(C+="perspective("+p+Ve),(i||n)&&(C+="translate("+i+"%, "+n+"%) "),(b||s!==mt||o!==mt||l!==mt)&&(C+=l!==mt||b?"translate3d("+s+", "+o+", "+l+") ":"translate("+s+", "+o+Ve),c!==We&&(C+="rotate("+c+Ve),h!==We&&(C+="rotateY("+h+Ve),d!==We&&(C+="rotateX("+d+Ve),(f!==We||g!==We)&&(C+="skew("+f+", "+g+Ve),(m!==1||u!==1)&&(C+="scale("+m+", "+u+Ve),v.style[W]=C||"translate(0, 0)"},ko=function(e,t){var r=t||this,i=r.xPercent,n=r.yPercent,s=r.x,o=r.y,l=r.rotation,c=r.skewX,h=r.skewY,d=r.scaleX,f=r.scaleY,g=r.target,m=r.xOrigin,u=r.yOrigin,p=r.xOffset,_=r.yOffset,v=r.forceCSS,T=parseFloat(s),C=parseFloat(o),b,k,x,S,w;l=parseFloat(l),c=parseFloat(c),h=parseFloat(h),h&&(h=parseFloat(h),c+=h,l+=h),l||c?(l*=lt,c*=lt,b=Math.cos(l)*d,k=Math.sin(l)*d,x=Math.sin(l-c)*-f,S=Math.cos(l-c)*f,c&&(h*=lt,w=Math.tan(c-h),w=Math.sqrt(1+w*w),x*=w,S*=w,h&&(w=Math.tan(h),w=Math.sqrt(1+w*w),b*=w,k*=w)),b=Y(b),k=Y(k),x=Y(x),S=Y(S)):(b=d,S=f,k=x=0),(T&&!~(s+"").indexOf("px")||C&&!~(o+"").indexOf("px"))&&(T=qe(g,"x",s,"px"),C=qe(g,"y",o,"px")),(m||u||p||_)&&(T=Y(T+m-(m*b+u*x)+p),C=Y(C+u-(m*k+u*S)+_)),(i||n)&&(w=g.getBBox(),T=Y(T+i/100*w.width),C=Y(C+n/100*w.height)),w="matrix("+b+","+k+","+x+","+S+","+T+","+C+")",g.setAttribute("transform",w),v&&(g.style[W]=w)},Eo=function(e,t,r,i,n){var s=360,o=K(n),l=parseFloat(n)*(o&&~n.indexOf("rad")?Ye:1),c=l-i,h=i+c+"deg",d,f;return o&&(d=n.split("_")[1],d==="short"&&(c%=s,c!==c%(s/2)&&(c+=c<0?s:-s)),d==="cw"&&c<0?c=(c+s*oi)%s-~~(c/s)*s:d==="ccw"&&c>0&&(c=(c-s*oi)%s-~~(c/s)*s)),e._pt=f=new se(e._pt,t,r,i,c,lo),f.e=h,f.u="deg",e._props.push(r),f},fi=function(e,t){for(var r in t)e[r]=t[r];return e},Oo=function(e,t,r){var i=fi({},r._gsap),n="perspective,force3D,transformOrigin,svgOrigin",s=r.style,o,l,c,h,d,f,g,m;i.svg?(c=r.getAttribute("transform"),r.setAttribute("transform",""),s[W]=t,o=Pt(r,1),He(r,W),r.setAttribute("transform",c)):(c=getComputedStyle(r)[W],s[W]=t,o=Pt(r,1),s[W]=c);for(l in Ie)c=i[l],h=o[l],c!==h&&n.indexOf(l)<0&&(g=ee(c),m=ee(h),d=g!==m?qe(r,l,c,m):parseFloat(c),f=parseFloat(h),e._pt=new se(e._pt,o,l,d,f-d,Tr),e._pt.u=m||0,e._props.push(l));fi(o,i)};ne("padding,margin,Width,Radius",function(a,e){var t="Top",r="Right",i="Bottom",n="Left",s=(e<3?[t,r,i,n]:[t+n,t+r,i+r,i+n]).map(function(o){return e<2?a+o:"border"+o+a});Gt[e>1?"border"+a:a]=function(o,l,c,h,d){var f,g;if(arguments.length<4)return f=s.map(function(m){return Oe(o,m,c)}),g=f.join(" "),g.split(f[0]).length===5?f[0]:g;f=(h+"").split(" "),g={},s.forEach(function(m,u){return g[m]=f[u]=f[u]||f[(u-1)/2|0]}),o.init(l,g,d)}});var wn={name:"css",register:Sr,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,r,i,n){var s=this._props,o=e.style,l=r.vars.startAt,c,h,d,f,g,m,u,p,_,v,T,C,b,k,x,S,w;$r||Sr(),this.styles=this.styles||pn(e),S=this.styles.props,this.tween=r;for(u in t)if(u!=="autoRound"&&(h=t[u],!(le[u]&&nn(u,t,r,i,e,n)))){if(g=typeof h,m=Gt[u],g==="function"&&(h=h.call(r,i,e,n),g=typeof h),g==="string"&&~h.indexOf("random(")&&(h=Et(h)),m)m(this,e,u,h,r)&&(x=1);else if(u.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(u)+"").trim(),h+="",Fe.lastIndex=0,Fe.test(c)||(p=ee(c),_=ee(h),_?p!==_&&(c=qe(e,u,c,_)+_):p&&(h+=p)),this.add(o,"setProperty",c,h,i,n,0,0,u),s.push(u),S.push(u,0,o[u]);else if(g!=="undefined"){if(l&&u in l?(c=typeof l[u]=="function"?l[u].call(r,i,e,n):l[u],K(c)&&~c.indexOf("random(")&&(c=Et(c)),ee(c+"")||c==="auto"||(c+=ue.units[u]||ee(Oe(e,u))||""),(c+"").charAt(1)==="="&&(c=Oe(e,u))):c=Oe(e,u),f=parseFloat(c),v=g==="string"&&h.charAt(1)==="="&&h.substr(0,2),v&&(h=h.substr(2)),d=parseFloat(h),u in Te&&(u==="autoAlpha"&&(f===1&&Oe(e,"visibility")==="hidden"&&d&&(f=0),S.push("visibility",0,o.visibility),Ne(this,o,"visibility",f?"inherit":"hidden",d?"inherit":"hidden",!d)),u!=="scale"&&u!=="transform"&&(u=Te[u],~u.indexOf(",")&&(u=u.split(",")[0]))),T=u in Ie,T){if(this.styles.save(u),w=h,g==="string"&&h.substring(0,6)==="var(--"){if(h=de(e,h.substring(4,h.indexOf(")"))),h.substring(0,5)==="calc("){var O=e.style.perspective;e.style.perspective=h,h=de(e,"perspective"),O?e.style.perspective=O:He(e,"perspective")}d=parseFloat(h)}if(C||(b=e._gsap,b.renderTransform&&!t.parseTransform||Pt(e,t.parseTransform),k=t.smoothOrigin!==!1&&b.smooth,C=this._pt=new se(this._pt,o,W,0,1,b.renderTransform,b,0,-1),C.dep=1),u==="scale")this._pt=new se(this._pt,b,"scaleY",b.scaleY,(v?ot(b.scaleY,v+d):d)-b.scaleY||0,Tr),this._pt.u=0,s.push("scaleY",u),u+="X";else if(u==="transformOrigin"){S.push(oe,0,o[oe]),h=To(h),b.svg?kr(e,h,0,k,0,this):(_=parseFloat(h.split(" ")[2])||0,_!==b.zOrigin&&Ne(this,b,"zOrigin",b.zOrigin,_),Ne(this,o,u,Xt(c),Xt(h)));continue}else if(u==="svgOrigin"){kr(e,h,1,k,0,this);continue}else if(u in bn){Eo(this,b,u,f,v?ot(f,v+h):h);continue}else if(u==="smoothOrigin"){Ne(this,b,"smooth",b.smooth,h);continue}else if(u==="force3D"){b[u]=h;continue}else if(u==="transform"){Oo(this,h,e);continue}}else u in o||(u=gt(u)||u);if(T||(d||d===0)&&(f||f===0)&&!ao.test(h)&&u in o)p=(c+"").substr((f+"").length),d||(d=0),_=ee(h)||(u in ue.units?ue.units[u]:p),p!==_&&(f=qe(e,u,c,_)),this._pt=new se(this._pt,T?b:o,u,f,(v?ot(f,v+d):d)-f,!T&&(_==="px"||u==="zIndex")&&t.autoRound!==!1?uo:Tr),this._pt.u=_||0,T&&w!==h?(this._pt.b=c,this._pt.e=w,this._pt.r=ho):p!==_&&_!=="%"&&(this._pt.b=c,this._pt.r=co);else if(u in o)wo.call(this,e,u,c,v?v+h:h);else if(u in e)this.add(e,u,c||e[u],v?v+h:h,i,n);else if(u!=="parseTransform"){Dr(u,h);continue}T||(u in o?S.push(u,0,o[u]):typeof e[u]=="function"?S.push(u,2,e[u]()):S.push(u,1,c||e[u])),s.push(u)}}x&&hn(this)},render:function(e,t){if(t.tween._time||!Ur())for(var r=t._pt;r;)r.r(e,r.d),r=r._next;else t.styles.revert()},get:Oe,aliases:Te,getSetter:function(e,t,r){var i=Te[t];return i&&i.indexOf(",")<0&&(t=i),t in Ie&&t!==oe&&(e._gsap.x||Oe(e,"x"))?r&&si===r?t==="scale"?mo:po:(si=r||{})&&(t==="scale"?_o:yo):e.style&&!Ar(e.style[t])?fo:~t.indexOf("-")?go:Hr(e,t)},core:{_removeProperty:He,_getMatrix:Vr}};ae.utils.checkPrefix=gt;ae.core.getStyleSaver=pn;(function(a,e,t,r){var i=ne(a+","+e+","+t,function(n){Ie[n]=1});ne(e,function(n){ue.units[n]="deg",bn[n]=1}),Te[i[13]]=a+","+e,ne(r,function(n){var s=n.split(":");Te[s[1]]=i[s[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ne("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(a){ue.units[a]="px"});ae.registerPlugin(wn);var et=ae.registerPlugin(wn)||ae;et.core.Tween;function Ao(a){return new Promise((e,t)=>{console.log("Speech function called with text:",a),window.speechSynthesis.cancel();const r=document.createElement("div");r.innerHTML=a;const i=r.textContent||r.innerText||"";console.log("Clean text for speech:",i);const n=new SpeechSynthesisUtterance(i);n.onend=()=>{console.log("Speech utterance ended"),e()},n.onerror=s=>{console.error("Speech utterance error:",s),t(s)},console.log("Starting speech after 50ms delay"),setTimeout(()=>{window.speechSynthesis.speak(n),console.log("Speech synthesis.speak() called")},50)})}function Io(a){const e=document.querySelector(a);if(!e)return;const t=e.getBoundingClientRect(),r=10,i=(t.top-r)/window.innerHeight*100,n=(t.left-r)/window.innerWidth*100,s=(t.right+r)/window.innerWidth*100,o=(t.bottom+r)/window.innerHeight*100,l=`polygon(0% 0%, 0% 100%, ${n}% 100%, ${n}% ${i}%, ${s}% ${i}%, ${s}% ${o}%, ${n}% ${o}%, ${n}% 100%, 100% 100%, 100% 0%, 0% 0%)`;et.to("#tutorial-mask",{clipPath:l,duration:.4,ease:"power2.inOut"})}function Po(){et.to("#tutorial-mask",{clipPath:"polygon(0% 0%, 0% 100%, 50% 100%, 50% 50%, 50% 50%, 50% 50%, 50% 50%, 50% 100%, 100% 100%, 100% 0%, 0% 0%)",duration:.4,ease:"power2.inOut"})}function Do(a){const e=document.querySelector(a);e&&et.to(e,{position:"relative",zIndex:2001,boxShadow:"0 0 20px 8px #33c6dc",duration:.4})}function Mo(a){const e=document.querySelector(a);e&&et.to(e,{boxShadow:"0 0 0px 0px rgba(51,198,220,0)",duration:.3,onComplete:()=>{et.set(e,{clearProps:"all"})}})}function lr(a){return new Promise(e=>{const t=y.rings[a];let r=!1;const i=()=>{if(!r)y.rings[a]!==t&&(r=!0);else if(!y.drag.active&&!y.animation){cancelAnimationFrame(n),e();return}n=requestAnimationFrame(i)};let n=requestAnimationFrame(i)})}function Ro(){console.log("=== TUTORIAL START ==="),J.toggleSidebar(!1);const a=document.getElementById("tutorial-bubble"),e=document.getElementById("tutorial-mask"),t=document.getElementById("tutorial-text");if(console.log("Tutorial elements check:",{tutorialBubble:!!a,tutorialMask:!!e,tutorialText:!!t,bubbleStyles:a?{opacity:a.style.opacity,visibility:a.style.visibility,display:getComputedStyle(a).display}:null,textStyles:t?{opacity:t.style.opacity,visibility:t.style.visibility,display:getComputedStyle(t).display,innerHTML:t.innerHTML}:null}),a&&e&&t)console.log("All tutorial elements found successfully");else{console.error("Tutorial elements missing!",{tutorialBubble:!!a,tutorialMask:!!e,tutorialText:!!t});return}window.diatonicCompassTutorial&&(console.log("Killing existing tutorial timeline"),window.diatonicCompassTutorial.kill()),console.log("Creating new GSAP timeline");const r=et.timeline({onComplete:()=>{console.log("Tutorial timeline completed"),window.diatonicCompassTutorial=null}});window.diatonicCompassTutorial=r;const i=n=>{console.log("=== ADDING STEP TO TIMELINE ===",n.text),r.call(()=>{(async()=>{console.log("=== EXECUTING STEP ===",n.text),r.pause();const s=document.getElementById("tutorial-text"),o=document.getElementById("tutorial-bubble");console.log("Tutorial elements during step execution:",{textEl:!!s,bubbleEl:!!o,textElStyles:s?{opacity:s.style.opacity,visibility:s.style.visibility,display:getComputedStyle(s).display,currentHTML:s.innerHTML}:null,bubbleElStyles:o?{opacity:o.style.opacity,visibility:o.style.visibility,display:getComputedStyle(o).display}:null}),s?(console.log("BEFORE setting text - innerHTML:",s.innerHTML),s.innerHTML=n.text,s.style.opacity="1",s.style.visibility="visible",console.log("AFTER setting text - innerHTML:",s.innerHTML),console.log("Text element computed styles after update:",{opacity:getComputedStyle(s).opacity,visibility:getComputedStyle(s).visibility,display:getComputedStyle(s).display,fontSize:getComputedStyle(s).fontSize,color:getComputedStyle(s).color})):console.error("Tutorial text element not found during step execution!"),n.highlightTarget&&(console.log("Adding highlight to:",n.highlightTarget),Io(n.highlightTarget),Do(n.highlightTarget)),console.log("Starting speech synthesis for:",n.text),await Ao(n.text),console.log("Speech synthesis completed"),n.waitFor&&(console.log("Waiting for user interaction..."),await n.waitFor(),console.log("User interaction completed")),n.highlightTarget&&(console.log("Removing highlight from:",n.highlightTarget),Mo(n.highlightTarget),Po()),await new Promise(l=>setTimeout(l,500)),console.log("Step completed, resuming timeline"),r.resume()})()})};console.log("Adding tutorial mask animation to timeline"),r.to("#tutorial-mask",{autoAlpha:1,duration:.3}),r.call(()=>{console.log("=== SHOWING TUTORIAL BUBBLE ===");const n=document.getElementById("tutorial-bubble"),s=document.getElementById("tutorial-text");console.log("Bubble show elements check:",{bubble:!!n,textEl:!!s,bubbleCurrentStyles:n?{opacity:n.style.opacity,visibility:n.style.visibility,display:getComputedStyle(n).display}:null,textCurrentStyles:s?{opacity:s.style.opacity,visibility:s.style.visibility,innerHTML:s.innerHTML}:null}),n?(console.log("Setting bubble visibility styles"),n.style.display="block",n.style.opacity="1",n.style.visibility="visible",n.setAttribute("aria-hidden","false"),console.log("Bubble styles after setting:",{opacity:n.style.opacity,visibility:n.style.visibility,computedOpacity:getComputedStyle(n).opacity,computedVisibility:getComputedStyle(n).visibility,computedDisplay:getComputedStyle(n).display}),console.log("Tutorial bubble shown successfully")):console.error("Tutorial bubble element not found during show!")}),i({text:"Welcome to the <strong>Diatonic Compass!</strong>"}),i({text:"Rotate the <strong>Pitch</strong> belt so we leave <strong>C Major.</strong>",highlightTarget:".pitch-belt",waitFor:()=>lr("pitchClass")}),i({text:"Nice! <br>Change the <strong>mode</strong> by spinning the <strong>Degree belt.</strong>",highlightTarget:".degree-belt",waitFor:()=>lr("degree")}),i({text:"Wonderful!<br>Now shift the perspective by spinning the <strong>Chromatic belt</strong>.",highlightTarget:".chromatic-belt",waitFor:()=>lr("chromatic")}),r.to("#tutorial-bubble",{bottom:"110px",duration:.3,ease:"power2.out"}),i({text:"Almost there!<br> Tap the <strong>result bar</strong> to <strong>hear your scale.</strong>",highlightTarget:"#result-container",waitFor:async()=>{await new Promise(n=>{const s=()=>y.playback.isPlaying?n():requestAnimationFrame(s);s()}),await new Promise(n=>{const s=()=>y.playback.isPlaying?requestAnimationFrame(s):n();s()})}}),r.to("#tutorial-bubble",{bottom:"20px",duration:.3,ease:"power2.in"}),i({text:"You did it!<br><strong>Enjoy exploring.</strong>"}),r.to(["#tutorial-mask","#tutorial-bubble"],{autoAlpha:0,duration:.4,delay:1}),r.call(()=>{const n=document.getElementById("tutorial-bubble");n&&(n.style.display="none",console.log("Tutorial bubble hidden"))})}class De{static hasStateChanged(e,t){return!t||e.animation!==null||e.drag.active!==null||e.playback.isPlaying!==t.playback.isPlaying||e.playback.currentNoteIndex!==t.playback.currentNoteIndex||!this._ringsEqual(e.rings,t.rings)||e.display.sharp!==t.display.sharp||e.display.flat!==t.display.flat||e.ui.darkMode!==t.ui.darkMode||e.ui.sidebarOpen!==t.ui.sidebarOpen||e.belts.orientation!==t.belts.orientation||!this._dimensionsEqual(e.dimensions,t.dimensions)}static _ringsEqual(e,t){return Math.abs(e.pitchClass-t.pitchClass)<1e-4&&Math.abs(e.degree-t.degree)<1e-4&&Math.abs(e.chromatic-t.chromatic)<1e-4&&Math.abs(e.highlightPosition-t.highlightPosition)<1e-4}static _dimensionsEqual(e,t){return e.size===t.size&&e.dpr===t.dpr}static createSnapshot(e){return{rings:{...e.rings},playback:{isPlaying:e.playback.isPlaying,currentNoteIndex:e.playback.currentNoteIndex},display:{...e.display},ui:{darkMode:e.ui.darkMode,sidebarOpen:e.ui.sidebarOpen},belts:{orientation:e.belts.orientation},dimensions:{...e.dimensions},animation:e.animation,drag:{active:e.drag.active}}}static markDirty(e){e.performance&&(e.performance.needsRedraw=!0)}static markClean(e){e.performance&&(e.performance.needsRedraw=!1,e.performance.lastRenderState=this.createSnapshot(e))}static needsRedraw(e){var t,r;return(t=e.performance)!=null&&t.needsRedraw?!0:this.hasStateChanged(e,(r=e.performance)==null?void 0:r.lastRenderState)}}const Lo=Object.freeze(Object.defineProperty({__proto__:null,StateTracker:De},Symbol.toStringTag,{value:"Module"}));function Me(a,e){if(y.rings.hasOwnProperty(a)){const t=z(e);y.rings[a]=t,De.markDirty(y)}}function Tn(a,e,t){const r=e;y.rings.chromatic=z(a.startChrom+r),y.rings.pitchClass=z(a.startPitchClass+e),y.rings.degree=z(a.startDegree+e),y.rings.highlightPosition=z(a.startHighlight+e),De.markDirty(y)}function xn(a){if(!a)return"#000000";const e=parseInt(a.slice(1,3),16),t=parseInt(a.slice(3,5),16),r=parseInt(a.slice(5,7),16);return .299*e+.587*t+.114*r>140?"#000000":"#FFFFFF"}const No={red:{solid:"red",fill:"rgba(255, 0, 0, 0.2)"},blue:{solid:"blue",fill:"rgba(0, 0, 255, 0.2)"},green:{solid:"green",fill:"rgba(0, 255, 0, 0.2)"},yellow:{solid:"#FFD700",fill:"rgba(255, 215, 0, 0.2)"}};class Bo{constructor(e,t,r){A(this,"canvas");A(this,"ctx");A(this,"state");A(this,"onInteractionEnd");A(this,"cachedLayers");this.canvas=e,this.ctx=e.getContext("2d"),this.state=t,this.onInteractionEnd=r,this.cachedLayers={outerRing:null,middleRing:null,innerRing:null,labels:null,lastSize:0},this._initInteraction()}_regenerateCachedLayers(e,t){}update(e,t,r){const{size:i,dpr:n}=this.state.dimensions;this._draw(i,n,e,t,r)}_initInteraction(){const e=r=>{const i=this.canvas.getBoundingClientRect(),{cx:n,cy:s,size:o}=this.state.dimensions,l=r.clientX-i.left-n,c=r.clientY-i.top-s,h=Math.hypot(l,c),d=o*.5,f=o*.35,g=o*.2;let m=null;return h>g&&h<f?m="degree":h>f&&h<d?m="pitchClass":h<=g&&(m="chromatic"),{x:l,y:c,ring:m}},t=()=>{if(!this.state.drag.active)return;const r=this.state.drag.active;this.state.drag.active=null,this.canvas.style.cursor="grab",r==="chromatic"?bi(this.onInteractionEnd):r==="pitchClass"?yi("pitchClass",this.onInteractionEnd):r==="degree"&&dr(this.onInteractionEnd)};this.canvas.addEventListener("pointerdown",r=>{const{x:i,y:n,ring:s}=e(r);if(!s)return;const{drag:o,rings:l}=this.state;o.active=s,o.startX=i,o.startY=n,o.startPitchClass=l.pitchClass,o.startDegree=l.degree,o.startChrom=l.chromatic,o.startHighlight=l.highlightPosition,this.canvas.setPointerCapture(r.pointerId),this.canvas.style.cursor="grabbing"}),this.canvas.addEventListener("pointermove",r=>{if(this.state.drag.active){const{x:i,y:n}=e(r),s=this.state.drag,o=Math.atan2(s.startY,s.startX),c=Math.atan2(n,i)-o;s.active==="pitchClass"?Me("pitchClass",s.startPitchClass+c):s.active==="degree"?(Me("degree",s.startDegree+c),Me("highlightPosition",s.startHighlight+c)):s.active==="chromatic"&&Tn({startPitchClass:s.startPitchClass,startDegree:s.startDegree,startChrom:s.startChrom,startHighlight:s.startHighlight},c)}else{const{ring:i}=e(r);this.canvas.style.cursor=i?"grab":"default"}}),this.canvas.addEventListener("pointerup",t),this.canvas.addEventListener("pointercancel",t),this.canvas.addEventListener("pointerleave",()=>{this.state.drag.active||(this.canvas.style.cursor="default")})}_draw(e,t,r,i,n){console.log("=== Wheel._draw CALLED ===",{size:e,dpr:t});const s=this.ctx;s.save(),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.scale(t,t);const o=e/2,l=e/2,{pitchClass:c,degree:h,chromatic:d}=r,{chromaticLabels:f,diatonicLabels:g}=i;this.cachedLayers.lastSize!==e&&(this._regenerateCachedLayers(e,t),this.cachedLayers.lastSize=e);const u=(k,x,S)=>{const w=S-X/2,O=S+X/2;s.beginPath(),s.arc(o,l,x,w,O),s.arc(o,l,k,O,w,!0),s.closePath()},p=()=>{const k=e*.5,x=e*.35;Object.keys(_t).forEach((w,O)=>{const P=O*X+c-Math.PI/2;u(x,k,P),s.fillStyle=_t[w]?"#fff":"#000",s.fill(),s.lineWidth=e*.002,s.strokeStyle="#000",s.stroke()})},_=()=>{const k=e*.35,x=e*.2;for(let S=0;S<12;S++){const w=S*X+h-Math.PI/2;u(x,k,w),s.fillStyle=hr[S]||"#e0e0e0",s.fill(),s.lineWidth=e*.002,s.strokeStyle="#000",s.stroke()}},v=()=>{s.beginPath(),s.arc(o,l,e*.2,0,Math.PI*2),s.fillStyle="#000",s.fill()},T=()=>{const k=e*.5*.85,x=e*.35*.8,S=e*.2*.8,w=Object.keys(_t),O=(R,L,N,H,j)=>{s.fillStyle=H,s.font=`${j}px 'Atkinson Hyperlegible Next'`,s.textAlign="center",s.textBaseline="middle";const Ue=o+Math.cos(R)*L,Pe=l+Math.sin(R)*L,ye=String(N);if(ye.includes("/")||ye.includes("<br>")){const ve=ye.includes("/")?ye.split("/"):ye.split("<br>"),pt=j*1.1,be=Pe-pt*(ve.length-1)/2;ve.forEach((Se,Sn)=>{s.fillText(Se,Ue,be+Sn*pt)})}else s.fillText(String(N),Ue,Pe)},P=e*Yn;f.forEach((R,L)=>{const N=w[L],H=R,j=_t[N]?"#000":"#fff";O(L*X+c-Math.PI/2,k,H,j,P)});const D=e*Gn;g.forEach((R,L)=>{const N=hr[L]||"#e0e0e0",H=xn(N),j=R;O(L*X+h-Math.PI/2,x,j,H,D)});const M=e*Xn;$n.forEach(R=>O(R*X+d-Math.PI/2,S,R.toString(),"#fff",M))},C=()=>{if(!n||!n.isPlaying||n.currentNoteIndex===null)return;const x=n.currentNoteIndex%12*X+c-Math.PI/2,S=e*.5,w=e*.2;u(w,S,x),s.fillStyle="rgba(255, 255, 0, 0.6)",s.fill()},b=()=>{const k=this.state.ui.cursorColor||"red",x=this.state.ui.cursorFill,S=No[k],w=d-Math.PI/2,O=e*.5,P=e*.12;u(P,O,w),x&&(s.fillStyle=S.fill,s.fill()),s.strokeStyle=S.solid,s.lineWidth=e*.005,s.stroke()};console.log("Drawing outer ring..."),p(),console.log("Drawing middle ring..."),_(),console.log("Drawing inner circle..."),v(),console.log("Drawing labels..."),T(),console.log("Drawing playback highlight..."),C(),console.log("Drawing tonal center marker..."),b(),console.log("Wheel drawing complete"),s.restore()}destroy(){}}class Fo{constructor(e,t,r){A(this,"container");A(this,"state");A(this,"onInteractionEnd");A(this,"elements");A(this,"cachedCells");A(this,"lastAppliedLabels");A(this,"_chromaticColorsApplied");this.container=e,this.state=t,this.onInteractionEnd=r,this.elements={pitchBelt:e.querySelector("#pitchBelt"),degreeBelt:e.querySelector("#degreeBelt"),chromaticBelt:e.querySelector("#chromaticBelt"),chromaticColorsTrack:e.querySelector("#chromatic-colors-track"),chromaticNumbersTrack:e.querySelector("#chromatic-numbers-track"),intervalBracketsTrackContainer:e.querySelector("#intervalBracketsContainer"),intervalBracketsWrapper:e.querySelector(".interval-brackets-wrapper"),intervalBrackets:null,cursor:e.querySelector("#belt-cursor"),flashOverlay:e.querySelector("#belt-flash-overlay")},this.state.belts.tracks={},this.cachedCells={pitch:null,degree:null,chromaticColors:null,chromaticNumbers:null},this.lastAppliedLabels={chromatic:null,diatonic:null},this._chromaticColorsApplied=!1,this._initInteraction()}_calculateRingAngleToBeltPixelsRatio(e){return!e||e<=0?(console.warn("Invalid beltCellWidth for ring-to-belt conversion:",e),0):ke*e/Xe}_getCellOriginalIndex(e){const t=e.dataset.originalIndex;if(t===void 0)return null;const r=Number(t);return Number.isFinite(r)?r:null}_formatLabelForCell(e,t){var n;if(!e||!e.includes("/"))return e;const r=this.state.belts.orientation,i=((n=t.closest(".belt"))==null?void 0:n.className)||"unknown";return t.dataset.originalIndex==="1"&&console.log(`🔍 Format check [${i}] (${r}):`,{label:e,orientation:r,decision:r==="vertical"?"SIDE-BY-SIDE (vertical mode)":"STACKED (horizontal mode)"}),r==="vertical"?e.replace("/"," "):e.replace("/","<br>")}update(e,t){const{orientation:r}=this.state.belts,{diatonicLabels:i,chromaticLabels:n}=e;if(console.log("=== Belts.update CALLED ===",{init:this.state.belts.init,orientation:r}),!this.state.belts.init){console.log("Belts not initialized - setting up..."),this.cachedCells={pitch:null,degree:null,chromaticColors:null,chromaticNumbers:null},this.lastAppliedLabels={chromatic:null,diatonic:null},this._chromaticColorsApplied=!1,this._setupAllBelts(i,n),requestAnimationFrame(()=>{this._calculateAllBeltCellWidths(r)&&(console.log("Belt sizes calculated, marking as initialized"),this.state.belts.init=!0,Ze(async()=>{const{StateTracker:_}=await Promise.resolve().then(()=>Lo);return{StateTracker:_}},void 0).then(({StateTracker:_})=>{_.markDirty(this.state)}))});return}console.log("Belts initialized, applying styles...");const{pitchClass:s,degree:o,chromatic:l,highlightPosition:c}=this.state.rings,{tracks:h,itemSize:d}=this.state.belts;this._applyBeltStyles(t,i,n);let f=r==="vertical"?-s:s,g=r==="vertical"?-o:o,m=r==="vertical"?-l:l,u=r==="vertical"?-c:c;this._positionBeltFromRingAngle(h.pitchBelt,f,d.pitchBelt,r),this._positionBeltFromRingAngle(h.degreeBelt,g,d.degreeBelt,r),this._positionBeltFromRingAngle(h.chromaticColors,u,d.chromaticBelt,r),this._positionBeltFromRingAngle(h.chromaticNumbers,m,d.chromaticBelt,r),this._positionIntervalBeltFromDegreeRing(g,d.degreeBelt,r),this._positionBeltCursorFromRingAngle(m,d.chromaticBelt,r),this._updatePlaybackFlashOnBelt()}_initInteraction(){const{pitchBelt:e,degreeBelt:t,chromaticNumbersTrack:r}=this.elements;e&&this._addDragHandler(e,s=>{const o=this.state.drag.startPitchClass+(this.state.belts.orientation==="vertical"?-s:s);Me("pitchClass",o)},()=>yi("pitchClass",this.onInteractionEnd));const i=s=>{const o=this.state.belts.orientation==="vertical"?-s:s;Me("degree",this.state.drag.startDegree+o),Me("highlightPosition",this.state.drag.startHighlight+o)},n=()=>{dr(this.onInteractionEnd)};t&&this._addDragHandler(t,i,n),r&&this._addDragHandler(r,s=>{const o=this.state.belts.orientation==="vertical"?-s:s,l={startPitchClass:this.state.drag.startPitchClass,startDegree:this.state.drag.startDegree,startChrom:this.state.drag.startChrom,startHighlight:this.state.drag.startHighlight};Tn(l,o)},()=>bi(this.onInteractionEnd))}_addDragHandler(e,t,r){e.style.cursor="grab";let i=null,n=0,s=0;const o=h=>{i=h.pointerId,e.setPointerCapture(i),n=h.clientX,s=h.clientY;const{drag:d,rings:f}=this.state;d.active=e.id||"belt-drag",d.startPitchClass=f.pitchClass,d.startDegree=f.degree,d.startChrom=f.chromatic,d.startHighlight=f.highlightPosition,e.style.cursor="grabbing"},l=h=>{if(i!==h.pointerId)return;const{orientation:d,itemSize:f}=this.state.belts,g=d==="vertical"?h.clientY-s:h.clientX-n;let m=null;const u=e.id||e.className||"";u.includes("pitch")?m="pitchBelt":u.includes("degree")||u.includes("interval")?m="degreeBelt":u.includes("chromatic")&&(m="chromaticBelt");const p=m?f[m]:void 0;if(!p||p===0)return;const _=g/p*X;t(_)},c=()=>{i!==null&&(e.releasePointerCapture(i),i=null,this.state.drag.active=null,e.style.cursor="grab",r())};e.addEventListener("pointerdown",o),e.addEventListener("pointermove",l),e.addEventListener("pointerup",c),e.addEventListener("pointercancel",c)}_setupAllBelts(e,t){this.elements.pitchBelt.innerHTML="",this.elements.degreeBelt.innerHTML="",this.elements.intervalBracketsTrackContainer.innerHTML="";const r=3;this.state.belts.tracks.pitchBelt=this._createBeltTrack(this.elements.pitchBelt,t,r),this.state.belts.tracks.degreeBelt=this._createBeltTrack(this.elements.degreeBelt,e,r),this._populateBeltTrack(this.elements.chromaticColorsTrack,Array(12).fill(""),r),this._populateBeltTrack(this.elements.chromaticNumbersTrack,[...Array(12).keys()],r),this.state.belts.tracks.chromaticColors=this.elements.chromaticColorsTrack,this.state.belts.tracks.chromaticNumbers=this.elements.chromaticNumbersTrack,this._createIntervalBeltTrack(r)}_createBeltTrack(e,t,r){const i=document.createElement("div");return i.className="belt-track",this._populateBeltTrack(i,t,r),e.appendChild(i),i}_populateBeltTrack(e,t,r){e.innerHTML="";const i=3,n=t.length;for(let s=0;s<r*ke+i;s++){const o=s%n,l=t[o],c=document.createElement("div");c.className="belt-cell",c.innerHTML=String(l),c.dataset.originalIndex=String(o),e.appendChild(c)}}_createIntervalBeltTrack(e){const t=document.createElement("div");t.className="interval-brackets-track";const r=3;for(let s=0;s<ke*e+r;s++){const o=s%ke,l=Ht.indexOf(o),c=document.createElement("div");if(c.className="interval-bracket-cell",l!==-1){const h=Vn[l];c.dataset.steps=String(h),c.innerHTML=`<span>+${h}</span>`}t.appendChild(c)}this.elements.intervalBracketsTrackContainer.appendChild(t),this.elements.intervalBrackets=this.elements.intervalBracketsWrapper;const i=s=>{const o=this.state.belts.orientation==="vertical"?-s:s;Me("degree",this.state.drag.startDegree+o),Me("highlightPosition",this.state.drag.startHighlight+o)},n=()=>{dr(this.onInteractionEnd)};this.elements.intervalBrackets&&this._addDragHandler(this.elements.intervalBrackets,i,n)}_calculateAllBeltCellWidths(e){return this._calculateBeltCellWidth("pitchBelt",this.elements.pitchBelt,e)&&this._calculateBeltCellWidth("degreeBelt",this.elements.degreeBelt,e)&&this._calculateBeltCellWidth("chromaticBelt",this.elements.chromaticBelt,e)&&this._calculateBeltCellWidth("intervalBracketsContainer",this.elements.intervalBracketsWrapper,e)}_calculateBeltCellWidth(e,t,r){const i=r==="vertical"?t.offsetHeight:t.offsetWidth;return i>0?(this.state.belts.itemSize[e]=i/ke,!0):!1}_applyBeltStyles(e,t,r){var g,m,u;console.log("=== _applyBeltStyles CALLED ===");const i=r.join(","),n=t.join(","),s=this.lastAppliedLabels.chromatic!==i||this.lastAppliedLabels.diatonic!==n,o=this.lastAppliedLabels.chromatic===null;!this.cachedCells.pitch&&this.state.belts.tracks.pitchBelt&&(this.cachedCells.pitch=this.state.belts.tracks.pitchBelt.querySelectorAll(".belt-cell"),console.log("Cached pitch cells:",this.cachedCells.pitch.length)),!this.cachedCells.degree&&this.state.belts.tracks.degreeBelt&&(this.cachedCells.degree=this.state.belts.tracks.degreeBelt.querySelectorAll(".belt-cell"),console.log("Cached degree cells:",this.cachedCells.degree.length)),!this.cachedCells.chromaticColors&&this.elements.chromaticColorsTrack&&(this.cachedCells.chromaticColors=this.elements.chromaticColorsTrack.querySelectorAll(".belt-cell"),console.log("Cached chromatic color cells:",this.cachedCells.chromaticColors.length)),!this.cachedCells.chromaticNumbers&&this.elements.chromaticNumbersTrack&&(this.cachedCells.chromaticNumbers=this.elements.chromaticNumbersTrack.querySelectorAll(".belt-cell"),console.log("Cached chromatic number cells:",this.cachedCells.chromaticNumbers.length)),console.log("Belt styling state:",{isFirstRun:o,labelsChanged:s,hasPitchCells:!!this.cachedCells.pitch,pitchCellCount:((g=this.cachedCells.pitch)==null?void 0:g.length)||0,hasDegreeCells:!!this.cachedCells.degree,degreeCellCount:((m=this.cachedCells.degree)==null?void 0:m.length)||0,hasChromaticColors:!!this.cachedCells.chromaticColors,chromaticColorCount:((u=this.cachedCells.chromaticColors)==null?void 0:u.length)||0});const l=(s||o)&&this.cachedCells.pitch,c=this.cachedCells.pitch&&this.cachedCells.pitch.length>0&&!this.cachedCells.pitch[0].style.background;(l||c)&&this.cachedCells.pitch?(console.log("APPLYING PITCH BELT COLORS!",{shouldUpdatePitch:l,needsInitialColors:c,cellCount:this.cachedCells.pitch.length}),this.cachedCells.pitch.forEach(p=>{const _=this._getCellOriginalIndex(p);if(_===null)return;const v=Ft[_],T=_t[v];p.style.background=T?"#fff":"#000",p.style.color=T?"#000":"#fff",p.innerHTML=this._formatLabelForCell(r[_],p)})):this.cachedCells.pitch&&s?(console.log("UPDATING PITCH LABELS ONLY"),this.cachedCells.pitch.forEach(p=>{const _=this._getCellOriginalIndex(p);_!==null&&(p.innerHTML=this._formatLabelForCell(r[_],p))})):console.log("SKIPPED pitch belt colors:",{shouldUpdatePitch:l,needsInitialColors:c,hasCells:!!this.cachedCells.pitch});const h=(s||o)&&this.cachedCells.degree,d=this.cachedCells.degree&&this.cachedCells.degree.length>0&&!this.cachedCells.degree[0].style.background;(h||d)&&this.cachedCells.degree?(console.log("APPLYING DEGREE BELT COLORS!",{shouldUpdateDegree:h,needsInitialDegreeColors:d,cellCount:this.cachedCells.degree.length}),this.cachedCells.degree.forEach(p=>{const _=this._getCellOriginalIndex(p);if(_===null)return;const v=hr[_]||"#f0f0f0";p.style.background=v,p.style.color=xn(v),p.innerHTML=this._formatLabelForCell(t[_],p)})):this.cachedCells.degree&&s?(console.log("UPDATING DEGREE LABELS ONLY"),this.cachedCells.degree.forEach(p=>{const _=this._getCellOriginalIndex(p);_!==null&&(p.innerHTML=this._formatLabelForCell(t[_],p))})):console.log("SKIPPED degree belt colors:",{shouldUpdateDegree:h,needsInitialDegreeColors:d,hasCells:!!this.cachedCells.degree});const f=this.cachedCells.chromaticColors&&this.cachedCells.chromaticColors.length>0&&!this.cachedCells.chromaticColors[0].style.background;if((!this._chromaticColorsApplied||o||f)&&this.cachedCells.chromaticColors?(console.log("APPLYING CHROMATIC COLORS!",{chromaticColorsApplied:this._chromaticColorsApplied,isFirstRun:o,needsInitialChromatic:f,cellCount:this.cachedCells.chromaticColors.length}),this.cachedCells.chromaticColors.forEach(p=>{const _=this._getCellOriginalIndex(p);_!==null&&(p.style.background=e.includes(_)?"#e0e0e0":"#4a4a4a")}),this._chromaticColorsApplied=!0):console.log("SKIPPED chromatic colors:",{chromaticColorsApplied:this._chromaticColorsApplied,isFirstRun:o,needsInitialChromatic:f,hasCells:!!this.cachedCells.chromaticColors}),this.cachedCells.chromaticNumbers){const{chromatic:p,highlightPosition:_}=this.state.rings,T=z(_-p)/X;this.cachedCells.chromaticNumbers.forEach(C=>{const b=this._getCellOriginalIndex(C);if(b===null)return;const k=Math.round((b-T+1200)%12)%12,x=e.includes(k)?"black":"lightgray";C.style.color!==x&&(C.style.color=x)})}s&&(this.lastAppliedLabels.chromatic=i,this.lastAppliedLabels.diatonic=n)}_convertRingAngleToBeltDistance(e,t,r){const i=this._calculateRingAngleToBeltPixelsRatio(t);if(i===0)return 0;const n=e*i;let s,o=0;return r==="vertical"?(s=-(t*ke),o=3*t,s-o+n):(s=-(t*ke),s+n)}_positionBeltFromRingAngle(e,t,r,i){if(!e||!r)return;const n=this._convertRingAngleToBeltDistance(t,r,i),s=i==="vertical"?`translateY(${n}px)`:`translateX(${n}px)`;e.style.transform=s}_positionIntervalBeltFromDegreeRing(e,t,r){const i=this.elements.intervalBracketsTrackContainer;if(!i||!t)return;const n=i.querySelector(".interval-brackets-track");if(!n)return;let s=this._convertRingAngleToBeltDistance(e,t,r);r==="horizontal"&&(s+=.5*t);const o=r==="vertical"?`translateY(${s}px)`:`translateX(${s}px)`;n.style.transform=o}_positionBeltCursorFromRingAngle(e,t,r){const i=this.elements.cursor;if(console.log("=== Positioning belt cursor ===",{hasCursor:!!i,beltCellWidth:t,orientation:r,chromaticRingAngle:e}),!i||!t){console.warn("Cannot position cursor - missing element or cell width");return}this._updateBeltCursorColors(i);const n=this._calculateRingAngleToBeltPixelsRatio(t);if(n===0){console.warn("Cannot position cursor - invalid pixel ratio");return}const s=e*n;let o;if(r==="vertical"){const c=-ke*t;o=(s%c+c)%c}else o=s;const l=r==="vertical"?`translateY(${o}px)`:`translateX(${o}px)`;i.style.transform=l,console.log("Belt cursor positioned:",{transform:l,cursorBeltPosition:o})}_updateBeltCursorColors(e){const t=this.state.ui.cursorColor||"red",r=this.state.ui.cursorFill,n={red:{solid:"red",fill:"rgba(255, 0, 0, 0.2)"},blue:{solid:"blue",fill:"rgba(0, 0, 255, 0.2)"},green:{solid:"green",fill:"rgba(0, 255, 0, 0.2)"},yellow:{solid:"#FFD700",fill:"rgba(255, 215, 0, 0.2)"}}[t];e.style.borderColor=n.solid,e.style.background=r?n.fill:"transparent"}_updatePlaybackFlashOnBelt(){const{rings:e,playback:t,belts:r}=this.state,i=this.elements.flashOverlay,n=r.itemSize.chromaticBelt,s=r.orientation;if(!i)return;if(!n||!t.isPlaying||t.currentNoteIndex===null||t.rootNoteIndexForPlayback===null){i.style.display="none";return}const o=this._calculateRingAngleToBeltPixelsRatio(n);if(o===0){i.style.display="none";return}let l;if(s==="vertical"){const h=-e.chromatic,d=(t.currentNoteIndex-t.rootNoteIndexForPlayback)*X,g=(h-d)*o,m=-ke*n;l=(g%m+m)%m}else l=(e.chromatic+(t.currentNoteIndex-t.rootNoteIndexForPlayback)*X)*o;const c=s==="vertical"?`translateY(${l}px)`:`translateX(${l}px)`;i.style.transform=c,i.style.display="block"}destroy(){}}const cr=["pitch","degree","intervals","chromatic"];class zo{constructor(){A(this,"container");A(this,"draggedItem");A(this,"dragOverItem");A(this,"onOrderChange");A(this,"touchStartY");A(this,"touchStartX");A(this,"isDraggingTouch");A(this,"touchScrollThreshold");A(this,"dragGhost");this.container=null,this.draggedItem=null,this.dragOverItem=null,this.onOrderChange=null,this.touchStartY=0,this.touchStartX=0,this.isDraggingTouch=!1,this.touchScrollThreshold=10,this.dragGhost=null,this.init()}init(){try{if(this.container=document.getElementById("belt-order-list"),!this.container)throw new Error("Order list container not found");this._setupEventListeners(),this._loadSavedOrder(),this._updateDisplay()}catch(e){E.handle(e,"OrderManager",()=>{console.error("Failed to initialize Order Manager")})}}_setupEventListeners(){this.container&&(this.container.addEventListener("dragstart",this._handleDragStart.bind(this)),this.container.addEventListener("dragover",this._handleDragOver.bind(this)),this.container.addEventListener("dragenter",this._handleDragEnter.bind(this)),this.container.addEventListener("dragleave",this._handleDragLeave.bind(this)),this.container.addEventListener("drop",this._handleDrop.bind(this)),this.container.addEventListener("dragend",this._handleDragEnd.bind(this)),this.container.addEventListener("touchstart",this._handleTouchStart.bind(this),{passive:!1}),this.container.addEventListener("touchmove",this._handleTouchMove.bind(this),{passive:!1}),this.container.addEventListener("touchend",this._handleTouchEnd.bind(this),{passive:!1}),this.container.addEventListener("touchcancel",this._handleTouchEnd.bind(this),{passive:!1}))}_handleDragStart(e){console.log("Drag start event triggered",e.target);const t=e.target;if(!t||!t.classList.contains("drag-handle")){console.log("Not a drag-handle, ignoring");return}if(this.draggedItem=t.closest(".order-item"),!this.draggedItem){console.log("No parent order-item found, ignoring");return}this.draggedItem.classList.add("dragging"),console.log("Dragging item:",this.draggedItem.dataset.component),e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.draggedItem.outerHTML),setTimeout(()=>{this.draggedItem&&(this.draggedItem.style.opacity="0")},1))}_handleDragOver(e){e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="move")}_handleDragEnter(e){const t=e.target;t!=null&&t.classList.contains("order-item")&&t!==this.draggedItem&&(this.dragOverItem=t,t.classList.add("drag-over"),this._animateReorder(t))}_handleDragLeave(e){const t=e.target;t!=null&&t.classList.contains("order-item")&&t.classList.remove("drag-over")}_handleDrop(e){if(e.preventDefault(),console.log("Drop event triggered"),!this.draggedItem||!this.dragOverItem||this.dragOverItem===this.draggedItem){console.log("Drop cancelled - no valid target");return}const t=this.draggedItem.dataset.component,r=this.dragOverItem.dataset.component;if(!t||!r){console.log("Drop cancelled - missing component id");return}console.log(`Dropping ${t} onto ${r}`),this._reorderComponents(t,r),this._saveOrder(),this._updateDisplay(),this._applyComponentOrder()}_handleDragEnd(e){this.container&&(this.draggedItem&&(this.draggedItem.classList.remove("dragging"),this.draggedItem.style.opacity=""),this.container.querySelectorAll(".drag-over").forEach(t=>{t.classList.remove("drag-over")}),this._resetAnimations(),this.draggedItem=null,this.dragOverItem=null)}_reorderComponents(e,t){const r=y.belts.orientation,i=[...y.belts.layoutOrder[r]];r==="vertical"?this._reorderVerticalLayout(e,t,i):this._reorderHorizontalLayout(e,t,i)}_reorderHorizontalLayout(e,t,r){const i=r.indexOf(e),n=r.indexOf(t);if(console.log("=== HORIZONTAL REORDER DEBUG ===",{draggedId:e,targetId:t,currentOrder:[...r],draggedIndex:i,targetIndex:n}),i===-1||n===-1){console.log("Invalid indices - horizontal reorder cancelled");return}r.splice(i,1);const s=i<n?n-1:n;console.log("Horizontal reorder calculation:",{afterRemoval:[...r],adjustedTargetIndex:s,calculation:`${i} < ${n} ? ${n-1} : ${n}`,explanation:i<n?"Moving forward: target shifted down after removal":"Moving backward: target index unchanged"}),r.splice(s,0,e),console.log("Final horizontal order:",[...r]),y.belts.layoutOrder.horizontal=r}_reorderVerticalLayout(e,t,r){if(console.log("=== VERTICAL REORDER DEBUG ===",{draggedId:e,targetId:t,currentOrder:r,isCompassInvolved:e==="compass"||t==="compass"}),e==="compass"||t==="compass"){const i=cr;let n=t,s=e;i.includes(t)&&(n="result",console.log(`Converting belt target '${t}' to 'result'`)),i.includes(e)&&(s="result",console.log(`Converting belt dragged '${e}' to 'result'`));const o=r.indexOf(s),l=r.indexOf(n);if(console.log("Compass reorder indices:",{draggedIndex:o,targetIndex:l,actualDraggedId:s,actualTargetId:n}),o!==-1&&l!==-1&&o!==l){r.splice(o,1);let c;s==="compass"&&i.includes(t)?(c=r.length,console.log("Placing compass after result group at index:",c)):(c=o<l?l-1:l,console.log("Normal reorder to index:",c)),r.splice(c,0,s),y.belts.layoutOrder.vertical=r,console.log("New vertical layout order:",r)}else console.log("Invalid indices or same position - reorder cancelled")}else console.log("Belt reorder within result group"),cr.includes(e)&&cr.includes(t)&&this._reorderBelts(e,t)}_reorderBelts(e,t){const r=[...y.belts.order],i=r.indexOf(e),n=r.indexOf(t);if(console.log("=== BELT REORDER DEBUG ===",{draggedBelt:e,targetBelt:t,currentOrder:[...r],draggedIndex:i,targetIndex:n}),i===-1||n===-1)return;r.splice(i,1);const s=i<n?n-1:n;console.log("Belt reorder calculation:",{afterRemoval:[...r],adjustedTargetIndex:s,calculation:`${i} < ${n} ? ${n-1} : ${n}`,explanation:i<n?"Moving forward: target shifted down after removal":"Moving backward: target index unchanged"}),r.splice(s,0,e),console.log("Final belt order:",[...r]),y.belts.order=r}_updateDisplay(){if(!this.container)return;const e=y.belts.orientation,t=this.container;t&&(t.innerHTML="",e==="horizontal"?this._renderHorizontalLayout():this._renderVerticalLayout())}_renderHorizontalLayout(){const e=this.container;if(!e)return;y.belts.layoutOrder.horizontal.forEach(r=>{const i=this._createOrderItem(r,this._getComponentLabel(r));e.appendChild(i)})}_renderVerticalLayout(){const e=this.container;if(!e)return;const t=y.belts.layoutOrder.vertical;console.log("=== RENDERING VERTICAL LAYOUT ===",{order:t,beltOrder:y.belts.order}),t.forEach((r,i)=>{if(console.log(`Rendering component ${i}: ${r}`),r==="result"){const n=this._createOrderItem("result","Mode Name",!0);e.appendChild(n),console.log("Added result group item"),y.belts.order.forEach((s,o)=>{const l=this._createOrderItem(s,this._getComponentLabel(s),!1,!0);e.appendChild(l),console.log(`Added nested belt item ${o}: ${s}`)})}else{const n=this._createOrderItem(r,this._getComponentLabel(r));e.appendChild(n),console.log(`Added regular item: ${r}`)}}),console.log("Final sidebar structure:",Array.from(e.children).map(r=>{var n;const i=r;return{className:i.className,textContent:((n=i.textContent)==null?void 0:n.trim())||"",dataComponent:i.dataset.component}}))}_createOrderItem(e,t,r=!1,i=!1){const n=document.createElement("div");n.className=`order-item${r?" group":""}${i?" nested":""}`,n.draggable=!1,n.dataset.component=e;const s=document.createElement("span");s.className="drag-handle",s.textContent="⋮⋮",s.draggable=!0;const o=document.createElement("span");if(o.className="component-label",o.textContent=t,i){const l=document.createElement("span");l.className="nested-indent",l.textContent="  ",n.appendChild(l)}return n.appendChild(s),n.appendChild(o),n}_getComponentLabel(e){return{compass:"Compass",result:"Mode Name",pitch:"Pitch",degree:"Degrees",intervals:"Intervals",chromatic:"Chromatic"}[e]}_saveOrder(){try{const e=Tt()||{};e.layoutOrder=y.belts.layoutOrder,e.beltOrder=y.belts.order,Kt(e)}catch(e){console.warn("Failed to save order preferences:",e)}}_loadSavedOrder(){try{const e=Tt();e&&e.layoutOrder&&(y.belts.layoutOrder=e.layoutOrder),e&&e.beltOrder&&(y.belts.order=e.beltOrder)}catch(e){console.warn("Failed to load order preferences:",e)}}_applyComponentOrder(){this.onOrderChange&&this.onOrderChange(y.belts.layoutOrder,y.belts.order)}setOrderChangeCallback(e){this.onOrderChange=e}onOrientationChange(){this._updateDisplay()}_animateReorder(e){if(!this.container||!this.draggedItem||!e)return;const t=this.draggedItem,r=Array.from(this.container.querySelectorAll(".order-item")),i=r.indexOf(t),n=r.indexOf(e);if(i===-1||n===-1)return;const s=i>n;r.forEach((o,l)=>{if(o===t)return;let c=0;s?l>=n&&l<i&&(c=t.offsetHeight+8):l>i&&l<=n&&(c=-(t.offsetHeight+8)),o.style.transform=`translateY(${c}px)`,o.style.transition="transform 0.2s ease"})}_resetAnimations(){if(!this.container)return;this.container.querySelectorAll(".order-item").forEach(t=>{t.style.transform="",t.style.transition=""})}_createDragGhost(e,t,r){const i=e.cloneNode(!0);return i.classList.add("drag-ghost"),i.style.position="fixed",i.style.pointerEvents="none",i.style.zIndex="9999",i.style.opacity="0.8",i.style.width=e.offsetWidth+"px",i.style.left=t-e.offsetWidth/2+"px",i.style.top=r-e.offsetHeight/2+"px",i.style.transform="rotate(-2deg)",i.style.transition="none",document.body.appendChild(i),i}_updateDragGhost(e,t){this.dragGhost&&(this.dragGhost.style.left=e-this.dragGhost.offsetWidth/2+"px",this.dragGhost.style.top=t-this.dragGhost.offsetHeight/2+"px")}_removeDragGhost(){this.dragGhost&&(this.dragGhost.remove(),this.dragGhost=null)}_handleTouchStart(e){const t=e.target;if(!t||!t.classList.contains("drag-handle"))return;const r=e.touches[0];this.touchStartY=r.clientY,this.touchStartX=r.clientX,this.isDraggingTouch=!1,this.draggedItem=t.closest(".order-item"),this.draggedItem&&console.log("Touch start on drag handle:",this.draggedItem.dataset.component)}_handleTouchMove(e){if(!this.draggedItem)return;const t=e.touches[0],r=Math.abs(t.clientY-this.touchStartY),i=Math.abs(t.clientX-this.touchStartX);if(!this.isDraggingTouch&&(r>this.touchScrollThreshold||i>this.touchScrollThreshold)&&(this.isDraggingTouch=!0,this.draggedItem.classList.add("dragging"),e.preventDefault(),this.dragGhost=this._createDragGhost(this.draggedItem,t.clientX,t.clientY),console.log("Started touch dragging")),this.isDraggingTouch){e.preventDefault(),this._updateDragGhost(t.clientX,t.clientY);const n=document.elementFromPoint(t.clientX,t.clientY),s=(n==null?void 0:n.closest(".order-item"))??null;s&&s!==this.draggedItem&&(this.dragOverItem&&this.dragOverItem!==s&&this.dragOverItem.classList.remove("drag-over"),this.dragOverItem=s,s.classList.add("drag-over"),this._animateReorder(s))}}_handleTouchEnd(e){if(this.draggedItem){if(this.isDraggingTouch){if(e.preventDefault(),console.log("Touch drag ended"),this.dragOverItem&&this.dragOverItem!==this.draggedItem){const t=this.draggedItem.dataset.component,r=this.dragOverItem.dataset.component;if(!t||!r)return;console.log(`Touch dropping ${t} onto ${r}`),this._reorderComponents(t,r),this._saveOrder(),this._updateDisplay(),this._applyComponentOrder()}this._removeDragGhost()}this.draggedItem&&this.draggedItem.classList.remove("dragging"),this.dragOverItem&&this.dragOverItem.classList.remove("drag-over"),this._resetAnimations(),this.draggedItem=null,this.dragOverItem=null,this.isDraggingTouch=!1}}destroy(){this.container&&(this.container.removeEventListener("dragstart",this._handleDragStart.bind(this)),this.container.removeEventListener("dragover",this._handleDragOver.bind(this)),this.container.removeEventListener("dragenter",this._handleDragEnter.bind(this)),this.container.removeEventListener("dragleave",this._handleDragLeave.bind(this)),this.container.removeEventListener("drop",this._handleDrop.bind(this)),this.container.removeEventListener("dragend",this._handleDragEnd.bind(this)))}}class Ho{constructor(e,t,r){A(this,"state");A(this,"callbacks");A(this,"elements");A(this,"orderManager");A(this,"_lastOrientation");this.state=t,this.callbacks=r,this.orderManager=null,this._lastOrientation=null,this.elements={resultContainer:e.querySelector("#result-container"),resultText:e.querySelector("#result-text"),flatBtn:document.getElementById("flat-btn"),sharpBtn:document.getElementById("sharp-btn"),settingsBtn:document.getElementById("settings-btn"),sidebar:document.getElementById("sidebar"),sidebarOverlay:document.getElementById("sidebar-overlay"),orientationHorizontal:document.getElementById("orientation-horizontal"),orientationVertical:document.getElementById("orientation-vertical"),themeLight:document.getElementById("theme-light"),themeDark:document.getElementById("theme-dark"),startTutorialBtn:document.getElementById("start-tutorial-btn")},this._initListeners(),this._initBeltOrderManager(),this._loadSavedPreferences()}_initListeners(){this.elements.flatBtn.addEventListener("click",this.callbacks.onToggleFlat),this.elements.sharpBtn.addEventListener("click",this.callbacks.onToggleSharp),this.elements.resultContainer.addEventListener("click",i=>{const n=i.target;n!=null&&n.closest("button")||this.callbacks.onTogglePlayback()}),this.elements.settingsBtn.addEventListener("click",i=>{i.stopPropagation(),this.callbacks.onToggleSidebar()}),this.elements.sidebarOverlay.addEventListener("click",()=>{this.state.ui.sidebarOpen&&this.callbacks.onToggleSidebar(!1)}),this.elements.orientationHorizontal.addEventListener("change",()=>{this.elements.orientationHorizontal.checked&&this.callbacks.onToggleOrientation("horizontal")}),this.elements.orientationVertical.addEventListener("change",()=>{this.elements.orientationVertical.checked&&this.callbacks.onToggleOrientation("vertical")}),this.elements.themeLight.addEventListener("change",()=>{this.elements.themeLight.checked&&this.callbacks.onToggleDarkMode(!1)}),this.elements.themeDark.addEventListener("change",()=>{this.elements.themeDark.checked&&this.callbacks.onToggleDarkMode(!0)}),this.elements.startTutorialBtn.addEventListener("click",this.callbacks.onStartTutorial);const e=document.querySelectorAll(".cursor-color-btn");e.forEach(i=>{i.addEventListener("click",()=>{const n=i.dataset.color,s=i.dataset.fill==="true";e.forEach(o=>{o.classList.remove("active"),o.setAttribute("aria-checked","false")}),i.classList.add("active"),i.setAttribute("aria-checked","true"),this.callbacks.onSetCursorColor&&this.callbacks.onSetCursorColor(n,s)})});const t=document.getElementById("orientation-toggle"),r=document.getElementById("theme-toggle");t&&t.addEventListener("click",i=>{console.log("Orientation toggle clicked",i.target);const n=this.elements.orientationHorizontal.checked;console.log("Current orientation horizontal checked:",n),n?(console.log("Switching to vertical"),this.callbacks.onToggleOrientation("vertical")):(console.log("Switching to horizontal"),this.callbacks.onToggleOrientation("horizontal"))}),r&&r.addEventListener("click",i=>{console.log("Theme toggle clicked",i.target);const n=this.elements.themeLight.checked;console.log("Current theme light checked:",n),n?(console.log("Switching to dark mode"),this.callbacks.onToggleDarkMode(!0)):(console.log("Switching to light mode"),this.callbacks.onToggleDarkMode(!1))})}_initBeltOrderManager(){try{this.orderManager=new zo,this.orderManager.setOrderChangeCallback((e,t)=>{this.callbacks.onOrderChange&&this.callbacks.onOrderChange(e,t)})}catch(e){console.warn("Order Manager failed to initialize:",e)}}async _loadSavedPreferences(){try{const{loadPreferences:e}=await Ze(async()=>{const{loadPreferences:r}=await Promise.resolve().then(()=>Ti);return{loadPreferences:r}},void 0),t=e();t&&t.cursorColor&&t.cursorFill!==void 0&&(this.state.ui.cursorColor=t.cursorColor,this.state.ui.cursorFill=t.cursorFill,document.querySelectorAll(".cursor-color-btn").forEach(i=>{const n=i.dataset.color===t.cursorColor,s=i.dataset.fill===String(t.cursorFill),o=n&&s;i.classList.toggle("active",o),i.setAttribute("aria-checked",String(o))}))}catch(e){console.warn("Could not load saved cursor preferences:",e)}}update(){const{display:e,playback:t,ui:r,belts:i}=this.state,{resultContainer:n,flatBtn:s,sharpBtn:o,resultText:l,sidebar:c,sidebarOverlay:h,settingsBtn:d,orientationHorizontal:f,orientationVertical:g,themeLight:m,themeDark:u}=this.elements;s.classList.toggle("active",e.flat),o.classList.toggle("active",e.sharp),s.setAttribute("aria-pressed",String(e.flat)),o.setAttribute("aria-pressed",String(e.sharp)),n.classList.toggle("playback-active",t.isPlaying),ns(this.state,l);const p=i.orientation==="horizontal";f.checked=p,g.checked=!p,m.checked=!r.darkMode,u.checked=r.darkMode;const _=r.sidebarOpen;c.classList.toggle("open",_),_?c.removeAttribute("aria-hidden"):c.setAttribute("aria-hidden","true"),h.classList.toggle("visible",_),d.setAttribute("aria-expanded",String(_)),this.orderManager&&this._lastOrientation!==i.orientation&&(this.orderManager.onOrientationChange(),this._lastOrientation=i.orientation)}destroy(){this.orderManager&&(this.orderManager.destroy(),this.orderManager=null)}}class qo{constructor(e){A(this,"container");A(this,"state");A(this,"isInitialized");A(this,"cleanupFunctions");A(this,"performanceMonitor");A(this,"keyboardManager");A(this,"screenReaderManager");A(this,"elements");A(this,"wheel");A(this,"belts");A(this,"uiControls");this.container=e,this.state=y,this.isInitialized=!1,this.cleanupFunctions=[],this.performanceMonitor=null,this.keyboardManager=null,this.screenReaderManager=null,this.wheel=null,this.belts=null,this.uiControls=null;try{this._initializeApp()}catch(t){E.handle(t,"App",()=>{console.error("Failed to initialize app")})}}_initializeApp(){this.elements={canvas:this.container.querySelector("#chromaWheel"),beltsContainer:this.container.querySelector(".belts-container")};const{canvas:e,beltsContainer:t}=this.elements;if(!e)throw new Error("Canvas element not found");if(!t)throw new Error("Belts container not found");const r={onToggleFlat:E.wrap(()=>{J.toggleAccidental("flat"),this._announceChange(`Flat names ${this.state.display.flat?"enabled":"disabled"}`)},"UI"),onToggleSharp:E.wrap(()=>{J.toggleAccidental("sharp"),this._announceChange(`Sharp names ${this.state.display.sharp?"enabled":"disabled"}`)},"UI"),onToggleDarkMode:E.wrap(i=>{typeof i=="boolean"?this.state.ui.darkMode!==i&&J.toggleDarkMode():J.toggleDarkMode(),this._announceChange(`${this.state.ui.darkMode?"Dark":"Light"} mode enabled`)},"UI"),onTogglePlayback:E.wrap(()=>{J.togglePlayback(),this._announceChange(this.state.playback.isPlaying?"Scale playing":"Playback stopped")},"UI"),onToggleSidebar:E.wrap(i=>{J.toggleSidebar(i),this._announceChange(`Settings ${this.state.ui.sidebarOpen?"opened":"closed"}`)},"UI"),onToggleOrientation:E.wrap(i=>{let n;typeof i=="string"?n=i:n=this.state.belts.orientation==="horizontal"?"vertical":"horizontal",this.state.belts.orientation!==n&&(J.setOrientation(n),this._announceChange(`Layout changed to ${n}`))},"UI"),onStartTutorial:E.wrap(()=>{this._announceChange("Tutorial started"),Ro()},"Tutorial"),onShowKeyboardHelp:E.wrap(()=>{this._showKeyboardHelp()},"UI"),onOrderChange:E.wrap((i,n)=>{console.log("Order change triggered:",{layoutOrder:i,beltOrder:n}),this._applyComponentOrder(i,n)},"UI"),onSetCursorColor:E.wrap((i,n)=>{J.setCursorColor(i,n),this._announceChange(`Cursor color changed to ${i}${n?" with fill":""}`)},"UI")};try{this.wheel=new Bo(e,this.state,this.onInteractionEnd.bind(this))}catch(i){E.handle(i,"Wheel",()=>{console.error("Wheel component failed to initialize")})}try{this.belts=new Fo(t,this.state,this.onInteractionEnd.bind(this))}catch(i){E.handle(i,"Belts",()=>{console.error("Belts component failed to initialize")})}try{this.uiControls=new Ho(this.container,this.state,r)}catch(i){E.handle(i,"UIControls",()=>{console.error("UI Controls failed to initialize")})}this._initializeAccessibility(),this._setupResponsiveLogic();try{zn(E.wrap(this.redraw.bind(this),"RenderLoop"))}catch(i){E.handle(i,"RenderLoop",()=>{console.error("Render loop failed to start")})}this._setupPerformanceMonitoring(),this._setupAccessibilityMonitoring(),De.markDirty(this.state),this.isInitialized=!0}_initializeAccessibility(){try{this._loadAccessibilityModules().then(()=>{console.log("Accessibility features loaded")}).catch(()=>{console.log("Using basic accessibility features"),this._setupBasicAccessibility()})}catch(e){E.handle(e,"Accessibility",()=>{console.warn("Some accessibility features may not be available"),this._setupBasicAccessibility()})}}async _loadAccessibilityModules(){try{const{KeyboardManager:e}=await Ze(async()=>{const{KeyboardManager:r}=await import("./KeyboardManager-CW2gBYTO.js");return{KeyboardManager:r}},[]),{ScreenReaderManager:t}=await Ze(async()=>{const{ScreenReaderManager:r}=await import("./ScreenReaderManager-xThtuh_I.js");return{ScreenReaderManager:r}},[]);return e.init(),t.init(),this.keyboardManager=e,this.screenReaderManager=t,!0}catch{throw new Error("Accessibility modules not available")}}_setupBasicAccessibility(){this._setupBasicKeyboard(),this._setupBasicARIA(),this._setupBasicAnnouncements()}_setupBasicKeyboard(){const e=t=>{if(this._isTextInputActive()||t.ctrlKey||t.altKey||t.metaKey)return;const r=t.target;switch(t.key){case"ArrowLeft":((r==null?void 0:r.id)==="chromaWheel"||r!=null&&r.closest(".belt"))&&(t.preventDefault(),this._rotateRing("pitchClass",-1),this._announceChange("Pitch ring rotated left"));break;case"ArrowRight":((r==null?void 0:r.id)==="chromaWheel"||r!=null&&r.closest(".belt"))&&(t.preventDefault(),this._rotateRing("pitchClass",1),this._announceChange("Pitch ring rotated right"));break;case"ArrowUp":((r==null?void 0:r.id)==="chromaWheel"||r!=null&&r.closest(".belt"))&&(t.preventDefault(),this._rotateRing("pitchClass",1),this._announceChange("Pitch ring rotated up"));break;case"ArrowDown":((r==null?void 0:r.id)==="chromaWheel"||r!=null&&r.closest(".belt"))&&(t.preventDefault(),this._rotateRing("pitchClass",-1),this._announceChange("Pitch ring rotated down"));break;case" ":case"Enter":!(r!=null&&r.closest("button"))&&!(r!=null&&r.closest("input"))&&!(r!=null&&r.closest("select"))&&(t.preventDefault(),J.togglePlayback());break;case"Escape":J.toggleSidebar(),this._announceChange(this.state.ui.sidebarOpen?"Settings opened":"Settings closed");break;case"f":case"F":t.preventDefault(),J.toggleAccidental("flat"),this._announceChange(`Flat names ${this.state.display.flat?"enabled":"disabled"}`);break;case"s":case"S":t.preventDefault(),J.toggleAccidental("sharp"),this._announceChange(`Sharp names ${this.state.display.sharp?"enabled":"disabled"}`);break;case"v":case"V":t.preventDefault();const i=this.state.belts.orientation==="horizontal"?"vertical":"horizontal";J.setOrientation(i),this._announceChange(`Layout changed to ${i}`);break}};document.addEventListener("keydown",e),this.cleanupFunctions.push(()=>{document.removeEventListener("keydown",e)})}_rotateRing(e,t){const r=t*(Math.PI*2/12),n=(this.state.rings[e]+r)%(Math.PI*2);J.setRingAngle(e,n)}_isTextInputActive(){const e=document.activeElement;return["INPUT","TEXTAREA","SELECT"].includes((e==null?void 0:e.tagName)||"")||(e==null?void 0:e.contentEditable)==="true"}_applyComponentOrder(e,t){console.log("Applying component order:",{layoutOrder:e,beltOrder:t});const r=this.state.belts.orientation,i=e[r];console.log(`Current orientation: ${r}, order:`,i);let n=this.container.querySelector(".main-container");n||(n=document.querySelector(".main-container")),n&&this._restoreOriginalStructure(n),r==="horizontal"?(console.log("Calling _applyHorizontalOrder"),this._applyHorizontalOrder(i)):(console.log("Calling _applyVerticalOrder"),this._applyVerticalOrder(i)),t&&(console.log("Applying belt order:",t),this._applyBeltOrder(t))}_applyHorizontalOrder(e){console.log("_applyHorizontalOrder called with order:",e);let t=this.container.querySelector(".main-container");if(t||(t=document.querySelector(".main-container")),!t){console.log("ERROR: main-container not found anywhere"),console.log("this.container is:",this.container);return}console.log("Container element:",t),console.log("Container classes:",t.className),console.log("Container computed styles before:",{display:getComputedStyle(t).display,flexDirection:getComputedStyle(t).flexDirection,width:getComputedStyle(t).width,height:getComputedStyle(t).height});const r=t.querySelector(".belts-container"),i={compass:t.querySelector(".wheel-container"),result:t.querySelector("#result-container"),pitch:(r==null?void 0:r.querySelector(".pitch-belt"))||null,degree:(r==null?void 0:r.querySelector(".degree-belt"))||null,intervals:(r==null?void 0:r.querySelector(".interval-brackets-wrapper"))||null,chromatic:(r==null?void 0:r.querySelector(".chromatic-belt"))||null};console.log("Found components:",Object.keys(i).reduce((o,l)=>(o[l]=!!i[l],o),{})),console.log("Components dimensions before flattening:",{compass:i.compass?{width:i.compass.offsetWidth,height:i.compass.offsetHeight,display:getComputedStyle(i.compass).display}:null,beltsContainer:r?{width:r.offsetWidth,height:r.offsetHeight,display:getComputedStyle(r).display}:null});const n=["pitch","degree","intervals","chromatic"],s=[];n.forEach(o=>{const l=i[o];l&&(l._originalParent=l.parentNode,l._originalNextSibling=l.nextSibling,t.appendChild(l),s.push(l))}),r&&(r.style.display="none"),console.log("After flattening, container children:",Array.from(t.children).map(o=>{const l=o;return{tagName:l.tagName,className:l.className,id:l.id,display:getComputedStyle(l).display,flex:getComputedStyle(l).flex,width:l.offsetWidth,height:l.offsetHeight}})),e.forEach((o,l)=>{const c=i[o];c&&(c.style.setProperty("order",String(l+1),"important"),console.log(`Set order ${l+1} for component:`,o),console.log("Element after order applied:",{width:c.offsetWidth,height:c.offsetHeight,display:getComputedStyle(c).display,flex:getComputedStyle(c).flex,order:getComputedStyle(c).order}))}),console.log("Container computed styles after:",{display:getComputedStyle(t).display,flexDirection:getComputedStyle(t).flexDirection,width:getComputedStyle(t).width,height:getComputedStyle(t).height}),t._isFlattened=!0,t._beltElements=s,t._beltsContainer=r}_applyVerticalOrder(e){let t=this.container.querySelector(".main-container");if(t||(t=document.querySelector(".main-container")),!t)return;this._restoreOriginalStructure(t);const r=e.indexOf("compass"),i=e.indexOf("result");console.log("Vertical layout indices:",{order:e,compassIndex:r,resultIndex:i,compassFirst:r<i}),r>i?(t.style.gridTemplateAreas=`
        "wheel belts"
        "wheel result"
      `,console.log("Applied vertical order: compass left, belts right (compass after result)")):(t.style.gridTemplateAreas=`
        "belts wheel"
        "result wheel"
      `,console.log("Applied vertical order: belts left, compass right (compass before result)"))}_restoreOriginalStructure(e){e._isFlattened&&(console.log("Restoring original DOM structure"),e._beltElements&&e._beltsContainer&&(e._beltElements.forEach(t=>{t.style.removeProperty("order");const r=t._originalParent;r&&(t._originalNextSibling?r.insertBefore(t,t._originalNextSibling):r.appendChild(t),delete t._originalParent,delete t._originalNextSibling)}),e._beltsContainer.style.display=""),delete e._isFlattened,delete e._beltElements,delete e._beltsContainer)}_applyBeltOrder(e){const t=this.elements.beltsContainer;if(!t)return;const r={pitch:t.querySelector(".pitch-belt"),degree:t.querySelector(".degree-belt"),intervals:t.querySelector(".interval-brackets-wrapper"),chromatic:t.querySelector(".chromatic-belt")};e.forEach((i,n)=>{const s=r[i];s&&(s.style.setProperty("order",String(n+1),"important"),console.log(`Set belt order ${n+1} for belt:`,i))})}_setupBasicARIA(){this.container.setAttribute("role","main"),this.container.setAttribute("aria-label","Diatonic Compass Music Theory Tool"),this.elements.canvas&&(this.elements.canvas.setAttribute("tabindex","0"),this.elements.canvas.setAttribute("role","application"),this.elements.canvas.setAttribute("aria-label","Interactive Diatonic Compass - use arrow keys to explore"));const e=document.querySelector("#result-container");e&&(e.setAttribute("tabindex","0"),e.setAttribute("aria-label","Current musical key and mode - click to play"))}_setupBasicAnnouncements(){const e=document.createElement("div");e.id="basic-announcements",e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","false"),e.style.cssText=`
      position: absolute;
      left: -10000px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    `,document.body.appendChild(e),this.cleanupFunctions.push(()=>{e.parentNode&&e.parentNode.removeChild(e)})}_announceChange(e){const t=document.getElementById("basic-announcements");t&&(t.textContent="",setTimeout(()=>{t.textContent=e},100)),this.screenReaderManager&&this.screenReaderManager.queueAnnouncement(e)}_showKeyboardHelp(){const e=`
Keyboard Shortcuts:
- Tab: Navigate between controls
- Arrow keys: Rotate pitch ring (when focused on wheel/belts)
- Ctrl + arrows: Large steps (when focused on wheel/belts)
- Space/Enter: Play scale (when focused on wheel/result)
- F: Toggle flat note names
- S: Toggle sharp note names  
- V: Toggle vertical/horizontal layout
- H: Show this help
- Escape: Open/close settings

Focus the wheel or belts first, then use arrow keys to rotate rings.
    `.trim();alert(e)}_setupAccessibilityMonitoring(){const e=window.matchMedia("(prefers-reduced-motion: reduce)"),t=n=>{document.body.classList.toggle("reduced-motion",n.matches)};e.addListener(t),t(e),this.cleanupFunctions.push(()=>{e.removeListener(t)});const r=window.matchMedia("(prefers-contrast: high)"),i=n=>{document.body.classList.toggle("high-contrast",n.matches)};r.addListener(i),i(r),this.cleanupFunctions.push(()=>{r.removeListener(i)})}onInteractionEnd(){setTimeout(()=>{const e=document.querySelector("#result-text");e&&this._announceChange(`Current key: ${e.textContent}`)},100)}_setupResponsiveLogic(){let e=!1;const t=()=>{e||(e=!0,this.elements.beltsContainer&&(this.elements.beltsContainer.style.opacity="0"))},r=it.debounce(()=>{try{const s=window.innerWidth>window.innerHeight?"vertical":"horizontal";this.state.belts.orientation!==s&&(J.setOrientation(s),this._announceChange(`Layout changed to ${s}`)),this.state.belts.init=!1,De.markDirty(this.state),requestAnimationFrame(()=>{this.elements.beltsContainer&&(this.elements.beltsContainer.style.opacity="1"),e=!1})}catch(n){E.handle(n,"Resize",()=>{console.warn("Resize handling failed")}),this.elements.beltsContainer&&(this.elements.beltsContainer.style.opacity="1"),e=!1}},250),i=()=>{t(),r()};window.addEventListener("resize",i),this.cleanupFunctions.push(()=>{window.removeEventListener("resize",i),r.cancel()});try{const s=window.innerWidth>window.innerHeight?"vertical":"horizontal";J.setOrientation(s)}catch(n){E.handle(n,"Resize")}}_setupPerformanceMonitoring(){let e=0;const t=3;if(this.performanceMonitor=it.createFPSMonitor(r=>{r<30?(e++,console.warn(`Low FPS detected: ${r} (count: ${e})`),e>=t&&!this.state.performance.isLowPowerMode&&(this.state.performance.isLowPowerMode=!0,document.body.classList.add("low-power-mode"),console.log("Low-power mode enabled due to poor performance"),this._announceChange("Performance mode adjusted for this device"))):r>=50&&(e=Math.max(0,e-1),e===0&&this.state.performance.isLowPowerMode&&(this.state.performance.isLowPowerMode=!1,document.body.classList.remove("low-power-mode"),console.log("Low-power mode disabled - performance improved")))},120),it.getMemoryInfo()){const r=setInterval(()=>{const i=it.getMemoryInfo();i&&i.used>100&&console.warn(`High memory usage: ${i.used}MB`)},3e4);this.cleanupFunctions.push(()=>clearInterval(r))}this.cleanupFunctions.push(()=>{this.performanceMonitor&&(this.performanceMonitor(),this.performanceMonitor=null)})}redraw(e){try{const t=ss(e);if(Hn(this.elements.canvas,this.state.dimensions)&&De.markDirty(this.state),!this.state.performance.isLowPowerMode&&!De.needsRedraw(this.state)||!this.state.dimensions.size||this.state.performance.isLowPowerMode&&t&&(this.state.performance.frameSkipCounter++,this.state.performance.frameSkipCounter%2===1))return;const i=mi(this.state),{rings:n,playback:s}=this.state,o=Ht;if(this.wheel)try{this.wheel.update(n,i,s)}catch(l){E.handle(l,"Wheel",()=>{console.warn("Wheel update failed - skipping frame")})}if(this.belts)try{this.belts.update(i,o)}catch(l){E.handle(l,"Belts",()=>{console.warn("Belts update failed - skipping frame")})}if(this.uiControls)try{this.uiControls.update()}catch(l){E.handle(l,"UIControls",()=>{console.warn("UI Controls update failed - skipping frame")})}De.markClean(this.state)}catch(t){E.handle(t,"RenderLoop",()=>{console.error("Critical render error - app may be unstable")})}}destroy(){try{this.keyboardManager,this.screenReaderManager&&this.screenReaderManager.cleanup(),this.cleanupFunctions.forEach(e=>{try{e()}catch(t){console.warn("Cleanup function failed:",t)}}),this.cleanupFunctions=[],this.wheel&&typeof this.wheel.destroy=="function"&&this.wheel.destroy(),this.belts&&typeof this.belts.destroy=="function"&&this.belts.destroy(),this.uiControls&&typeof this.uiControls.destroy=="function"&&this.uiControls.destroy(),this.performanceMonitor&&(this.performanceMonitor(),this.performanceMonitor=null),this.isInitialized=!1}catch(e){E.handle(e,"App",()=>{console.error("App cleanup failed")})}}_isDevelopment(){return window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.protocol==="file:"}getStatus(){var e,t;return{initialized:this.isInitialized,components:{wheel:!!this.wheel,belts:!!this.belts,uiControls:!!this.uiControls},accessibility:{keyboardEnabled:(e=this.keyboardManager)==null?void 0:e.isEnabled,screenReaderEnabled:(t=this.screenReaderManager)==null?void 0:t.isEnabled},dimensions:this.state.dimensions,errors:E.getErrorLog()}}}const $o=`<!-- Apply dark mode immediately to prevent FOUC -->\r
\r
\r
<!-- Settings button with enhanced accessibility -->\r
<button id="settings-btn"\r
        aria-label="Open settings sidebar"\r
        aria-controls="sidebar"\r
        aria-expanded="false"\r
        aria-describedby="settings-btn-help">\r
  <img src="public/assets/Settings_optimized.svg" alt="" width="48" height="48">\r
</button>\r
<div id="settings-btn-help" class="sr-only">\r
  Opens a panel with display options, theme settings, and keyboard shortcuts\r
</div>\r
\r
<!-- Enhanced sidebar with better structure -->\r
<nav id="sidebar" \r
     role="complementary" \r
     aria-hidden="true"\r
     aria-labelledby="sidebar-title">\r
  <div class="sidebar-content">\r
    <h2 id="sidebar-title">Diatonic Compass</h2>\r
    \r
    <!-- Tutorial button at top -->\r
    <button id="start-tutorial-btn" \r
            class="sidebar-btn tutorial-btn"\r
            aria-describedby="tutorial-help">Start Tutorial</button>\r
    <div id="tutorial-help" class="sr-only">\r
      Begin an interactive tutorial explaining how to use the Diatonic Compass\r
    </div>\r
    \r
    <!-- Layout Orientation setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Orientation</h3>\r
      <div class="toggle-switch-container">\r
        <div class="toggle-switch" id="orientation-toggle">\r
          <input type="radio" name="orientation" id="orientation-horizontal" value="horizontal" checked>\r
          <label for="orientation-horizontal">Horizontal</label>\r
          <input type="radio" name="orientation" id="orientation-vertical" value="vertical">\r
          <label for="orientation-vertical">Vertical</label>\r
          <div class="toggle-slider"></div>\r
        </div>\r
      </div>\r
    </div>\r
    \r
    <!-- Accidentals setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Accidentals</h3>\r
      <div class="accidentals-controls">\r
        <button id="flat-btn" \r
                class="accidental-toggle" \r
                aria-pressed="true" \r
                aria-label="Show flat note names">♭</button>\r
        <button id="sharp-btn" \r
                class="accidental-toggle" \r
                aria-pressed="true" \r
                aria-label="Show sharp note names">♯</button>\r
      </div>\r
    </div>\r
    \r
    <!-- Theme setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Colour Theme</h3>\r
      <div class="toggle-switch-container">\r
        <div class="toggle-switch" id="theme-toggle">\r
          <input type="radio" name="theme" id="theme-light" value="light" checked>\r
          <label for="theme-light">Light</label>\r
          <input type="radio" name="theme" id="theme-dark" value="dark">\r
          <label for="theme-dark">Dark</label>\r
          <div class="toggle-slider"></div>\r
        </div>\r
      </div>\r
    </div>\r
\r
    <!-- Cursor Color setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Cursor Colour</h3>\r
      <div class="cursor-color-picker" role="radiogroup" aria-label="Select cursor color">\r
        <button class="cursor-color-btn active"\r
                data-color="red"\r
                data-fill="false"\r
                aria-label="Red outline"\r
                role="radio"\r
                aria-checked="true">\r
          <div class="color-square red-outline"></div>\r
        </button>\r
        <button class="cursor-color-btn"\r
                data-color="red"\r
                data-fill="true"\r
                aria-label="Red with fill"\r
                role="radio"\r
                aria-checked="false">\r
          <div class="color-square red-fill"></div>\r
        </button>\r
        <button class="cursor-color-btn"\r
                data-color="blue"\r
                data-fill="true"\r
                aria-label="Blue with fill"\r
                role="radio"\r
                aria-checked="false">\r
          <div class="color-square blue-fill"></div>\r
        </button>\r
        <button class="cursor-color-btn"\r
                data-color="green"\r
                data-fill="true"\r
                aria-label="Green with fill"\r
                role="radio"\r
                aria-checked="false">\r
          <div class="color-square green-fill"></div>\r
        </button>\r
        <button class="cursor-color-btn"\r
                data-color="yellow"\r
                data-fill="true"\r
                aria-label="Yellow with fill"\r
                role="radio"\r
                aria-checked="false">\r
          <div class="color-square yellow-fill"></div>\r
        </button>\r
      </div>\r
    </div>\r
\r
    <!-- Component Order setting -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Component Order</h3>\r
      <div id="order-container" aria-describedby="order-help">\r
        <div id="order-help" class="sr-only">\r
          Drag the components to reorder how they appear in the interface\r
        </div>\r
        <div id="belt-order-list" role="listbox" aria-label="Component ordering controls">\r
          <!-- Components will be populated by OrderManager -->\r
        </div>\r
      </div>\r
    </div>\r
    \r
    <!-- Keyboard Shortcuts info -->\r
    <div class="sidebar-section">\r
      <h3 class="sidebar-subheader">Keyboard Shortcuts</h3>\r
      <div class="accessibility-text">\r
        <p> <span class="key">Tab</span> Navigate between controls</p>\r
        <p> <span class="key">Arrow keys</span> Rotate ring / belt</p>\r
        <p> <span class="key">Space</span>/<span class="key">Enter</span>: Play scale</p>\r
        <p> <span class="key">F</span> Toggle flat note names</p>\r
        <p> <span class="key">S</span> Toggle sharp note names</p>\r
        <p> <span class="key">V</span> Toggle vertical/horizontal layout</p>\r
        <p> <span class="key">F1</span> Open/close settings</p>\r
      </div>\r
    </div>\r
    \r
    <!-- Credit -->\r
    <div class="sidebar-credit">\r
      <small>Created by Quinn Fleming</small>\r
    </div>\r
  </div>\r
</nav>\r
\r
<!-- Sidebar overlay for mobile -->\r
<div id="sidebar-overlay" aria-hidden="true"></div>\r
\r
<!-- Main application content -->\r
<main class="main-container" \r
      id="main-content"\r
      role="application" \r
      aria-label="Diatonic Compass interactive music theory tool">\r
  \r
  <!-- Wheel container with enhanced accessibility -->\r
  <section class="wheel-container" aria-labelledby="wheel-title">\r
    <h2 id="wheel-title" class="sr-only">Interactive Compass Wheel</h2>\r
    <canvas id="chromaWheel" \r
            aria-label="Three-ring musical compass: outer ring for pitch classes, middle ring for scale degrees, inner ring for chromatic positions"\r
            aria-describedby="wheel-instructions"\r
            tabindex="0"\r
            role="img"></canvas>\r
    <div id="wheel-instructions" class="sr-only">\r
      Use arrow keys to rotate the rings and explore different musical keys and modes. \r
      Left and right arrows control the outer pitch ring, \r
      up and down arrows control the middle degree ring, \r
      shift plus arrows control the inner chromatic ring.\r
    </div>\r
  </section>\r
  \r
  <!-- Belts container with enhanced structure -->\r
  <section class="belts-container" aria-labelledby="belts-title">\r
    <h2 id="belts-title" class="sr-only">Musical Information Belts</h2>\r
    \r
    <!-- Visual cursor and flash overlay -->\r
    <div id="belt-cursor" aria-hidden="true"></div>\r
    <div id="belt-flash-overlay" aria-hidden="true"></div>\r
    \r
    <!-- Pitch belt -->\r
    <div class="belt pitch-belt" \r
         id="pitchBelt" \r
         role="listbox" \r
         aria-label="Pitch names belt"\r
         aria-describedby="pitch-belt-desc"\r
         tabindex="0">\r
      <div id="pitch-belt-desc" class="sr-only">\r
        Shows pitch class names like C, D, E. Drag or use left/right arrow keys to change.\r
      </div>\r
    </div>\r
    \r
    <!-- Degree belt -->\r
    <div class="belt degree-belt" \r
         id="degreeBelt" \r
         role="listbox" \r
         aria-label="Scale degrees belt"\r
         aria-describedby="degree-belt-desc"\r
         tabindex="0">\r
      <div id="degree-belt-desc" class="sr-only">\r
        Shows scale degree numbers like 1, 2, 3. Drag or use up/down arrow keys to change mode.\r
      </div>\r
    </div>\r
\r
    <!-- Interval brackets (decorative) -->\r
    <div class="interval-brackets-wrapper" \r
         aria-hidden="true" \r
         role="presentation">\r
      <div class="interval-brackets-container" \r
           id="intervalBracketsContainer" \r
           role="presentation"></div>\r
    </div>\r
\r
    <!-- Chromatic belt -->\r
    <div class="belt chromatic-belt" \r
         id="chromaticBelt" \r
         role="listbox" \r
         aria-label="Chromatic positions belt"\r
         aria-describedby="chromatic-belt-desc"\r
         tabindex="0">\r
      <div id="chromatic-belt-desc" class="sr-only">\r
        Shows chromatic position numbers 0 through 11. Drag or use shift+arrow keys to change perspective.\r
      </div>\r
      <!-- Color track (moves with degree ring) -->\r
      <div id="chromatic-colors-track" \r
           class="belt-track" \r
           aria-hidden="true"></div>\r
      <!-- Numbers track (moves with chromatic ring) -->\r
      <div id="chromatic-numbers-track" \r
           class="belt-track"\r
           aria-hidden="true"></div>\r
    </div>\r
  </section>\r
  \r
  <!-- Result display with enhanced accessibility -->\r
  <section id="result-container"\r
           role="region"\r
           aria-label="Current musical key and mode"\r
           aria-describedby="result-instructions"\r
           tabindex="0">\r
    <div id="result-text"\r
         role="status"\r
         aria-live="polite"\r
         aria-atomic="true"></div>\r
    <div id="result-instructions" class="sr-only">\r
      Shows the current key and mode. Click or press space to play the scale.\r
    </div>\r
  </section>\r
</main>\r
\r
<!-- Tutorial elements with enhanced accessibility -->\r
<div id="tutorial-mask" \r
     aria-hidden="true" \r
     role="presentation"></div>\r
<dialog id="tutorial-bubble" \r
        role="dialog" \r
        aria-labelledby="tutorial-text" \r
        aria-modal="true"\r
        aria-describedby="tutorial-instructions">\r
  <div id="tutorial-text" aria-live="assertive"></div>\r
  <div id="tutorial-instructions" class="sr-only">\r
    Tutorial dialog. Follow the spoken instructions and interact with the highlighted elements.\r
  </div>\r
</dialog>\r
\r
<!-- Status messages for screen readers -->\r
<div id="status-messages" aria-live="polite" aria-atomic="false" class="sr-only"></div>\r
<div id="urgent-messages" aria-live="assertive" aria-atomic="true" class="sr-only"></div>\r
\r
<!-- Scripts -->\r
\r
\r
\r
<!-- Feature detection and graceful degradation -->\r
\r
\r

\r
<!-- Structured data for search engines -->
`,Uo=Object.assign({"../public/apple-touch-icon.png":On,"../public/assets/Settings_optimized.svg":An,"../public/assets/Volume_optimized.svg":In,"../public/favicon-96x96.png":Pn,"../public/favicon.ico":Dn,"../public/favicon.svg":Mn,"../public/site.webmanifest":Rn,"../public/web-app-manifest-192x192.png":Ln,"../public/web-app-manifest-512x512.png":Nn}),Wo="../public/";function Vo(a){const e=a.replace(/^\/?public\//,""),t=`${Wo}${e}`;return Uo[t]??a}function Yo(a){a.querySelectorAll("[src], [href]").forEach(t=>{const r=t.hasAttribute("src")?"src":"href",i=t.getAttribute(r);!i||i.startsWith("http")||i.startsWith("data:")||i.startsWith("#")||i.startsWith("public/")&&t.setAttribute(r,Vo(i))})}function Go(){const a=Tt();if(a&&(typeof a.darkMode=="boolean"&&(y.ui.darkMode=a.darkMode,document.body.classList.toggle("dark-mode",a.darkMode)),Array.isArray(a.beltOrder))){const e=["pitch","degree","intervals","chromatic"],t=a.beltOrder;if(e.every(i=>t.includes(i))&&t.length===e.length){y.belts.order=t;const i=document.querySelector(".belts-container");if(i){const n={pitch:".pitch-belt",degree:".degree-belt",intervals:".interval-brackets-wrapper",chromatic:".chromatic-belt"};t.forEach((s,o)=>{const l=n[s],c=l?i.querySelector(l):null;c&&(c.style.order=String(o+1))})}}}}function Xo(a){a.innerHTML=$o,Yo(a),Go();const e=a.querySelector(".main-container");if(!e)throw new Error("Diatonic Compass root container not found.");const t=new qo(e);return{destroy:()=>{t.destroy(),document.body.classList.remove("dark-mode","low-power-mode","high-contrast","reduced-motion"),a.innerHTML=""}}}Xo(document.getElementById("app"));export{J as A,Q as C,Ht as D,E,y as a,X as b,mi as c,Ko as g,z as n,jt as s};
//# sourceMappingURL=index-C-afrOde.js.map
